def popen(path, mode='r', bufsize=(-1)):
    p = Popen3(path, 0, bufsize)
    if (mode == 'r'):
        return _ProcessFile(p.fromchild, p.process, path)
    elif (mode == 'w'):
        return _ProcessFile(p.tochild, p.process, path)
    else:
        raise OSError(0, 'Invalid mode', mode)
