{
  if (challenge.getIdentifier() != null) {
    hw.appendQuotedParameter("username",challenge.getIdentifier());
  }
  if (challenge.getRealm() != null) {
    hw.appendQuotedParameter("realm",challenge.getRealm());
  }
  if (challenge.getServerNonce() != null) {
    hw.appendQuotedParameter("nonce",challenge.getServerNonce());
  }
  if (challenge.getDigestRef() != null) {
    hw.appendQuotedParameter("uri",challenge.getDigestRef().toString());
  }
  if (challenge.getSecret() != null) {
    hw.appendQuotedParameter("response",new String(challenge.getSecret()));
  }
  if ((challenge.getDigestAlgorithm() != null) && !Digest.ALGORITHM_MD5.equals(challenge.getDigestAlgorithm())) {
    hw.appendParameter("algorithm",challenge.getDigestAlgorithm());
  }
  if (challenge.getClientNonce() != null) {
    hw.appendQuotedParameter("cnonce",challenge.getClientNonce());
  }
  if (challenge.getOpaque() != null) {
    hw.appendQuotedParameter("opaque",challenge.getOpaque());
  }
  if (challenge.getQuality() != null) {
    hw.appendParameter("qop",challenge.getQuality());
  }
  if ((challenge.getQuality() != null) && (challenge.getServerNounceCount() > 0)) {
    hw.appendParameter("nc",challenge.getServerNounceCountAsHex());
  }
  for (  Parameter param : challenge.getParameters()) {
    if (HeaderUtils.isToken(param.getValue())) {
      hw.appendParameter(param);
    }
 else {
      hw.appendQuotedParameter(param);
    }
  }
}
