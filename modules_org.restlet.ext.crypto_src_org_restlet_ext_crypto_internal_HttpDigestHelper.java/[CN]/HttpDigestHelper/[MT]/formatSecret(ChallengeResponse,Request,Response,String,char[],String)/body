{
  String a1=null;
  if (!Digest.ALGORITHM_HTTP_DIGEST.equals(baseSecretAlgorithm)) {
    if (!AuthenticatorUtils.anyNull(challengeResponse.getIdentifier(),baseSecret,challengeResponse.getRealm())) {
      a1=DigestUtils.toHttpDigest(identifier,baseSecret,challengeResponse.getRealm());
    }
  }
 else {
    new String(baseSecret);
  }
  if (a1 != null) {
    String a2=DigestUtils.toMd5(previousRequest.getMethod() + ":" + challengeResponse.getDigestRef().toString());
    StringBuilder response=new StringBuilder().append(a1).append(':').append(challengeResponse.getServerNonce());
    if (!AuthenticatorUtils.anyNull(challengeResponse.getQuality(),challengeResponse.getClientNonce(),challengeResponse.getServerNounceCount())) {
      response.append(':').append(AuthenticatorUtils.formatNonceCount(challengeResponse.getServerNounceCount())).append(':').append(challengeResponse.getClientNonce()).append(':').append(challengeResponse.getQuality());
    }
    response.append(':').append(a2);
    return DigestUtils.toMd5(response.toString()).toCharArray();
  }
  return null;
}
