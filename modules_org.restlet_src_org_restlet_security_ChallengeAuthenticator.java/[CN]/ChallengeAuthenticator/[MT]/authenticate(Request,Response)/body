{
  boolean result=false;
  final boolean loggable=getLogger().isLoggable(Level.FINE);
  ChallengeResponse challengeResponse=request.getChallengeResponse();
  if (getVerifier() != null) {
switch (getVerifier().verify(request,response)) {
case Verifier.RESULT_VALID:
      result=true;
    if (loggable) {
      if (challengeResponse != null) {
        getLogger().fine("Authentication succeeded. Valid credentials provided for identifier: " + request.getChallengeResponse().getIdentifier() + ".");
      }
 else {
        getLogger().fine("Authentication succeeded. Valid credentials provided.");
      }
    }
  break;
case Verifier.RESULT_MISSING:
if (loggable) {
  getLogger().fine("Authentication failed. No credentials provided.");
}
challenge(response,false);
break;
case Verifier.RESULT_INVALID:
if (loggable) {
getLogger().fine("Authentication failed. Invalid credentials provided.");
}
if (isRechallengeEnabled()) {
challenge(response,false);
}
 else {
forbid(response);
}
break;
case Verifier.RESULT_STALE:
if (loggable) {
getLogger().fine("Authentication failed. Stale credentials provided.");
}
challenge(response,true);
break;
}
}
 else {
getLogger().warning("Authentication failed. No verifier provided.");
}
if (challengeResponse != null) {
challengeResponse.setAuthenticated(result);
}
return result;
}
