{
  if (this.agentMainProduct == null) {
    try {
      URL userAgentPropertiesUrl=Engine.getClassLoader().getResource("user-agent.properties");
      if (userAgentPropertiesUrl != null) {
        BufferedReader reader=new BufferedReader(new InputStreamReader(userAgentPropertiesUrl.openStream(),CharacterSet.UTF_8.getName()));
        Template template=null;
        Variable userAgentName=new Variable(Variable.TYPE_TOKEN);
        Variable userAgentVersion=new Variable(Variable.TYPE_TOKEN);
        Variable userAgentComment=new Variable(Variable.TYPE_COMMENT);
        String line=reader.readLine();
        for (; line != null; line=reader.readLine()) {
          if (line.trim().length() > 0 && !line.trim().startsWith("#")) {
            template=new Template(line,Template.MODE_EQUALS);
            template.getVariables().put("userAgentName",userAgentName);
            template.getVariables().put("userAgentVersion",userAgentVersion);
            template.getVariables().put("userAgentComment",userAgentComment);
            Map<String,Object> map=new HashMap<String,Object>();
            if (template.parse(getAgent(),map) > -1) {
              this.agentMainProduct=new Product((String)map.get("userAgentName"),(String)map.get("userAgentVersion"),(String)map.get("userAgentComment"));
              break;
            }
          }
        }
      }
    }
 catch (    UnsupportedEncodingException e) {
      e.printStackTrace();
    }
catch (    IOException e) {
      e.printStackTrace();
    }
  }
  return this.agentMainProduct;
}
