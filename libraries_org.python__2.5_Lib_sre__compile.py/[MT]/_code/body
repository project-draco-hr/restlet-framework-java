def _code(p, flags):
    flags = (p.pattern.flags | flags)
    code = []
    _compile_info(code, p, flags)
    _compile(code, p.data, flags)
    code.append(OPCODES[SUCCESS])
    return code
