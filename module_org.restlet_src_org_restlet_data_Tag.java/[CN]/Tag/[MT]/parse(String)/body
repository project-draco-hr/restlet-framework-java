{
  Tag result=new Tag();
  if (httpTag.startsWith("W")) {
    result.setWeak(true);
    httpTag=httpTag.substring(1);
  }
 else {
    result.setWeak(false);
  }
  if (httpTag.startsWith("\"") && httpTag.endsWith("\"")) {
    result.setOpaqueTag(httpTag.substring(1,httpTag.length() - 1));
  }
 else   if (httpTag.equals("*")) {
    result.setOpaqueTag("*");
  }
 else {
    throw new IllegalArgumentException("Invalid tag format detected: " + httpTag);
  }
  return result;
}
