def typed_subpart_iterator(msg, maintype='text', subtype=None):
    'Iterate over the subparts with a given MIME type.\n\n    Use `maintype\' as the main MIME type to match against; this defaults to\n    "text".  Optional `subtype\' is the MIME subtype to match against; if\n    omitted, only the main type is matched.\n    '
    for subpart in msg.walk():
        if (subpart.get_content_maintype() == maintype):
            if ((subtype is None) or (subpart.get_content_subtype() == subtype)):
                yield subpart
