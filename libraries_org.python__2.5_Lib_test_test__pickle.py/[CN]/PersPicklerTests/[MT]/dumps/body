def dumps(self, arg, proto=0, fast=0):


    class PersPickler(pickle.Pickler):

        def persistent_id(subself, obj):
            return self.persistent_id(obj)
    f = StringIO()
    p = PersPickler(f, proto)
    if fast:
        p.fast = fast
    p.dump(arg)
    f.seek(0)
    return f.read()
