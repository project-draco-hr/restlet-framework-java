def __setitem__(self, attname, value):
    if isinstance(value, StringTypes):
        try:
            node = self._attrs[attname]
        except KeyError:
            node = Attr(attname)
            node.ownerDocument = self._ownerElement.ownerDocument
            self.setNamedItem(node)
        node.value = value
    else:
        if (not isinstance(value, Attr)):
            raise TypeError, 'value must be a string or Attr object'
        node = value
        self.setNamedItem(node)
