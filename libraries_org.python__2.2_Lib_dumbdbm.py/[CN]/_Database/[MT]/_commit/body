def _commit(self):
    try:
        _os.unlink(self._bakfile)
    except _os.error:
        pass
    try:
        _os.rename(self._dirfile, self._bakfile)
    except _os.error:
        pass
    f = _open(self._dirfile, 'w', self._mode)
    for (key, (pos, siz)) in self._index.items():
        f.write(('%s, (%s, %s)\n' % (`key`, `pos`, `siz`)))
    f.close()
