def __init__(self, sock=None, map=None):
    if (map is None):
        self._map = socket_map
    else:
        self._map = map
    if sock:
        self.set_socket(sock, map)
        self.socket.setblocking(0)
        self.connected = True
        try:
            self.addr = sock.getpeername()
        except socket.error:
            pass
    else:
        self.socket = None
