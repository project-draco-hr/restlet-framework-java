def compact_traceback():
    (t, v, tb) = sys.exc_info()
    tbinfo = []
    assert tb
    while tb:
        tbinfo.append((tb.tb_frame.f_code.co_filename, tb.tb_frame.f_code.co_name, str(tb.tb_lineno)))
        tb = tb.tb_next
    del tb
    (file, function, line) = tbinfo[(-1)]
    info = ' '.join([('[%s|%s|%s]' % x) for x in tbinfo])
    return ((file, function, line), t, v, info)
