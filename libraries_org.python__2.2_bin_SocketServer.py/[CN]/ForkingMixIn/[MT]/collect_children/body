def collect_children(self):
    'Internal routine to wait for died children.'
    while self.active_children:
        if (len(self.active_children) < self.max_children):
            options = os.WNOHANG
        else:
            options = 0
        try:
            (pid, status) = os.waitpid(0, options)
        except os.error:
            pid = None
        if (not pid):
            break
        self.active_children.remove(pid)
