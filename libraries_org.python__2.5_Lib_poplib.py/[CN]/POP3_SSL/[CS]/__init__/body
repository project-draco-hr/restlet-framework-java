def __init__(self, host, port=POP3_SSL_PORT, keyfile=None, certfile=None):
    self.host = host
    self.port = port
    self.keyfile = keyfile
    self.certfile = certfile
    self.buffer = ''
    msg = 'getaddrinfo returns an empty list'
    self.sock = None
    for res in socket.getaddrinfo(self.host, self.port, 0, socket.SOCK_STREAM):
        (af, socktype, proto, canonname, sa) = res
        try:
            self.sock = socket.socket(af, socktype, proto)
            self.sock.connect(sa)
        except socket.error as msg:
            if self.sock:
                self.sock.close()
            self.sock = None
            continue
        break
    if (not self.sock):
        raise socket.error, msg
    self.file = self.sock.makefile('rb')
    self.sslobj = socket.ssl(self.sock, self.keyfile, self.certfile)
    self._debugging = 0
    self.welcome = self._getresp()
