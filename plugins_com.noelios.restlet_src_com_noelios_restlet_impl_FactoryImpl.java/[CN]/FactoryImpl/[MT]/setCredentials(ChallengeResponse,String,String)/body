{
  try {
    if (response.getScheme().equals(ChallengeSchemes.HTTP_BASIC)) {
      String credentials=userId + ':' + password;
      response.setCredentials(Base64.encodeBytes(credentials.getBytes("US-ASCII")));
    }
 else     if (response.getScheme().equals(ChallengeSchemes.SMTP_PLAIN)) {
      String credentials="^@" + userId + "^@"+ password;
      response.setCredentials(Base64.encodeBytes(credentials.getBytes("US-ASCII")));
    }
 else {
      throw new IllegalArgumentException("Challenge scheme not supported by this implementation");
    }
  }
 catch (  UnsupportedEncodingException e) {
    throw new RuntimeException("Unsupported encoding, unable to encode credentials");
  }
}
