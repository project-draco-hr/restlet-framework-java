{
  boolean defaultMetadata=true;
  if (metadataService != null) {
    if (metadata instanceof Language) {
      Language language=(Language)metadata;
      defaultMetadata=language.equals(metadataService.getDefaultLanguage());
    }
 else     if (metadata instanceof MediaType) {
      MediaType mediaType=(MediaType)metadata;
      defaultMetadata=mediaType.equals(metadataService.getDefaultMediaType());
    }
 else     if (metadata instanceof CharacterSet) {
      CharacterSet characterSet=(CharacterSet)metadata;
      defaultMetadata=characterSet.equals(metadataService.getDefaultCharacterSet());
    }
 else     if (metadata instanceof Encoding) {
      Encoding encoding=(Encoding)metadata;
      defaultMetadata=encoding.equals(metadataService.getDefaultEncoding());
    }
  }
  if (!defaultMetadata) {
    String extension=metadataService.getExtension(metadata);
    if (extension != null) {
      fileName.append("." + extension);
    }
 else {
      if (metadata.getParent() != null) {
        updateFileExtension(fileName,metadata.getParent(),metadataService);
      }
    }
  }
}
