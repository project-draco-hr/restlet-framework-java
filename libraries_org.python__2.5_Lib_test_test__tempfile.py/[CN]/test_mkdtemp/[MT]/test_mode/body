def test_mode(self):
    if (not has_stat):
        return
    if (os.name == 'java'):
        return
    dir = self.do_create()
    try:
        mode = stat.S_IMODE(os.stat(dir).st_mode)
        mode &= 511
        expected = 448
        if (sys.platform in ('win32', 'os2emx', 'mac')):
            user = (expected >> 6)
            expected = (user * ((1 + 8) + 64))
        self.assertEqual(mode, expected)
    finally:
        os.rmdir(dir)
