def test_del_on_close(self):
    dir = tempfile.mkdtemp()
    try:
        f = tempfile.NamedTemporaryFile(dir=dir)
        f.write('blat')
        f.close()
        self.failIf(os.path.exists(f.name), ('NamedTemporaryFile %s exists after close' % f.name))
    finally:
        os.rmdir(dir)
