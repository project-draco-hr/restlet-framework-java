def _test_file_mode(self):
    if (not has_stat):
        return
    file = self.do_create()
    mode = stat.S_IMODE(os.stat(file.name).st_mode)
    expected = 384
    if (sys.platform in ('win32', 'os2emx', 'mac')):
        user = (expected >> 6)
        expected = (user * ((1 + 8) + 64))
    self.assertEqual(mode, expected)
