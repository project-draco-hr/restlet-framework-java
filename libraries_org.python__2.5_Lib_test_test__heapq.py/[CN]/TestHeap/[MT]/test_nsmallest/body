def test_nsmallest(self):
    data = [(random.randrange(2000), i) for i in range(1000)]
    for f in (None, (lambda x: ((x[0] * 547) % 2000))):
        for n in (0, 1, 2, 10, 100, 400, 999, 1000, 1100):
            self.assertEqual(nsmallest(n, data), sorted(data)[:n])
            self.assertEqual(nsmallest(n, data, key=f), sorted(data, key=f)[:n])
