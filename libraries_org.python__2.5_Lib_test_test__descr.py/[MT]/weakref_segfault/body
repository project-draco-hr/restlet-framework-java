def weakref_segfault():
    if verbose:
        print 'Testing weakref segfault...'
    import weakref


    class Provoker:

        def __init__(self, referrent):
            self.ref = weakref.ref(referrent)

        def __del__(self):
            x = self.ref()


    class Oops(object):
        pass
    o = Oops()
    o.whatever = Provoker(o)
    del o
