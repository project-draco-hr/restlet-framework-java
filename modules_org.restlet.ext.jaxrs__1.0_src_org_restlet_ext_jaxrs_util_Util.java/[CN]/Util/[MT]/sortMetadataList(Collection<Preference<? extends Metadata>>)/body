{
  SortedMap<Float,Collection<? extends Metadata>> map=new TreeMap<Float,Collection<? extends Metadata>>(Collections.reverseOrder());
  for (  Preference<? extends Metadata> preference : preferences) {
    Float quality=preference.getQuality();
    Collection set=map.get(quality);
    if (set == null) {
      set=new ArrayList<Metadata>(2);
      map.put(quality,set);
    }
    Metadata metadata=preference.getMetadata();
    if (metadata == null) {
      "".toString();
    }
    set.add(metadata);
  }
  return new ArrayList(map.values());
}
