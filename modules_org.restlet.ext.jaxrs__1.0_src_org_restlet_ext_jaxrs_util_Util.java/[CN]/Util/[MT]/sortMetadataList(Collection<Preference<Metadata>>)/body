{
  SortedMap<Float,Collection<Metadata>> map=new TreeMap<Float,Collection<Metadata>>(Collections.reverseOrder());
  for (  Preference<Metadata> preference : preferences) {
    Float quality=preference.getQuality();
    Collection<Metadata> metadatas=map.get(quality);
    if (metadatas == null) {
      metadatas=new ArrayList<Metadata>(2);
      map.put(quality,metadatas);
    }
    metadatas.add(preference.getMetadata());
  }
  return new ArrayList<Collection<? extends Metadata>>(map.values());
}
