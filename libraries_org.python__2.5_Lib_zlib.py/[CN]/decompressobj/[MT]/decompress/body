def decompress(self, string, max_length=0):
    if self._ended:
        raise error('decompressobj may not be used after flush()')
    self.unused_data = ''
    self.unconsumed_tail = ''
    if (max_length < 0):
        raise ValueError('max_length must be a positive integer')
    string = _to_input(string)
    self.inflater.setInput(string)
    inflated = _get_inflate_data(self.inflater, max_length)
    r = self.inflater.getRemaining()
    if r:
        if max_length:
            self.unconsumed_tail = string[(- r):]
        else:
            self.unused_data = string[(- r):]
    return inflated
