def compress(self, string):
    if self._ended:
        raise error('compressobj may not be used after flush(Z_FINISH)')
    string = _to_input(string)
    self.deflater.setInput(string, 0, len(string))
    return _get_deflate_data(self.deflater)
