{
  if (this.transformer == null) {
    try {
      StreamSource transformSource=new StreamSource(getTransformSheet().getStream());
      if (getTransformSheet().getIdentifier() != null) {
        transformSource.setSystemId(getTransformSheet().getIdentifier().getTargetRef().toString());
      }
      TransformerFactory transformerFactory=TransformerFactory.newInstance();
      if (getUriResolver() != null) {
        transformerFactory.setURIResolver(getUriResolver());
      }
      this.transformer=transformerFactory.newTransformer(transformSource);
    }
 catch (    TransformerConfigurationException tce) {
      throw new IOException("Transformer configuration exception. " + tce.getMessage());
    }
catch (    TransformerFactoryConfigurationError tfce) {
      throw new IOException("Transformer factory configuration exception. " + tfce.getMessage());
    }
  }
  return this.transformer;
}
