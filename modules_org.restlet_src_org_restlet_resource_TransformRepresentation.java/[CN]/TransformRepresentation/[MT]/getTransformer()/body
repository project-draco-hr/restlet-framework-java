{
  if (this.transformer == null) {
    try {
      StreamSource transformSheet=new StreamSource(getTransformSheet().getStream());
      TransformerFactory transformerFactory=TransformerFactory.newInstance();
      if (getURIResolver() != null) {
        transformerFactory.setURIResolver(getURIResolver());
      }
      this.transformer=transformerFactory.newTransformer(transformSheet);
    }
 catch (    TransformerConfigurationException tce) {
      throw new IOException("Transformer configuration exception. " + tce.getMessage());
    }
catch (    TransformerFactoryConfigurationError tfce) {
      throw new IOException("Transformer factory configuration exception. " + tfce.getMessage());
    }
  }
  return this.transformer;
}
