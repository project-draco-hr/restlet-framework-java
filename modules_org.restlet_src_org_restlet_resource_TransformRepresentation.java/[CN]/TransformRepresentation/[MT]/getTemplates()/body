{
  if (this.templates == null) {
    try {
      final StreamSource transformSource=new StreamSource(getTransformSheet().getStream());
      if (getTransformSheet().getIdentifier() != null) {
        transformSource.setSystemId(getTransformSheet().getIdentifier().getTargetRef().toString());
      }
      final TransformerFactory transformerFactory=TransformerFactory.newInstance();
      if (getUriResolver() != null) {
        transformerFactory.setURIResolver(getUriResolver());
      }
      this.templates=transformerFactory.newTemplates(transformSource);
    }
 catch (    final TransformerConfigurationException tce) {
      throw new IOException("Transformer configuration exception. " + tce.getMessage());
    }
  }
  return this.templates;
}
