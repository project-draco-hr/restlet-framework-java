{
  if (isFilling()) {
    setState(BufferState.DRAINING);
    getBytes().limit(getBytes().position());
    getBytes().position(this.begin);
    this.begin=0;
  }
 else   if (isDraining()) {
    if (hasRemaining()) {
      setState(BufferState.FILLING);
      this.begin=getBytes().position();
      getBytes().position(getBytes().limit());
      getBytes().limit(getBytes().capacity());
    }
 else {
      clear();
    }
  }
}
