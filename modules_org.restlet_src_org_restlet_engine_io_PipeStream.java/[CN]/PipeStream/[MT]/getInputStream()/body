{
  return new InputStream(){
    @Override public int read() throws IOException {
      try {
        final Integer value=queue.poll(QUEUE_TIMEOUT,TimeUnit.SECONDS);
        if (value == null) {
          throw new IOException("Timeout while reading from the queue-based input stream");
        }
 else {
          return value.intValue();
        }
      }
 catch (      InterruptedException ie) {
        throw new IOException("Interruption occurred while writing in the queue");
      }
    }
  }
;
}
