def pathname2url(pathname):
    "OS-specific conversion from a file system path to a relative URL\n    of the 'file' scheme; not recommended for general use."
    if ('/' in pathname):
        raise RuntimeError, 'Cannot convert pathname containing slashes'
    components = pathname.split(':')
    if (components[0] == ''):
        del components[0]
    if (components[(-1)] == ''):
        del components[(-1)]
    for i in range(len(components)):
        if (components[i] == ''):
            components[i] = '..'
    components = map(_pncomp2url, components)
    if os.path.isabs(pathname):
        return ('/' + '/'.join(components))
    else:
        return '/'.join(components)
