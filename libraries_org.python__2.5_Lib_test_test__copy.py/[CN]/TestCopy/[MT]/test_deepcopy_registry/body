def test_deepcopy_registry(self):


    class C(object):

        def __new__(cls, foo):
            obj = object.__new__(cls)
            obj.foo = foo
            return obj

    def pickle_C(obj):
        return (C, (obj.foo,))
    x = C(42)
    self.assertRaises(TypeError, copy.deepcopy, x)
    copy_reg.pickle(C, pickle_C, C)
    y = copy.deepcopy(x)
