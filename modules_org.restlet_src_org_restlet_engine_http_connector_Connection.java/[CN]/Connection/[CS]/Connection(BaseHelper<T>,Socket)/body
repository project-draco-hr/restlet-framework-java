{
  this.helper=helper;
  this.inboundStream=new InboundStream(socket.getInputStream());
  this.inboundMessages=helper.isClientSide() ? null : new ConcurrentLinkedQueue<Response>();
  this.outboundStream=new OutboundStream(socket.getOutputStream());
  this.outboundMessages=new ConcurrentLinkedQueue<Response>();
  this.persistent=helper.isPersistingConnections();
  this.pipelining=false;
  this.state=ConnectionState.OPENING;
  this.socket=socket;
  this.inboundBusy=false;
  this.outboundBusy=false;
}
