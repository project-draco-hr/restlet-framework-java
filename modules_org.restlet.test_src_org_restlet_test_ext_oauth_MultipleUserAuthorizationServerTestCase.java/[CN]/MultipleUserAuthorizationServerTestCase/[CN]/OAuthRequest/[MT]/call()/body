{
  OAuthParameters params=new OAuthParameters("client1234","secret1234",getProt() + "://localhost:" + oauthServerPort+ "/oauth/",Scopes.toRoles("foo bar"));
  OAuthUser user=Flow.PASSWORD.execute(params,null,null,"user" + callUser,"pass" + callUser,null,callClient);
  if (user == null) {
    SingletonStore.I().addError();
    SingletonStore.I().addRequest();
    return false;
  }
  Reference ref=new Reference(getProt() + "://localhost:" + serverPort+ "/server/scoped/user"+ callUser);
  ref.addQueryParameter("oauth_token",user.getAccessToken());
  ClientResource cr=new ClientResource(ref);
  cr.setNext(callClient);
  Representation r=cr.get();
  if (r == null) {
    SingletonStore.I().addError();
    SingletonStore.I().addRequest();
    cr.release();
    return false;
  }
  try {
    String text=r.getText();
    if (!text.endsWith("user" + callUser)) {
      SingletonStore.I().addRequest();
      SingletonStore.I().addError();
      return false;
    }
  }
 catch (  Exception e) {
    SingletonStore.I().addError();
    SingletonStore.I().addRequest();
    return false;
  }
  SingletonStore.I().addRequest();
  r.release();
  cr.release();
  return true;
}
