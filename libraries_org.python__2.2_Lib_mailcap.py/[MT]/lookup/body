def lookup(caps, MIMEtype, key=None):
    entries = []
    if caps.has_key(MIMEtype):
        entries = (entries + caps[MIMEtype])
    MIMEtypes = MIMEtype.split('/')
    MIMEtype = (MIMEtypes[0] + '/*')
    if caps.has_key(MIMEtype):
        entries = (entries + caps[MIMEtype])
    if (key is not None):
        entries = filter((lambda e, key=key: e.has_key(key)), entries)
    return entries
