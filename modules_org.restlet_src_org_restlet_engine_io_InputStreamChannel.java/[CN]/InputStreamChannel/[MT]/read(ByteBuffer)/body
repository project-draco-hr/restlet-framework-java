{
  int result=0;
  int available=getInputStream().available();
  if (!isBlocking()) {
    if (available > 0) {
      if (target.hasArray()) {
        byte[] byteArray=target.array();
        result=getInputStream().read(byteArray,target.position(),Math.min(available,target.remaining()));
        if (result > 0) {
          target.position(target.position() + result);
        }
 else         if (result == -1) {
          target.position(target.position() + available);
        }
      }
 else {
        result=read(target,available);
      }
    }
 else {
      result=-1;
    }
  }
 else {
    result=read(target,IoUtils.BUFFER_SIZE);
  }
  return result;
}
