{
  Preference<T> result;
  if (parameters == null) {
    result=new Preference<T>();
switch (type) {
case TYPE_CHARACTER_SET:
      result.setMetadata((T)new CharacterSet(metadata.toString()));
    break;
case TYPE_ENCODING:
  result.setMetadata((T)new Encoding(metadata.toString()));
break;
case TYPE_LANGUAGE:
result.setMetadata((T)new Language(metadata.toString()));
break;
case TYPE_MEDIA_TYPE:
result.setMetadata((T)new MediaType(metadata.toString()));
break;
}
}
 else {
Series<Parameter> mediaParams=extractMediaParams(parameters);
float quality=extractQuality(parameters);
result=new Preference<T>(null,quality,parameters);
switch (type) {
case TYPE_CHARACTER_SET:
result.setMetadata((T)new CharacterSet(metadata.toString()));
break;
case TYPE_ENCODING:
result.setMetadata((T)new Encoding(metadata.toString()));
break;
case TYPE_LANGUAGE:
result.setMetadata((T)new Language(metadata.toString()));
break;
case TYPE_MEDIA_TYPE:
result.setMetadata((T)new MediaType(metadata.toString(),mediaParams));
break;
}
}
return result;
}
