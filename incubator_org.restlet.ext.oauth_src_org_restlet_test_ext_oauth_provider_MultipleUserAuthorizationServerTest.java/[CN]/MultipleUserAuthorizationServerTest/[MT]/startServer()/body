{
  Logger log=Context.getCurrentLogger();
  log.info("Starting server test!");
  String keystore=ClassLoader.getSystemResource("localhost.jks").getPath();
  System.setProperty("javax.net.ssl.trustStore",keystore);
  System.setProperty("javax.net.ssl.trustStoreType","JKS");
  System.setProperty("javax.net.ssl.trustStorePassword","testpass");
  Server server=new Server(new Context(),Protocol.HTTP,serverPort);
  component=new Component();
  component.getServers().add(server);
  component.getClients().add(Protocol.HTTP);
  component.getClients().add(Protocol.HTTPS);
  component.getClients().add(Protocol.RIAP);
  component.getDefaultHost().attach("/server",new Oauth2MultipleUserProtectedTestApplication());
  Server oauthServer=new Server(new Context(),Protocol.HTTP,oauthServerPort);
  Component oauthcomp=new Component();
  oauthcomp.getServers().add(oauthServer);
  oauthcomp.getClients().add(Protocol.HTTP);
  oauthcomp.getClients().add(Protocol.HTTPS);
  oauthcomp.getClients().add(Protocol.RIAP);
  oauthcomp.getDefaultHost().attach("/oauth",new Oauth2MultipleUserTestApplication(0));
  Series<Parameter> parameters=server.getContext().getParameters();
  parameters.add("keystorePath",keystore);
  parameters.add("keystorePassword","testpass");
  parameters.add("keyPassword","testpass");
  parameters.add("keystoreType","JKS");
  parameters.add("sslServerAlias","localhost");
  component.start();
  oauthcomp.start();
  List<AuthenticatorHelper> authenticators=Engine.getInstance().getRegisteredAuthenticators();
  for (  AuthenticatorHelper helper : authenticators) {
    System.out.println("Found default auth helper : " + helper);
  }
  authenticators.add(new OAuthHelper());
  System.out.println(Engine.getInstance().getRegisteredClients().get(0));
}
