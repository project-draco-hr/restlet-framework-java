{
  if (response != null) {
    Representation entity=response.getEntity();
    if ((entity != null) && !response.getRequest().getMethod().equals(Method.HEAD) && !response.getStatus().equals(Status.SUCCESS_NO_CONTENT)&& !response.getStatus().equals(Status.SUCCESS_RESET_CONTENT)) {
      ConnectorService connectorService=getConnectorService(response.getRequest());
      if (connectorService != null)       connectorService.beforeSend(entity);
      if (getResponseChannel() != null) {
        entity.write(getResponseChannel());
      }
 else       if (getResponseStream() != null) {
        entity.write(getResponseStream());
      }
      if (connectorService != null)       connectorService.afterSend(entity);
    }
    if (getResponseStream() != null) {
      getResponseStream().flush();
    }
  }
}
