def test_basic_auth(self):
    opener = OpenerDirector()
    password_manager = MockPasswordManager()
    auth_handler = urllib2.HTTPBasicAuthHandler(password_manager)
    realm = 'ACME Widget Store'
    http_handler = MockHTTPHandler(401, ('WWW-Authenticate: Basic realm="%s"\r\n\r\n' % realm))
    opener.add_handler(auth_handler)
    opener.add_handler(http_handler)
    self._test_basic_auth(opener, auth_handler, 'Authorization', realm, http_handler, password_manager, 'http://acme.example.com/protected', 'http://acme.example.com/protected')
