def test_cookies(self):
    cj = MockCookieJar()
    h = urllib2.HTTPCookieProcessor(cj)
    o = h.parent = MockOpener()
    req = Request('http://example.com/')
    r = MockResponse(200, 'OK', {}, '')
    newreq = h.http_request(req)
    self.assert_((cj.ach_req is req is newreq))
    self.assertEquals(req.get_origin_req_host(), 'example.com')
    self.assert_((not req.is_unverifiable()))
    newr = h.http_response(req, r)
    self.assert_((cj.ec_req is req))
    self.assert_((cj.ec_r is r is newr))
