{
  Application.setCurrent(new Application());
  Request request=new Request(Method.GET,"http://www.test.com/root");
  request.getClientInfo().getAcceptedMediaTypes().add(new Preference<MediaType>(MediaType.TEXT_XML));
  Response response=new Response(request);
  Resource target=new AutoDetectResource();
  target.init(new Context(),request,response);
  target.handleGet();
  Representation rep=response.getEntity();
  assertNotNull(rep);
  assertEquals(MediaType.TEXT_XML,rep.getMediaType());
  request.getClientInfo().getAcceptedMediaTypes().add(0,new Preference<MediaType>(MediaType.TEXT_HTML));
  target.handleGet();
  rep=response.getEntity();
  assertNotNull(rep);
  assertEquals(MediaType.TEXT_HTML,rep.getMediaType());
  assertEquals("<html>test EN</html>",rep.getText());
  request.getClientInfo().getAcceptedLanguages().add(new Preference<Language>(Language.FRENCH_FRANCE));
  target.handleGet();
  rep=response.getEntity();
  assertNotNull(rep);
  assertEquals(MediaType.TEXT_HTML,rep.getMediaType());
  assertEquals("<html>test FR</html>",rep.getText());
}
