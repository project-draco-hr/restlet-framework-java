{
  int result=RESULT_VALID;
  if (request.getChallengeResponse() == null) {
    result=RESULT_MISSING;
  }
 else {
    String identifier=getIdentifier(request,response);
    char[] secret=getSecret(request,response);
    try {
      if (verify(identifier,secret)) {
        request.getClientInfo().setUser(new User(identifier));
      }
 else {
        result=RESULT_INVALID;
      }
    }
 catch (    IllegalArgumentException iae) {
      result=RESULT_UNKNOWN;
    }
  }
  return result;
}
