{
  int result=RESULT_VALID;
  if (request.getChallengeResponse() == null) {
    result=RESULT_MISSING;
  }
 else {
    String identifier=request.getChallengeResponse().getIdentifier();
    char[] inputSecret=request.getChallengeResponse().getSecret();
    if (verify(identifier,inputSecret)) {
      request.getClientInfo().getSubject().getPrincipals().add(createUserPrincipal(identifier));
    }
 else {
      result=RESULT_INVALID;
    }
  }
  return result;
}
