{
  int result=RESULT_VALID;
  if (request.getChallengeResponse() == null) {
    result=RESULT_MISSING;
  }
 else   if (verify(request.getChallengeResponse().getIdentifier(),request.getChallengeResponse().getSecret())) {
    request.getClientInfo().getSubject().getPrincipals().add(createUserPrincipal(request.getChallengeResponse().getIdentifier(),request.getChallengeResponse().getSecret()));
  }
 else {
    result=RESULT_INVALID;
  }
  return result;
}
