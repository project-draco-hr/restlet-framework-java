{
  HeaderWriter hw=new HeaderWriter();
  boolean firstParameter=true;
  if (info != null) {
    if (info.getNextServerNonce() != null && info.getNextServerNonce().length() > 0) {
      hw.setFirstParameter(firstParameter);
      hw.appendQuotedParameter("nextnonce",info.getNextServerNonce());
      firstParameter=false;
    }
    if (info.getQuality() != null && info.getQuality().length() > 0) {
      hw.setFirstParameter(firstParameter);
      hw.appendParameter("qop",info.getQuality());
      firstParameter=false;
      if (info.getNonceCount() > 0) {
        hw.appendParameter("nc",formatNonceCount(info.getNonceCount()));
      }
    }
    if (info.getResponseDigest() != null && info.getResponseDigest().length() > 0) {
      hw.setFirstParameter(firstParameter);
      hw.appendQuotedParameter("rspauth",info.getResponseDigest());
      firstParameter=false;
    }
    if (info.getClientNonce() != null && info.getClientNonce().length() > 0) {
      hw.setFirstParameter(firstParameter);
      hw.appendParameter("cnonce",info.getClientNonce());
      firstParameter=false;
    }
  }
  return hw.toString();
}
