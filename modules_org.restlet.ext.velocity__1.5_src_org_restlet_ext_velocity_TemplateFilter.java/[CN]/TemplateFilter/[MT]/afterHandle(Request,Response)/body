{
  if (response.isEntityAvailable() && response.getEntity().getEncodings().contains(Encoding.VELOCITY)) {
    try {
      TemplateRepresentation representation=new TemplateRepresentation(response.getEntity(),response.getEntity().getMediaType());
      representation.setDataModel(request,response);
      response.setEntity(representation);
    }
 catch (    ResourceNotFoundException e) {
      response.setStatus(Status.CLIENT_ERROR_NOT_FOUND,e);
    }
catch (    ParseErrorException e) {
      response.setStatus(Status.SERVER_ERROR_INTERNAL,e);
    }
catch (    IOException e) {
      response.setStatus(Status.SERVER_ERROR_INTERNAL,e);
    }
  }
}
