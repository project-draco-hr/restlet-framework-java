{
switch (authenticate(request)) {
case AUTHENTICATION_VALID:
    if (authorize(request)) {
      accept(request,response);
    }
 else {
      forbid(response);
    }
  break;
case AUTHENTICATION_MISSING:
challenge(response,false);
break;
case AUTHENTICATION_INVALID:
if (isRechallengeEnabled()) {
challenge(response,false);
}
 else {
forbid(response);
}
break;
case AUTHENTICATION_STALE:
challenge(response,true);
break;
}
return CONTINUE;
}
