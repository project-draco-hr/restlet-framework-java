def appendChild(self, node):
    if (node.nodeType == self.DOCUMENT_FRAGMENT_NODE):
        for c in tuple(node.childNodes):
            self.appendChild(c)
        return node
    if (node.nodeType not in self._child_node_types):
        raise xml.dom.HierarchyRequestErr(('%s cannot be child of %s' % (repr(node), repr(self))))
    elif (node.nodeType in _nodeTypes_with_children):
        _clear_id_cache(self)
    if (node.parentNode is not None):
        node.parentNode.removeChild(node)
    _append_child(self, node)
    node.nextSibling = None
    return node
