def test_getweakrefcount(self):
    o = C()
    ref1 = weakref.ref(o)
    ref2 = weakref.ref(o, self.callback)
    self.assert_((weakref.getweakrefcount(o) == 2), 'got wrong number of weak reference objects')
    proxy1 = weakref.proxy(o)
    proxy2 = weakref.proxy(o, self.callback)
    self.assert_((weakref.getweakrefcount(o) == 4), 'got wrong number of weak reference objects')
    del ref1, ref2, proxy1, proxy2
    extra_collect()
    self.assert_((weakref.getweakrefcount(o) == 0), 'weak reference objects not unlinked from referent when discarded.')
    self.assert_((weakref.getweakrefcount(1) == 0), 'got wrong number of weak reference objects for int')
