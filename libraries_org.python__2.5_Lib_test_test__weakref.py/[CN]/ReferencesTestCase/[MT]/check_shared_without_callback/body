def check_shared_without_callback(self, makeref):
    o = Object(1)
    p1 = makeref(o, None)
    p2 = makeref(o, None)
    self.assert_((p1 is p2), 'both callbacks were None in the C API')
    del p1, p2
    p1 = makeref(o)
    p2 = makeref(o, None)
    self.assert_((p1 is p2), 'callbacks were NULL, None in the C API')
    del p1, p2
    p1 = makeref(o)
    p2 = makeref(o)
    self.assert_((p1 is p2), 'both callbacks were NULL in the C API')
    del p1, p2
    p1 = makeref(o, None)
    p2 = makeref(o)
    self.assert_((p1 is p2), 'callbacks were None, NULL in the C API')
