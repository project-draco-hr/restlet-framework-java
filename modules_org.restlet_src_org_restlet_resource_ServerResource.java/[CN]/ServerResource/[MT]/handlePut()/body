{
  Representation result=null;
  boolean canPut=true;
  if (getRequest().getConditions().hasSome()) {
    Variant preferredVariant=null;
    if (isNegotiateContent()) {
      preferredVariant=getPreferredVariant();
    }
 else {
      final List<Variant> variants=getVariants();
      if (variants.size() == 1) {
        preferredVariant=variants.get(0);
      }
 else {
        setStatus(Status.CLIENT_ERROR_PRECONDITION_FAILED);
        canPut=false;
      }
    }
    if (canPut) {
      result=get(preferredVariant);
      final Status status=getRequest().getConditions().getStatus(getRequest().getMethod(),result);
      if (status != null) {
        setStatus(status);
        canPut=false;
      }
    }
  }
  if (canPut) {
    final Object oHeaders=getRequest().getAttributes().get("org.restlet.http.headers");
    if (oHeaders != null) {
      final Series<Parameter> headers=(Series<Parameter>)oHeaders;
      if (headers.getFirst("Content-Range",true) != null) {
        setStatus(new Status(Status.SERVER_ERROR_NOT_IMPLEMENTED,"The Content-Range header is not understood"));
        canPut=false;
      }
    }
  }
  if (canPut) {
    if (getRequest().isEntityAvailable()) {
      try {
        result=put(getRequest().getEntity());
      }
 catch (      ResourceException re) {
        setStatus(re.getStatus(),re);
      }
      getAllowedMethods();
    }
 else {
      setStatus(Status.CLIENT_ERROR_BAD_REQUEST,"Missing request entity");
    }
  }
  return result;
}
