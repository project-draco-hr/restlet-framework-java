{
  boolean result=false;
  if (getLineBuilderState() != BufferState.DRAINING) {
    int byteBufferSize=0;
    if (getByteBufferState() == BufferState.DRAINING) {
      byteBufferSize=getByteBuffer().remaining();
    }
    if (byteBufferSize == 0) {
      setByteBufferState(BufferState.FILLING);
      getByteBuffer().clear();
      if (refill() > 0) {
        byteBufferSize=getByteBuffer().remaining();
      }
    }
    if (byteBufferSize > 0) {
      setLineBuilderState(NioUtils.fillLine(getLineBuilder(),getLineBuilderState(),getByteBuffer()));
      if (getByteBuffer().remaining() == 0) {
        setByteBufferState(BufferState.FILLING);
        getByteBuffer().clear();
      }
      return getLineBuilderState() == BufferState.DRAINING;
    }
  }
 else {
    result=true;
  }
  return result;
}
