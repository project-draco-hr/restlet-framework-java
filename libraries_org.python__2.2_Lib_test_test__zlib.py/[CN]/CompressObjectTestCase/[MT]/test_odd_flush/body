def test_odd_flush(self):
    import random
    if hasattr(zlib, 'Z_SYNC_FLUSH'):
        co = zlib.compressobj(zlib.Z_BEST_COMPRESSION)
        dco = zlib.decompressobj()
        try:
            gen = random.WichmannHill()
        except AttributeError:
            try:
                gen = random.Random()
            except AttributeError:
                gen = random
        gen.seed(1)
        data = genblock(1, (17 * 1024), generator=gen)
        first = co.compress(data)
        second = co.flush(zlib.Z_SYNC_FLUSH)
        expanded = dco.decompress((first + second))
        self.assertEqual(expanded, data, "17K random source doesn't match")
