def guess_extension(self, type, strict=1):
    "Guess the extension for a file based on its MIME type.\n\n        Return value is a string giving a filename extension,\n        including the leading dot ('.').  The extension is not\n        guaranteed to have been associated with any particular data\n        stream, but would be mapped to the MIME type `type' by\n        guess_type().  If no extension can be guessed for `type', None\n        is returned.\n\n        Optional `strict' argument when false adds a bunch of commonly found,\n        but non-standard types.\n        "
    type = type.lower()
    for (ext, stype) in self.types_map.items():
        if (type == stype):
            return ext
    if (not strict):
        for (ext, stype) in common_types.items():
            if (type == stype):
                return ext
    return None
