def write_manual_test(junit_xml_dir, module_name, test_name, took, type=None, exc_info=None, stdout=None, stderr=None):
    'Manually write XML for one test, outside of unittest'
    errors = (((type == 'error') and 1) or 0)
    failures = (((type == 'failure') and 1) or 0)
    skipped = (((type == 'skipped') and 1) or 0)
    ensure_dir(junit_xml_dir)
    stream = open(os.path.join(junit_xml_dir, ('TEST-%s.xml' % module_name)), 'w')
    write_testsuite_xml(stream, 1, errors, failures, skipped, module_name, took)
    info = TestInfo(test_name, took, type, exc_info)
    info.write_xml(stream)
    write_stdouterr_xml(stream, stdout, stderr)
    stream.write('</testsuite>')
    stream.close()
