{
  int result=CONTINUE;
  boolean success=authenticate(request,response);
  if (success && (getEnroler() != null)) {
    getEnroler().enrole(request.getClientInfo().getSubject());
  }
  if (!isOptional()) {
    if (!success)     result=STOP;
    if (request.getChallengeResponse() != null) {
      request.getChallengeResponse().setAuthenticated(success);
    }
    request.getClientInfo().setAuthenticated(success);
  }
  return result;
}
