def testLoadTkFailure(self):
    import os
    old_display = None
    import sys
    if sys.platform.startswith(('win', 'darwin', 'cygwin')):
        return
    if ('DISPLAY' in os.environ):
        old_display = os.environ['DISPLAY']
        del os.environ['DISPLAY']
        display = os.popen('echo $DISPLAY').read().strip()
        if display:
            return
    try:
        tcl = Tcl()
        self.assertRaises(TclError, tcl.winfo_geometry)
        self.assertRaises(TclError, tcl.loadtk)
    finally:
        if (old_display is not None):
            os.environ['DISPLAY'] = old_display
