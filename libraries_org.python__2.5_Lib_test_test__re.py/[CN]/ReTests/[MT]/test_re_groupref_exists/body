def test_re_groupref_exists(self):
    self.assertEqual(re.match('^(\\()?([^()]+)(?(1)\\))$', '(a)').groups(), ('(', 'a'))
    self.assertEqual(re.match('^(\\()?([^()]+)(?(1)\\))$', 'a').groups(), (None, 'a'))
    self.assertEqual(re.match('^(\\()?([^()]+)(?(1)\\))$', 'a)'), None)
    self.assertEqual(re.match('^(\\()?([^()]+)(?(1)\\))$', '(a'), None)
    self.assertEqual(re.match('^(?:(a)|c)((?(1)b|d))$', 'ab').groups(), ('a', 'b'))
    self.assertEqual(re.match('^(?:(a)|c)((?(1)b|d))$', 'cd').groups(), (None, 'd'))
    self.assertEqual(re.match('^(?:(a)|c)((?(1)|d))$', 'cd').groups(), (None, 'd'))
    self.assertEqual(re.match('^(?:(a)|c)((?(1)|d))$', 'a').groups(), ('a', ''))
    p = re.compile('(?P<g1>a)(?P<g2>b)?((?(g2)c|d))')
    self.assertEqual(p.match('abc').groups(), ('a', 'b', 'c'))
    self.assertEqual(p.match('ad').groups(), ('a', None, 'd'))
    self.assertEqual(p.match('abd'), None)
    self.assertEqual(p.match('ac'), None)
