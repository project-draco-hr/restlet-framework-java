{
  Writer tmplWriter=null;
  try {
    if (getCharacterSet() != null) {
      tmplWriter=new BufferedWriter(new OutputStreamWriter(outputStream,getCharacterSet().getName()));
    }
 else {
      tmplWriter=new BufferedWriter(new OutputStreamWriter(outputStream,this.template.getEncoding()));
    }
    this.template.process(getDataModel(),tmplWriter);
    tmplWriter.flush();
  }
 catch (  final TemplateException te) {
    throw new IOException("Template processing error " + te.getMessage());
  }
}
