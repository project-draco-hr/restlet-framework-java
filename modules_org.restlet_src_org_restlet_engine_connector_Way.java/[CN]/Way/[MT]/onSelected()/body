{
  try {
    if (getIoState() == IoState.INTEREST) {
      setIoState(IoState.PROCESSING);
    }
    if (getLogger().isLoggable(Level.FINER)) {
      if (this instanceof InboundWay) {
        getLogger().log(Level.FINER,"Inbound way selected. Processing IO for : " + this);
      }
 else {
        getLogger().log(Level.FINER,"Outbound way selected. Processing IO for : " + this);
      }
    }
    int drained=processIoBuffer();
    if ((drained == -1) && (getConnection().getState() == ConnectionState.CLOSING)) {
      getBuffer().clear();
    }
 else     if (getIoState() == IoState.PROCESSING) {
      setIoState(IoState.INTEREST);
    }
  }
 catch (  Exception e) {
    getConnection().onError("Error while processing a connection",e,Status.CONNECTOR_ERROR_COMMUNICATION);
  }
}
