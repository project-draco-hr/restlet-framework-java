{
  this.byteBuffer=connection.getHelper().isDirectBuffers() ? ByteBuffer.allocateDirect(bufferSize) : ByteBuffer.allocate(bufferSize);
  this.byteBufferState=BufferState.IDLE;
  this.lineBuilder=new StringBuilder();
  this.lineBuilderState=BufferState.IDLE;
  this.messages=new ConcurrentLinkedQueue<Response>();
  this.message=null;
  this.headers=null;
  this.connection=connection;
  this.messageState=MessageState.IDLE;
  this.ioState=IoState.IDLE;
  this.registration=new SelectionRegistration(0,this);
}
