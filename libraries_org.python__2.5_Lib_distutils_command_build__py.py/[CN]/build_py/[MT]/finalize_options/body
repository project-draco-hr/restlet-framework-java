def finalize_options(self):
    self.set_undefined_options('build', ('build_lib', 'build_lib'), ('force', 'force'))
    self.packages = self.distribution.packages
    self.py_modules = self.distribution.py_modules
    self.package_data = self.distribution.package_data
    self.package_dir = {}
    if self.distribution.package_dir:
        for (name, path) in self.distribution.package_dir.items():
            self.package_dir[name] = convert_path(path)
    self.data_files = self.get_data_files()
    if (type(self.optimize) is not IntType):
        try:
            self.optimize = int(self.optimize)
            assert (0 <= self.optimize <= 2)
        except (ValueError, AssertionError):
            raise DistutilsOptionError, 'optimize must be 0, 1, or 2'
