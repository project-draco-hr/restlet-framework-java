{
  Logger l=Context.getCurrentLogger();
  l.info("Getting consumer manager for - " + OPUri);
  if (!managers.containsKey(OPUri)) {
    l.info("Creating new consumer manager for - " + OPUri);
    try {
      ConsumerManager cm=new ConsumerManager();
      cm.setConnectTimeout(30000);
      cm.setSocketTimeout(30000);
      cm.setFailedAssocExpire(0);
      managers.put(OPUri,cm);
      return cm;
    }
 catch (    ConsumerException e) {
      l.warning("Failed to create ConsumerManager for - " + OPUri);
    }
    return null;
  }
 else {
    return managers.get(OPUri);
  }
}
