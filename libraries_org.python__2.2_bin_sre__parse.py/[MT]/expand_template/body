def expand_template(template, match):
    g = match.group
    sep = match.string[:0]
    (groups, literals) = template
    literals = literals[:]
    try:
        for (index, group) in groups:
            literals[index] = s = g(group)
            if (s is None):
                raise IndexError
    except IndexError:
        raise error, 'empty group'
    return string.join(literals, sep)
