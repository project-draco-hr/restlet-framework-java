{
  if (response.isEntityAvailable() && response.getEntity().getEncodings().contains(Encoding.FREEMARKER)) {
    TemplateRepresentation representation=new TemplateRepresentation(response.getEntity(),configuration,response.getEntity().getMediaType());
    representation.setDataModel(request,response);
    response.setEntity(representation);
  }
}
