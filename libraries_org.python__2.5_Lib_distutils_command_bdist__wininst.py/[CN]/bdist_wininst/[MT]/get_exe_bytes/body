def get_exe_bytes(self):
    from distutils.msvccompiler import get_build_version
    cur_version = get_python_version()
    if (self.target_version and (self.target_version != cur_version)):
        if (self.target_version > cur_version):
            bv = get_build_version()
        elif (self.target_version < '2.4'):
            bv = '6'
        else:
            bv = '7.1'
    else:
        bv = get_build_version()
    directory = os.path.dirname(__file__)
    filename = os.path.join(directory, ('wininst-%s.exe' % bv))
    return open(filename, 'rb').read()
