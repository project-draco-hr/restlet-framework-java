{
  int srcSize=buffer.remaining();
  ByteBuffer applicationBuffer=(ByteBuffer)args[0];
  HandshakeStatus handshakeStatus=getConnection().getSslHandshakeStatus();
  SSLEngineResult sslResult;
  if (applicationBuffer.hasRemaining() || handshakeStatus != HandshakeStatus.NOT_HANDSHAKING) {
    sslResult=getConnection().getSslEngine().wrap(applicationBuffer,buffer.getBytes());
  }
 else {
    sslResult=new SSLEngineResult(Status.BUFFER_OVERFLOW,handshakeStatus,0,0);
  }
  getConnection().setSslResult(sslResult);
  return srcSize - buffer.remaining();
}
