def encode_7or8bit(msg):
    'Set the Content-Transfer-Encoding header to 7bit or 8bit.'
    orig = msg.get_payload()
    if (orig is None):
        msg['Content-Transfer-Encoding'] = '7bit'
        return
    try:
        orig.encode('ascii')
    except UnicodeError:
        msg['Content-Transfer-Encoding'] = '8bit'
    else:
        msg['Content-Transfer-Encoding'] = '7bit'
