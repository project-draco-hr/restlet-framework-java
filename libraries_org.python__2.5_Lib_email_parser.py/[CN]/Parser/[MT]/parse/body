def parse(self, fp, headersonly=False):
    'Create a message structure from the data in a file.\n\n        Reads all the data from the file and returns the root of the message\n        structure.  Optional headersonly is a flag specifying whether to stop\n        parsing after reading the headers or not.  The default is False,\n        meaning it parses the entire contents of the file.\n        '
    feedparser = FeedParser(self._class)
    if headersonly:
        feedparser._set_headersonly()
    while True:
        data = fp.read(8192)
        if (not data):
            break
        feedparser.feed(data)
    return feedparser.close()
