{
  ChallengeRequest result=null;
  if (header != null) {
    int space=header.indexOf(' ');
    if (space != -1) {
      String scheme=header.substring(0,space);
      String realm=header.substring(space + 1);
      int equals=realm.indexOf('=');
      String realmValue=realm.substring(equals + 2,realm.length() - 1);
      result=new ChallengeRequest(new ChallengeScheme("HTTP_" + scheme,scheme),realmValue);
      if (result.getScheme().equals(ChallengeScheme.HTTP_DIGEST)) {
        Series<Parameter> components=new Form();
        AuthenticationUtils.parseParameters(realm,components);
        for (        Parameter param : components) {
          result.getParameters().add(param.getName(),param.getValue());
        }
        result.setRealm(components.getFirstValue("realm"));
      }
    }
  }
  return result;
}
