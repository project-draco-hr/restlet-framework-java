{
  try {
    if (getIoState() == IoState.READ_INTEREST) {
      int result=readSocketBytes();
      while (getByteBuffer().hasRemaining() && (getMessageState() != MessageState.BODY)) {
        if (getMessageState() == MessageState.START_LINE) {
          readStartLine();
        }
 else         if (getMessageState() == MessageState.HEADERS) {
          readHeaders();
        }
        if (!getByteBuffer().hasRemaining() && (getMessageState() != MessageState.BODY)) {
          result=readSocketBytes();
        }
      }
      if (result == -1) {
        getConnection().close(true);
      }
    }
  }
 catch (  Exception e) {
    getLogger().log(Level.INFO,"Error while reading a message. Closing the connection.",e);
    getConnection().close(false);
  }
}
