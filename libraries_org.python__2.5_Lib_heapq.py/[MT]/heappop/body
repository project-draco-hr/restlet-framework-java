def heappop(heap):
    'Pop the smallest item off the heap, maintaining the heap invariant.'
    lastelt = heap.pop()
    if heap:
        returnitem = heap[0]
        heap[0] = lastelt
        _siftup(heap, 0)
    else:
        returnitem = lastelt
    return returnitem
