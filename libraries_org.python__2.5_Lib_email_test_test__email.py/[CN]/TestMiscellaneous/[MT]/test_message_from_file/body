def test_message_from_file(self):
    fp = openfile('msg_01.txt')
    try:
        text = fp.read()
        fp.seek(0)
        msg = email.message_from_file(fp)
        s = StringIO()
        g = Generator(s, maxheaderlen=0)
        g.flatten(msg)
        self.assertEqual(text, s.getvalue())
    finally:
        fp.close()
