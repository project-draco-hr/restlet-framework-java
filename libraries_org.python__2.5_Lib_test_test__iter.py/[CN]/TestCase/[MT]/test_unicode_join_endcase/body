def test_unicode_join_endcase(self):


    class OhPhooey:

        def __init__(self, seq):
            self.it = iter(seq)
            self.i = 0

        def __iter__(self):
            return self

        def next(self):
            i = self.i
            self.i = (i + 1)
            if (i == 2):
                return unicode('fooled you!')
            return self.it.next()
    f = open(TESTFN, 'w')
    try:
        f.write((('a\n' + 'b\n') + 'c\n'))
    finally:
        f.close()
    f = open(TESTFN, 'r')
    try:
        got = ' - '.join(OhPhooey(f))
        self.assertEqual(got, unicode('a\n - b\n - fooled you! - c\n'))
    finally:
        f.close()
        try:
            unlink(TESTFN)
        except OSError:
            pass
