def check_update(self, klass, dict):
    weakdict = klass()
    weakdict.update(dict)
    self.assert_((len(weakdict) == len(dict)))
    for k in weakdict.keys():
        self.assert_(dict.has_key(k), 'mysterious new key appeared in weak dict')
        v = dict.get(k)
        self.assert_((v is weakdict[k]))
        self.assert_((v is weakdict.get(k)))
    for k in dict.keys():
        self.assert_(weakdict.has_key(k), 'original key disappeared in weak dict')
        v = dict[k]
        self.assert_((v is weakdict[k]))
        self.assert_((v is weakdict.get(k)))
