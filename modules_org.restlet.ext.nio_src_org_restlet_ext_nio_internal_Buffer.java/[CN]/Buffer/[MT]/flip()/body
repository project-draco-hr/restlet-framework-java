{
  if (isFilling()) {
    setState(BufferState.DRAINING);
    getBytes().limit(getBytes().position());
    getBytes().position(this.fillBegin);
    this.fillBegin=0;
  }
 else   if (isDraining()) {
    if (hasRemaining()) {
      setState(BufferState.FILLING);
      this.fillBegin=getBytes().position();
      getBytes().position(getBytes().limit());
      getBytes().limit(getBytes().capacity());
    }
 else {
      clear();
    }
  }
}
