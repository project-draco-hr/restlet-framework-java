def read(self, amt=None):
    if (self.fp is None):
        return ''
    if self.chunked:
        return self._read_chunked(amt)
    if (amt is None):
        if (self.length is None):
            s = self.fp.read()
        else:
            s = self._safe_read(self.length)
            self.length = 0
        self.close()
        return s
    if (self.length is not None):
        if (amt > self.length):
            amt = self.length
    s = self.fp.read(amt)
    if (self.length is not None):
        self.length -= len(s)
    return s
