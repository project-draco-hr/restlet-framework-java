{
  Representation r=new SaxRepresentation(MediaType.APPLICATION_XML){
    @Override public void write(    XmlWriter writer) throws IOException {
      try {
        writer.forceNSDecl("http://schemas.microsoft.com/ado/2007/08/dataservices/metadata","m");
        writer.forceNSDecl("http://schemas.microsoft.com/ado/2007/08/dataservices","ds");
        writer.startElement("http://schemas.microsoft.com/ado/2007/08/dataservices/metadata","properties");
        for (        Field field : entity.getClass().getDeclaredFields()) {
          String getter="get" + field.getName().substring(0,1).toUpperCase() + field.getName().substring(1);
          Property prop=getMetadata().getProperty(entity,field.getName());
          if (prop != null) {
            for (            Method method : entity.getClass().getDeclaredMethods()) {
              if (method.getReturnType() != null && getter.equals(method.getName()) && method.getParameterTypes().length == 0) {
                Object value=null;
                try {
                  value=method.invoke(entity,(Object[])null);
                }
 catch (                Exception e) {
                }
                if (value != null) {
                  writer.startElement("http://schemas.microsoft.com/ado/2007/08/dataservices",prop.getName());
                  writer.characters(Type.toEdm(value,prop.getType()));
                  writer.endElement("http://schemas.microsoft.com/ado/2007/08/dataservices",prop.getName());
                }
 else {
                  writer.emptyElement("http://schemas.microsoft.com/ado/2007/08/dataservices",prop.getName());
                }
                break;
              }
            }
          }
        }
        writer.endElement("http://schemas.microsoft.com/ado/2007/08/dataservices/metadata","properties");
      }
 catch (      SAXException e) {
        throw new IOException(e.getMessage());
      }
    }
  }
;
  Content content=new Content();
  content.setInlineContent(r);
  content.setToEncode(false);
  return content;
}
