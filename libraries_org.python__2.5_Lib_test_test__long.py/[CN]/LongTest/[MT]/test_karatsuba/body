def test_karatsuba(self):
    digits = (range(1, 5) + range(KARATSUBA_CUTOFF, (KARATSUBA_CUTOFF + 10)))
    digits.extend([(KARATSUBA_CUTOFF * 10), (KARATSUBA_CUTOFF * 100)])
    bits = [(digit * SHIFT) for digit in digits]
    for abits in bits:
        a = ((1L << abits) - 1)
        for bbits in bits:
            if (bbits < abits):
                continue
            b = ((1L << bbits) - 1)
            x = (a * b)
            y = ((((1L << (abits + bbits)) - (1L << abits)) - (1L << bbits)) + 1)
            self.assertEqual(x, y, Frm('bad result for a*b: a=%r, b=%r, x=%r, y=%r', a, b, x, y))
