def test():
    import sys
    base = ''
    if sys.argv[1:]:
        fn = sys.argv[1]
        if (fn == '-'):
            fp = sys.stdin
        else:
            fp = open(fn)
    else:
        try:
            from cStringIO import StringIO
        except ImportError:
            from StringIO import StringIO
        fp = StringIO(test_input)
    while 1:
        line = fp.readline()
        if (not line):
            break
        words = line.split()
        if (not words):
            continue
        url = words[0]
        parts = urlparse(url)
        print ('%-10s : %s' % (url, parts))
        abs = urljoin(base, url)
        if (not base):
            base = abs
        wrapped = ('<URL:%s>' % abs)
        print ('%-10s = %s' % (url, wrapped))
        if ((len(words) == 3) and (words[1] == '=')):
            if (wrapped != words[2]):
                print 'EXPECTED', words[2], '!!!!!!!!!!'
