def send(self, str):
    "Send `str' to the server."
    if (self.debuglevel > 0):
        print  >> stderr, 'send:', repr(str)
    if (hasattr(self, 'sock') and self.sock):
        try:
            self.sock.sendall(str)
        except socket.error:
            self.close()
            raise SMTPServerDisconnected('Server not connected')
    else:
        raise SMTPServerDisconnected('please run connect() first')
