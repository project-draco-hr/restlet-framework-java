def translation(domain, localedir=None, languages=None, class_=None, fallback=False, codeset=None):
    if (class_ is None):
        class_ = GNUTranslations
    mofiles = find(domain, localedir, languages, all=1)
    if (not mofiles):
        if fallback:
            return NullTranslations()
        raise IOError(ENOENT, 'No translation file found for domain', domain)
    result = None
    for mofile in mofiles:
        key = os.path.abspath(mofile)
        t = _translations.get(key)
        if (t is None):
            with open(mofile, 'rb') as fp:
                t = _translations.setdefault(key, class_(fp))
        t = copy.copy(t)
        if codeset:
            t.set_output_charset(codeset)
        if (result is None):
            result = t
        else:
            result.add_fallback(t)
    return result
