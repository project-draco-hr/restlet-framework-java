def find(domain, localedir=None, languages=None, all=0):
    if (localedir is None):
        localedir = _default_localedir
    if (languages is None):
        languages = []
        for envar in ('LANGUAGE', 'LC_ALL', 'LC_MESSAGES', 'LANG'):
            val = os.environ.get(envar)
            if val:
                languages = val.split(':')
                break
        if ('C' not in languages):
            languages.append('C')
    nelangs = []
    for lang in languages:
        for nelang in _expand_lang(lang):
            if (nelang not in nelangs):
                nelangs.append(nelang)
    if all:
        result = []
    else:
        result = None
    for lang in nelangs:
        if (lang == 'C'):
            break
        mofile = os.path.join(localedir, lang, 'LC_MESSAGES', ('%s.mo' % domain))
        if os.path.exists(mofile):
            if all:
                result.append(mofile)
            else:
                return mofile
    return result
