{
  ClientResource resource=new ClientResource(reference);
  if (clientConnector != null) {
    resource.setNext(clientConnector);
  }
  resource.setChallengeResponse(getCredentials());
  if (getClientVersion() != null || getMaxClientVersion() != null) {
    Form form=new Form();
    if (getClientVersion() != null) {
      form.add("DataServiceVersion",getClientVersion());
    }
    if (getMaxClientVersion() != null) {
      form.add("MaxDataServiceVersion",getMaxClientVersion());
    }
    resource.getRequestAttributes().put(HeaderConstants.ATTRIBUTE_HEADERS,form);
  }
  return resource;
}
