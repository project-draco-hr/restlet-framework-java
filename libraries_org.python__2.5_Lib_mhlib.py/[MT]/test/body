def test():
    global mh, f
    os.system('rm -rf $HOME/Mail/@test')
    mh = MH()

    def do(s):
        print s
        print eval(s)
    do('mh.listfolders()')
    do('mh.listallfolders()')
    testfolders = ['@test', '@test/test1', '@test/test2', '@test/test1/test11', '@test/test1/test12', '@test/test1/test11/test111']
    for t in testfolders:
        do(('mh.makefolder(%r)' % (t,)))
    do("mh.listsubfolders('@test')")
    do("mh.listallsubfolders('@test')")
    f = mh.openfolder('@test')
    do('f.listsubfolders()')
    do('f.listallsubfolders()')
    do('f.getsequences()')
    seqs = f.getsequences()
    seqs['foo'] = IntSet('1-10 12-20', ' ').tolist()
    print seqs
    f.putsequences(seqs)
    do('f.getsequences()')
    for t in reversed(testfolders):
        do(('mh.deletefolder(%r)' % (t,)))
    do('mh.getcontext()')
    context = mh.getcontext()
    f = mh.openfolder(context)
    do('f.getcurrent()')
    for seq in ('first', 'last', 'cur', '.', 'prev', 'next', 'first:3', 'last:3', 'cur:3', 'cur:-3', 'prev:3', 'next:3', '1:3', '1:-3', '100:3', '100:-3', '10000:3', '10000:-3', 'all'):
        try:
            do(('f.parsesequence(%r)' % (seq,)))
        except Error as msg:
            print 'Error:', msg
        stuff = os.popen(('pick %r 2>/dev/null' % (seq,))).read()
        list = map(int, stuff.split())
        print list, '<-- pick'
    do('f.listmessages()')
