def test_args(self):
    s = StringIO.StringIO()
    sys.stdout = sys.stderr = s
    save_handlers = atexit._exithandlers
    atexit._exithandlers = []
    try:
        atexit.register(self.h1)
        atexit.register(self.h4)
        atexit.register(self.h4, 4, kw='abc')
        atexit._run_exitfuncs()
    finally:
        sys.stdout = sys.__stdout__
        sys.stderr = sys.__stderr__
        atexit._exithandlers = save_handlers
    self.assertEqual(s.getvalue(), "h4 (4,) {'kw': 'abc'}\nh4 () {}\nh1\n")
