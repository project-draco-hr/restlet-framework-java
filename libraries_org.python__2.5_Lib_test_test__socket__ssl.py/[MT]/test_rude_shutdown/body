def test_rude_shutdown():
    if test_support.is_jython:
        return
    try:
        import thread
    except ImportError:
        return
    PORT = 9934

    def listener():
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.bind(('', PORT))
        s.listen(5)
        s.accept()
        del s
        thread.exit()

    def connector():
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(('localhost', PORT))
        try:
            ssl_sock = socket.ssl(s)
        except socket.sslerror:
            pass
        else:
            raise test_support.TestFailed, 'connecting to closed SSL socket failed'
    thread.start_new_thread(listener, ())
    time.sleep(1)
    connector()
