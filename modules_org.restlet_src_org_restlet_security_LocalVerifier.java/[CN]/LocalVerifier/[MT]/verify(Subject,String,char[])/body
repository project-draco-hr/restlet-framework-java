{
  boolean result=false;
  final char[] outputSecret=getSecret(identifier);
  if ((inputSecret == null) || (outputSecret == null)) {
    result=(inputSecret == outputSecret);
  }
 else {
    if (inputSecret.length == outputSecret.length) {
      boolean equals=true;
      for (int i=0; (i < inputSecret.length) && equals; i++) {
        equals=(inputSecret[i] == outputSecret[i]);
      }
      result=equals;
    }
  }
  if (result) {
    subject.getPrincipals().add(new Principal(identifier));
  }
  return result;
}
