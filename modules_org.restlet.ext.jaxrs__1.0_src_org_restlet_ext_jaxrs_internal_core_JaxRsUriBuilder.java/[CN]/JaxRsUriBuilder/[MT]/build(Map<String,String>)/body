{
  Template template=new Template(toStringWithCheck(false));
  return buildUri(template.format(new Resolver(){
    public String resolve(    String variableName){
      String varValue=values.get(variableName);
      if (varValue == null)       throw new IllegalArgumentException("The value Map must contain a value for all given Templet variables. The value for variable " + variableName + " is missing");
      return varValue;
    }
  }
));
}
