{
  if (getContext() != null) {
    if (getPeerAddress() != null) {
      setEngine(getContext().createSSLEngine(getPeerAddress().getHostName(),getPeerAddress().getPort()));
    }
 else {
      setEngine(getContext().createSSLEngine());
    }
    setState(SslState.CREATED);
    getEngine().setUseClientMode(isClientSide());
    getEngine().beginHandshake();
    setState(SslState.HANDSHAKING);
  }
}
