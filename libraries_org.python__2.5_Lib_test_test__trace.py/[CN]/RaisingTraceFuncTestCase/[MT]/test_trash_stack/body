def test_trash_stack(self):

    def f():
        for i in range(5):
            print i

    def g(frame, why, extra):
        if ((why == 'line') and (frame.f_lineno == (f.func_code.co_firstlineno + 2))):
            raise RuntimeError, 'i am crashing'
        return g
    sys.settrace(g)
    try:
        f()
    except RuntimeError:
        import gc
        gc.collect()
    else:
        self.fail('exception not propagated')
