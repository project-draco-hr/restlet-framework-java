def test_getweakrefs(self):
    o = C()
    ref1 = weakref.ref(o, self.callback)
    ref2 = weakref.ref(o, self.callback)
    del ref1
    self.assert_((weakref.getweakrefs(o) == [ref2]), 'list of refs does not match')
    o = C()
    ref1 = weakref.ref(o, self.callback)
    ref2 = weakref.ref(o, self.callback)
    del ref2
    self.assert_((weakref.getweakrefs(o) == [ref1]), 'list of refs does not match')
