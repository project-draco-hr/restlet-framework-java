def encode(in_file, out_file, name=None, mode=None):
    'Uuencode file'
    close_in_file = False
    close_out_file = False
    if (in_file == '-'):
        in_file = sys.stdin
    elif isinstance(in_file, basestring):
        if (name is None):
            name = os.path.basename(in_file)
        if (mode is None):
            try:
                mode = os.stat(in_file).st_mode
            except AttributeError:
                pass
        in_file = open(in_file, 'rb')
        close_in_file = True
    if (out_file == '-'):
        out_file = sys.stdout
    elif isinstance(out_file, basestring):
        out_file = open(out_file, 'w')
        close_out_file = True
    if (name is None):
        name = '-'
    if (mode is None):
        mode = 438
    out_file.write(('begin %o %s\n' % ((mode & 511), name)))
    data = in_file.read(45)
    while (len(data) > 0):
        out_file.write(binascii.b2a_uu(data))
        data = in_file.read(45)
    out_file.write(' \nend\n')
    if close_in_file:
        in_file.close()
    if close_out_file:
        out_file.close()
