def pop_margin(self):
    if self.margin_stack:
        del self.margin_stack[(-1)]
    fstack = filter(None, self.margin_stack)
    if fstack:
        margin = fstack[(-1)]
    else:
        margin = None
    self.writer.new_margin(margin, len(fstack))
