def raises(exc, expected, callable, *args):
    'Ensure the expected exception is raised'
    try:
        callable(*args)
    except exc as msg:
        if (expected is not None):
            if isinstance(expected, str):
                if (str(msg) != expected):
                    raise test_support.TestFailed(('Message %r, expected %r' % (str(msg), expected)))
            elif isinstance(expected, int):
                if (msg.errno != expected):
                    raise test_support.TestFailed(('errno %r, expected %r' % (msg, expected)))
    else:
        raise test_support.TestFailed(('Expected %s' % exc))
