{
  if (entity.getMediaType().equals(MediaType.APPLICATION_WWW_FORM,true)) {
    boolean canSet=true;
    if (getUser() == null) {
      setUser(new User());
      getUser().setName(this.userName);
      getResponse().setStatus(Status.SUCCESS_CREATED);
    }
 else {
switch (checkAuthorization()) {
case 1:
        getResponse().setStatus(Status.SUCCESS_NO_CONTENT);
      break;
case 0:
    challenge();
  canSet=false;
break;
case -1:
getResponse().setStatus(Status.CLIENT_ERROR_UNAUTHORIZED);
canSet=false;
break;
}
}
if (canSet) {
Form form=new Form(entity);
getUser().setEmail(form.getFirstValue("user[email]"));
getUser().setFullName(form.getFirstValue("user[full_name]"));
getUser().setPassword(form.getFirstValue("user[password]"));
getContainer().store(getUser());
getContainer().commit();
}
}
}
