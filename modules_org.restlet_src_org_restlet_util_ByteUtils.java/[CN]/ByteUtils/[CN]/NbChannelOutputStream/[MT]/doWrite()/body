{
  if ((this.channel != null) && (this.bb != null)) {
    try {
      int bytesWritten;
      while (this.bb.hasRemaining()) {
        bytesWritten=this.channel.write(this.bb);
        if (bytesWritten < 0) {
          throw new IOException("Unexpected negative number of bytes written.");
        }
 else         if (bytesWritten == 0) {
          if (SelectorFactory.getSelector().select(10000) == 0) {
            throw new IOException("Unable to select the channel to write to it. Selection timed out.");
          }
        }
      }
    }
 catch (    final IOException ioe) {
      throw new IOException("Unable to write to the non-blocking channel. " + ioe.getLocalizedMessage());
    }
 finally {
      this.bb.clear();
    }
  }
 else {
    throw new IOException("Unable to write. Null byte buffer or channel detected.");
  }
}
