def test_modify(self):
    mh = getMH()
    eq = self.assertEquals
    mh.makefolder('dummy1')
    self.assert_(('dummy1' in mh.listfolders()))
    path = os.path.join(_mhpath, 'dummy1')
    self.assert_(os.path.exists(path))
    f = mh.openfolder('dummy1')

    def create(n):
        msg = ('From: foo\nSubject: %s\n\nDummy Message %s\n' % (n, n))
        f.createmessage(n, StringIO.StringIO(msg))
    create(7)
    create(8)
    create(9)
    eq(readFile(f.getmessagefilename(9)), 'From: foo\nSubject: 9\n\nDummy Message 9\n')
    eq(f.listmessages(), [7, 8, 9])
    files = os.listdir(path)
    files.sort()
    eq(files, ['7', '8', '9'])
    f.removemessages(['7', '8'])
    files = os.listdir(path)
    files.sort()
    eq(files, [',7', ',8', '9'])
    eq(f.listmessages(), [9])
    create(10)
    create(11)
    create(12)
    mh.makefolder('dummy2')
    f2 = mh.openfolder('dummy2')
    eq(f2.listmessages(), [])
    f.movemessage(10, f2, 3)
    f.movemessage(11, f2, 5)
    eq(f.listmessages(), [9, 12])
    eq(f2.listmessages(), [3, 5])
    eq(readFile(f2.getmessagefilename(3)), 'From: foo\nSubject: 10\n\nDummy Message 10\n')
    f.copymessage(9, f2, 4)
    eq(f.listmessages(), [9, 12])
    eq(readFile(f2.getmessagefilename(4)), 'From: foo\nSubject: 9\n\nDummy Message 9\n')
    f.refilemessages([9, 12], f2)
    eq(f.listmessages(), [])
    eq(f2.listmessages(), [3, 4, 5, 6, 7])
    eq(readFile(f2.getmessagefilename(7)), 'From: foo\nSubject: 12\n\nDummy Message 12\n')
    mh.deletefolder('dummy1')
    mh.deletefolder('dummy2')
    self.assert_(('dummy1' not in mh.listfolders()))
    self.assert_((not os.path.exists(path)))
