{
  final String decodedPath=LocalReference.localizePath(Reference.decode(path));
  File file=new File(decodedPath);
  final MetadataService metadataService=getMetadataService(request);
  if (request.getMethod().equals(Method.GET) || request.getMethod().equals(Method.HEAD)) {
    handleFileGet(request,response,path,file,metadataService);
  }
 else   if (request.getMethod().equals(Method.PUT)) {
    handleFilePut(request,response,path,file,metadataService);
  }
 else   if (request.getMethod().equals(Method.DELETE)) {
    handleFileDelete(response,file);
  }
 else {
    response.setStatus(Status.CLIENT_ERROR_METHOD_NOT_ALLOWED);
    response.getAllowedMethods().add(Method.GET);
    response.getAllowedMethods().add(Method.HEAD);
    response.getAllowedMethods().add(Method.PUT);
    response.getAllowedMethods().add(Method.DELETE);
  }
}
