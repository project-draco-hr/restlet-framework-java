{
  try {
    if (getDocument() != null) {
      Transformer transformer=TransformerFactory.newInstance().newTransformer();
      if (getDocument().getDoctype() != null) {
        transformer.setOutputProperty(OutputKeys.DOCTYPE_SYSTEM,getDocument().getDoctype().getSystemId());
        transformer.setOutputProperty(OutputKeys.DOCTYPE_PUBLIC,getDocument().getDoctype().getPublicId());
      }
      transformer.transform(new DOMSource(getDocument()),new StreamResult(outputStream));
    }
  }
 catch (  TransformerConfigurationException tce) {
    throw new IOException("Couldn't write the XML representation: " + tce.getMessage());
  }
catch (  TransformerException te) {
    throw new IOException("Couldn't write the XML representation: " + te.getMessage());
  }
catch (  TransformerFactoryConfigurationError tfce) {
    throw new IOException("Couldn't write the XML representation: " + tfce.getMessage());
  }
}
