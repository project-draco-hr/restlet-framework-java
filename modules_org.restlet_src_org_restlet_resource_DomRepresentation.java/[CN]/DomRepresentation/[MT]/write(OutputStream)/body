{
  try {
    if (getDocument() != null) {
      final Transformer transformer=createTransformer();
      transformer.transform(new DOMSource(getDocument()),new StreamResult(outputStream));
    }
  }
 catch (  final TransformerConfigurationException tce) {
    throw new IOException("Couldn't write the XML representation: " + tce.getMessage());
  }
catch (  final TransformerException te) {
    throw new IOException("Couldn't write the XML representation: " + te.getMessage());
  }
catch (  final TransformerFactoryConfigurationError tfce) {
    throw new IOException("Couldn't write the XML representation: " + tfce.getMessage());
  }
}
