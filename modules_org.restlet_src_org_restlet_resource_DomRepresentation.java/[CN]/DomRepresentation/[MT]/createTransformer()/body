{
  try {
    final Transformer transformer=TransformerFactory.newInstance().newTransformer();
    transformer.setOutputProperty(OutputKeys.METHOD,"xml");
    if (getDocument().getDoctype() != null) {
      transformer.setOutputProperty(OutputKeys.DOCTYPE_SYSTEM,getDocument().getDoctype().getSystemId());
      transformer.setOutputProperty(OutputKeys.DOCTYPE_PUBLIC,getDocument().getDoctype().getPublicId());
      transformer.setOutputProperty(OutputKeys.INDENT,Boolean.toString(isIndent()));
    }
    return transformer;
  }
 catch (  TransformerConfigurationException tce) {
    throw new IOException("Couldn't write the XML representation: " + tce.getMessage());
  }
}
