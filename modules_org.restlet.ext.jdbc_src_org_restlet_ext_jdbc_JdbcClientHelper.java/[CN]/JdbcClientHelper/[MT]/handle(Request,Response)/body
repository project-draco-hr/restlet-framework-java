{
  Connection connection=null;
  if (request.getMethod().equals(Method.POST)) {
    try {
      String connectionURI=request.getResourceRef().toString();
      DocumentBuilder docBuilder=DocumentBuilderFactory.newInstance().newDocumentBuilder();
      Document requestDoc=docBuilder.parse(new InputSource(request.getEntity().getReader()));
      Element rootElt=(Element)requestDoc.getElementsByTagName("request").item(0);
      Element headerElt=(Element)rootElt.getElementsByTagName("header").item(0);
      Element connectionElt=(Element)headerElt.getElementsByTagName("connection").item(0);
      Node usePoolingNode=connectionElt.getElementsByTagName("usePooling").item(0);
      boolean usePooling=usePoolingNode.getTextContent().equals("true") ? true : false;
      Node startNode=headerElt.getElementsByTagName("start").item(0);
      int start=startNode != null && startNode.getTextContent().trim().length() > 0 ? Integer.parseInt(startNode.getTextContent()) : 0;
      Node limitNode=headerElt.getElementsByTagName("limit").item(0);
      int limit=limitNode != null && limitNode.getTextContent().trim().length() > 0 ? Integer.parseInt(limitNode.getTextContent()) : -1;
      NodeList propertyNodes=connectionElt.getElementsByTagName("property");
      Node propertyNode=null;
      Properties properties=null;
      String name=null;
      String value=null;
      for (int i=0; i < propertyNodes.getLength(); i++) {
        propertyNode=propertyNodes.item(i);
        if (properties == null) {
          properties=new Properties();
        }
        name=propertyNode.getAttributes().getNamedItem("name").getTextContent();
        value=propertyNode.getTextContent();
        properties.setProperty(name,value);
      }
      Node returnGeneratedKeysNode=headerElt.getElementsByTagName("returnGeneratedKeys").item(0);
      boolean returnGeneratedKeys=returnGeneratedKeysNode.getTextContent().equals("true") ? true : false;
      Element bodyElt=(Element)rootElt.getElementsByTagName("body").item(0);
      NodeList statementNodes=bodyElt.getElementsByTagName("statement");
      List<String> sqlRequests=new ArrayList<String>();
      for (int i=0; i < statementNodes.getLength(); i++) {
        String sqlRequest=statementNodes.item(i).getTextContent();
        sqlRequests.add(sqlRequest);
      }
      connection=getConnection(connectionURI,properties,usePooling);
      JdbcResult result=handleSqlRequests(connection,returnGeneratedKeys,sqlRequests);
      response.setEntity(new RowSetRepresentation(result,start,limit));
    }
 catch (    SQLException se) {
      getLogger().log(Level.WARNING,"Error while processing the SQL request",se);
      response.setStatus(Status.SERVER_ERROR_INTERNAL,se);
    }
catch (    ParserConfigurationException pce) {
      getLogger().log(Level.WARNING,"Error with XML parser configuration",pce);
      response.setStatus(Status.CLIENT_ERROR_BAD_REQUEST,pce);
    }
catch (    SAXException se) {
      getLogger().log(Level.WARNING,"Error while parsing the XML document",se);
      response.setStatus(Status.CLIENT_ERROR_BAD_REQUEST,se);
    }
catch (    IOException ioe) {
      getLogger().log(Level.WARNING,"Input/Output exception",ioe);
      response.setStatus(Status.SERVER_ERROR_INTERNAL,ioe);
    }
  }
 else {
    throw new IllegalArgumentException("Only the POST method is supported");
  }
}
