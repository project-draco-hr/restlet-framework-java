def testNormalize():
    doc = parseString('<doc/>')
    root = doc.documentElement
    root.appendChild(doc.createTextNode('first'))
    root.appendChild(doc.createTextNode('second'))
    confirm(((len(root.childNodes) == 2) and (root.childNodes.length == 2)), 'testNormalize -- preparation')
    doc.normalize()
    confirm(((len(root.childNodes) == 1) and (root.childNodes.length == 1) and (root.firstChild is root.lastChild) and (root.firstChild.data == 'firstsecond')), 'testNormalize -- result')
    doc.unlink()
    doc = parseString('<doc/>')
    root = doc.documentElement
    root.appendChild(doc.createTextNode(''))
    doc.normalize()
    confirm(((len(root.childNodes) == 0) and (root.childNodes.length == 0)), 'testNormalize -- single empty node removed')
    doc.unlink()
