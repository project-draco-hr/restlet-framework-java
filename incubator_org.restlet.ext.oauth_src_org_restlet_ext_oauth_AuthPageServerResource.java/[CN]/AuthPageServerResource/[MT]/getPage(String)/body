{
  String clientId=getQuery().getFirstValue("client");
  Client client=clients.findById(clientId);
  String[] scopes=getQuery().getValuesArray("scope");
  String[] previousScopes=getQuery().getValuesArray("grantedScope");
  Configuration config=new Configuration();
  ContextTemplateLoader ctl=new ContextTemplateLoader(getContext(),"clap:///");
  config.setTemplateLoader(ctl);
  TemplateRepresentation result=new TemplateRepresentation(authPage,config,MediaType.TEXT_HTML);
  HashMap<String,Object> data=new HashMap<String,Object>();
  data.put("target",getRootRef() + "/auth_page");
  data.put("clientId",clientId);
  data.put("clientDescription",client.toString());
  data.put("clientCallback",client.getRedirectUri());
  data.put("clientName",client.getApplicationName());
  data.put("requestingScopes",scopes);
  data.put("grantedScopes",previousScopes);
  result.setDataModel(data);
  return result;
}
