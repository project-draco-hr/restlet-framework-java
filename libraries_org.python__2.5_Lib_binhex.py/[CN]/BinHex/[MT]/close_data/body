def close_data(self):
    if (self.dlen != 0):
        raise Error, ('Incorrect data size, diff=%r' % (self.rlen,))
    self._writecrc()
    self.state = _DID_DATA
