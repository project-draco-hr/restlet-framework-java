def __write(self, s):
    'Write string s to the stream if a whole new block\n           is ready to be written.\n        '
    self.buf += s
    while (len(self.buf) > self.bufsize):
        self.fileobj.write(self.buf[:self.bufsize])
        self.buf = self.buf[self.bufsize:]
