def chown(self, tarinfo, targetpath):
    'Set owner of targetpath according to tarinfo.\n        '
    if (pwd and hasattr(os, 'geteuid') and (os.geteuid() == 0)):
        try:
            g = grp.getgrnam(tarinfo.gname)[2]
        except KeyError:
            try:
                g = grp.getgrgid(tarinfo.gid)[2]
            except KeyError:
                g = os.getgid()
        try:
            u = pwd.getpwnam(tarinfo.uname)[2]
        except KeyError:
            try:
                u = pwd.getpwuid(tarinfo.uid)[2]
            except KeyError:
                u = os.getuid()
        try:
            if (tarinfo.issym() and hasattr(os, 'lchown')):
                os.lchown(targetpath, u, g)
            elif (sys.platform != 'os2emx'):
                os.chown(targetpath, u, g)
        except EnvironmentError as e:
            raise ExtractError('could not change owner')
