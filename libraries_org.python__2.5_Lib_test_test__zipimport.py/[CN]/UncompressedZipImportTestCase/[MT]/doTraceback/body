def doTraceback(self, module):
    try:
        module.do_raise()
    except:
        tb = sys.exc_info()[2].tb_next
        (f, lno, n, line) = extract_tb(tb, 1)[0]
        self.assertEqual(line, raise_src.strip())
        (f, lno, n, line) = extract_stack(tb.tb_frame, 1)[0]
        self.assertEqual(line, raise_src.strip())
        s = StringIO.StringIO()
        print_tb(tb, 1, s)
        self.failUnless(s.getvalue().endswith(raise_src))
    else:
        raise AssertionError('This ought to be impossible')
