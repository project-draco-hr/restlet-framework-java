def test_fdopen(self):
    origw_fp = open(self.filename, 'w')
    origw = origw_fp.fileno()
    origr_fp = open(self.filename, 'r')
    origr = origr_fp.fileno()
    raises(ValueError, "invalid file mode 'b'", os.fdopen, origr, 'b')
    "\n        raises(OSError, '[Errno 22] Invalid argument',\n               os.fdopen, origw, 'r')\n        raises(OSError, '[Errno 22] Invalid argument',\n               os.fdopen, origr, 'w')\n               "
    fp = os.fdopen(origw, 'w')
    fp.write('fdopen')
    fp.close()
    fp = os.fdopen(origr)
    self.assertEquals(fp.read(), 'fdopen')
    raises(IOError, None, fp.write, 'test')
    fp.close()
    raises(OSError, None, os.fdopen, origw, 'w')
    raises(OSError, None, os.fdopen, origr, 'r')
    try:
        origw_fp.close()
    except:
        pass
    try:
        origr_fp.close()
    except:
        pass
    try:
        os.close(origw)
    except:
        pass
    try:
        os.close(origr)
    except:
        pass
