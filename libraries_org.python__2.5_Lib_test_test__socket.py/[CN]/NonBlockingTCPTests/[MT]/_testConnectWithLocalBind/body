def _testConnectWithLocalBind(self):
    cli_port = (self.PORT - 1)
    while True:
        self.cli.settimeout(1)
        self.cli.bind((self.HOST, cli_port))
        try:
            self.cli.connect((self.HOST, self.PORT))
            break
        except socket.error as se:
            self.failUnlessEqual(se[0], errno.EADDRINUSE)
            try:
                self.cli.close()
            except socket.error:
                pass
            self.clientSetUp()
            cli_port -= 1
    (bound_host, bound_port) = self.cli.getsockname()
    self.failUnlessEqual(bound_port, cli_port)
