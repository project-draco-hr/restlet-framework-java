def process_opt(self, option, opt, value, parser_):
    if (opt == '-x'):
        self.assertEqual(option._short_opts, ['-x'])
        self.assertEqual(option._long_opts, [])
        self.assert_((parser_ is self.parser))
        self.assert_((value is None))
        self.assertEqual(vars(parser_.values), {'filename': None, })
        parser_.values.x = 42
    elif (opt == '--file'):
        self.assertEqual(option._short_opts, ['-f'])
        self.assertEqual(option._long_opts, ['--file'])
        self.assert_((parser_ is self.parser))
        self.assertEqual(value, 'foo')
        self.assertEqual(vars(parser_.values), {'filename': None, 'x': 42, })
        setattr(parser_.values, option.dest, value)
    else:
        self.fail(('Unknown option %r in process_opt.' % opt))
