def test_stdin_pipe(self):
    p = subprocess.Popen([sys.executable, '-c', 'import sys; sys.exit(sys.stdin.read() == "pear")'], stdin=subprocess.PIPE)
    p.stdin.write('pear')
    p.stdin.close()
    p.wait()
    self.assertEqual(p.returncode, 1)
