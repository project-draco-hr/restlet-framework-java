def testPutEnv(self):
    'Put an environment variable and ensure that spawned processes see the change'
    value = 'Value we set'
    os.putenv('NEWVARIABLE', value)
    newValue = os.popen('echo $NEWVARIABLE').read().strip()
    if (newValue == '$NEWVARIABLE'):
        newValue = os.popen('echo %NEWVARIABLE%').read().strip()
    if (newValue == '%NEWVARIABLE%'):
        raise test_support.TestSkipped('Unable to find a subshell to execute echo')
    assert (newValue == value), ('Expected (%s) to equal value we set (%s)' % (newValue, value))
