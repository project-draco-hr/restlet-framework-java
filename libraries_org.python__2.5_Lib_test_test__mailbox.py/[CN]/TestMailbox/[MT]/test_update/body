def test_update(self):
    key0 = self._box.add((self._template % 'original 0'))
    key1 = self._box.add((self._template % 'original 1'))
    key2 = self._box.add((self._template % 'original 2'))
    self._box.update({key0: (self._template % 'changed 0'), key2: _sample_message, })
    self.assert_((len(self._box) == 3))
    self.assert_((self._box.get_string(key0) == (self._template % 'changed 0')))
    self.assert_((self._box.get_string(key1) == (self._template % 'original 1')))
    self._check_sample(self._box[key2])
    self._box.update([(key2, (self._template % 'changed 2')), (key1, (self._template % 'changed 1')), (key0, (self._template % 'original 0'))])
    self.assert_((len(self._box) == 3))
    self.assert_((self._box.get_string(key0) == (self._template % 'original 0')))
    self.assert_((self._box.get_string(key1) == (self._template % 'changed 1')))
    self.assert_((self._box.get_string(key2) == (self._template % 'changed 2')))
    self.assertRaises(KeyError, (lambda : self._box.update({'foo': 'bar', key0: (self._template % 'changed 0'), })))
    self.assert_((len(self._box) == 3))
    self.assert_((self._box.get_string(key0) == (self._template % 'changed 0')))
    self.assert_((self._box.get_string(key1) == (self._template % 'changed 1')))
    self.assert_((self._box.get_string(key2) == (self._template % 'changed 2')))
