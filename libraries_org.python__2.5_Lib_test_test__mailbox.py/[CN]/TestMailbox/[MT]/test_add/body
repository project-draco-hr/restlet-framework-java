def test_add(self):
    keys = []
    keys.append(self._box.add((self._template % 0)))
    self.assert_((len(self._box) == 1))
    keys.append(self._box.add(mailbox.Message(_sample_message)))
    self.assert_((len(self._box) == 2))
    keys.append(self._box.add(email.message_from_string(_sample_message)))
    self.assert_((len(self._box) == 3))
    keys.append(self._box.add(StringIO.StringIO(_sample_message)))
    self.assert_((len(self._box) == 4))
    keys.append(self._box.add(_sample_message))
    self.assert_((len(self._box) == 5))
    self.assert_((self._box.get_string(keys[0]) == (self._template % 0)))
    for i in (1, 2, 3, 4):
        self._check_sample(self._box[keys[i]])
