def test_consistent_factory(self):
    msg = mailbox.MaildirMessage((self._template % 0))
    msg.set_subdir('cur')
    msg.set_flags('RF')
    key = self._box.add(msg)


    class FakeMessage(mailbox.MaildirMessage):
        pass
    box = mailbox.Maildir(self._path, factory=FakeMessage)
    box.colon = self._box.colon
    msg2 = box.get_message(key)
    self.assert_(isinstance(msg2, FakeMessage))
