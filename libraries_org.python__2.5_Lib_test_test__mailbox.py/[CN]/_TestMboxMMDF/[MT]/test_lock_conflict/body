def test_lock_conflict(self):
    if (not hasattr(os, 'fork')):
        return
    pid = os.fork()
    if (pid == 0):
        self._box.lock()
        time.sleep(2)
        self._box.unlock()
        os._exit(0)
    time.sleep(0.5)
    try:
        self.assertRaises(mailbox.ExternalClashError, self._box.lock)
    finally:
        (exited_pid, status) = os.waitpid(pid, 0)
    self._box.lock()
    self._box.unlock()
