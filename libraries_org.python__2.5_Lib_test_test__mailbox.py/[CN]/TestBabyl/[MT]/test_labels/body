def test_labels(self):
    self.assert_((self._box.get_labels() == []))
    msg0 = mailbox.BabylMessage((self._template % 0))
    msg0.add_label('foo')
    key0 = self._box.add(msg0)
    self.assert_((self._box.get_labels() == ['foo']))
    msg1 = mailbox.BabylMessage((self._template % 1))
    msg1.set_labels(['bar', 'answered', 'foo'])
    key1 = self._box.add(msg1)
    self.assert_((set(self._box.get_labels()) == set(['foo', 'bar'])))
    msg0.set_labels(['blah', 'filed'])
    self._box[key0] = msg0
    self.assert_((set(self._box.get_labels()) == set(['foo', 'bar', 'blah'])))
    self._box.remove(key1)
    self.assert_((set(self._box.get_labels()) == set(['blah'])))
