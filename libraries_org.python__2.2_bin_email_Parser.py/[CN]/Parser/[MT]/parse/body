def parse(self, fp, headersonly=False):
    'Create a message structure from the data in a file.\n\n        Reads all the data from the file and returns the root of the message\n        structure.  Optional headersonly is a flag specifying whether to stop\n        parsing after reading the headers or not.  The default is False,\n        meaning it parses the entire contents of the file.\n        '
    root = self._class()
    firstbodyline = self._parseheaders(root, fp)
    if (not headersonly):
        self._parsebody(root, fp, firstbodyline)
    return root
