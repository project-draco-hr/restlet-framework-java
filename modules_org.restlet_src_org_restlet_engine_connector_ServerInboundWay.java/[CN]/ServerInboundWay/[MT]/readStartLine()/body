{
  String requestMethod=null;
  String requestUri=null;
  String version=null;
  int i=0;
  int start=0;
  int size=getLineBuilder().length();
  char next;
  if (size == 0) {
  }
 else {
    for (i=start; (requestMethod == null) && (i < size); i++) {
      next=getLineBuilder().charAt(i);
      if (HeaderUtils.isSpace(next)) {
        requestMethod=getLineBuilder().substring(start,i);
        start=i + 1;
      }
    }
    if ((requestMethod == null) || (i == size)) {
      throw new IOException("Unable to parse the request method. End of line reached too early.");
    }
    for (i=start; (requestUri == null) && (i < size); i++) {
      next=getLineBuilder().charAt(i);
      if (HeaderUtils.isSpace(next)) {
        requestUri=getLineBuilder().substring(start,i);
        start=i + 1;
      }
    }
    if (i == size) {
      throw new IOException("Unable to parse the request URI. End of line reached too early.");
    }
    if ((requestUri == null) || (requestUri.equals(""))) {
      requestUri="/";
    }
    for (i=start; (version == null) && (i < size); i++) {
      next=getLineBuilder().charAt(i);
    }
    if (i == size) {
      version=getLineBuilder().substring(start,i);
      start=i + 1;
    }
    if (version == null) {
      throw new IOException("Unable to parse the protocol version. End of line reached too early.");
    }
    Request request=getHelper().createRequest(getConnection(),requestMethod,requestUri,version);
    Response response=getHelper().createResponse(request);
    setMessage(response);
    setMessageState(MessageState.HEADERS);
    clearLineBuilder();
  }
}
