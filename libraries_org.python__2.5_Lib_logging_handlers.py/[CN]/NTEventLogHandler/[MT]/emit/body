def emit(self, record):
    '\n        Emit a record.\n\n        Determine the message ID, event category and event type. Then\n        log the message in the NT event log.\n        '
    if self._welu:
        try:
            id = self.getMessageID(record)
            cat = self.getEventCategory(record)
            type = self.getEventType(record)
            msg = self.format(record)
            self._welu.ReportEvent(self.appname, id, cat, type, [msg])
        except (KeyboardInterrupt, SystemExit):
            raise
        except:
            self.handleError(record)
