{
  String token=call.get(ACCESS_TOKEN).toString();
  getLogger().fine("In Validator resource - searching for token = " + token);
  Token t=this.generator.findToken(token);
  if (t == null) {
    throw new OAuthException(OAuthError.invalid_token,"Token not found.",null);
  }
  getLogger().fine("In Validator resource - got token = " + t);
  if (t instanceof ExpireToken) {
    ExpireToken et=(ExpireToken)t;
    if (!token.equals(et.getToken())) {
      getLogger().warning("Should not use the refresh_token to sign!");
      throw new OAuthException(OAuthError.invalid_token,"Invalid Token.",null);
    }
  }
  return t;
}
