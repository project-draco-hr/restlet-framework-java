{
  File testFile=File.createTempFile("test",".txt",testDir);
  File testDirectory=new File(testDir,"try");
  testDirectory.mkdir();
  String testFileUrl=webSiteURL.concat(testFile.getName());
  String testDirectoryUrl=webSiteURL.concat(testDirectory.getName());
  directory.setIndexName(indexName);
  directory.setListingAllowed(false);
  Response response=handle(application,webSiteURL,webSiteURL,Method.GET,null,"1a");
  assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  directory.setListingAllowed(true);
  response=handle(application,webSiteURL,webSiteURL,Method.GET,null,"1b");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  if (response.getStatus().equals(Status.SUCCESS_OK)) {
    response.getEntity().write(System.out);
  }
  response=handle(application,webSiteURL,testFileUrl,Method.HEAD,null,"2a");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  response=handle(application,webSiteURL,webSiteURL + "123456.txt",Method.GET,null,"2b");
  assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  directory.setModifiable(false);
  response=handle(application,webSiteURL,baseFileUrl,Method.PUT,new StringRepresentation("this is test 3a"),"3a");
  assertEquals(Status.CLIENT_ERROR_METHOD_NOT_ALLOWED,response.getStatus());
  directory.setModifiable(true);
  response=handle(application,webSiteURL,baseFileUrl,Method.PUT,new StringRepresentation("this is test 3b"),"3b");
  assertEquals(Status.SUCCESS_CREATED,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrl,Method.GET,null,"4");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  if (response.getStatus().equals(Status.SUCCESS_OK)) {
    response.getEntity().write(System.out);
    System.out.println("");
  }
  response=handle(application,webSiteURL,baseFileUrlEn,Method.PUT,new StringRepresentation("this is a test - En"),"5a");
  assertEquals(Status.SUCCESS_CREATED,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrl,Method.HEAD,null,"5b");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlEn,Method.HEAD,null,"5c");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  response=handle(application,webSiteURL,testFileUrl,Method.DELETE,null,"6a-1");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  response=handle(application,webSiteURL,testFileUrl,Method.HEAD,null,"6a-2");
  assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  response=handle(application,webSiteURL,testFileUrl,Method.DELETE,null,"6b");
  assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  if (indexName.length() == 0) {
    response=handle(application,webSiteURL,testDirectoryUrl,Method.DELETE,null,"6c-1");
    assertEquals(Status.REDIRECTION_SEE_OTHER,response.getStatus());
    response=handle(application,response.getLocationRef().getIdentifier(),response.getLocationRef().getIdentifier(),Method.DELETE,null,"6c-2");
    assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
    response=handle(application,webSiteURL,webSiteURL,Method.DELETE,null,"6c-3");
    assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
  }
 else {
    response=handle(application,webSiteURL,testDirectoryUrl + "/",Method.DELETE,null,"6c-2");
    assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
    response=handle(application,webSiteURL,webSiteURL,Method.DELETE,null,"6c-3");
    assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  }
  response=handle(application,webSiteURL,baseFileUrlFr,Method.PUT,new StringRepresentation("message de test"),"7a");
  assertEquals(Status.SUCCESS_CREATED,response.getStatus());
  directory.setNegotiateContent(false);
  response=handle(application,webSiteURL,baseFileUrlFrBis,Method.PUT,new StringRepresentation("message de test"),"7b-1");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlFr,Method.HEAD,null,"7b-2");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlFrBis,Method.HEAD,null,"7b-3");
  assertTrue(response.getStatus().equals(Status.SUCCESS_OK));
  response=handle(application,webSiteURL,baseFileUrlFr,Method.DELETE,null,"7c-1");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlFr,Method.HEAD,null,"7c-2");
  assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlFrBis,Method.HEAD,null,"7c-3");
  assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlFrBis,Method.DELETE,null,"7c-4");
  assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  directory.setNegotiateContent(true);
  response=handle(application,webSiteURL,baseFileUrlFr,Method.PUT,new StringRepresentation("message de test"),"7d-1");
  assertEquals(Status.SUCCESS_CREATED,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlFrBis,Method.PUT,new StringRepresentation("message de test Bis"),"7d-2");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlFr,Method.HEAD,null,"7d-3");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlFrBis,Method.HEAD,null,"7d-4");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  directory.setNegotiateContent(false);
  response=handle(application,webSiteURL,baseFileUrlFr,Method.HEAD,null,"7d-5");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  directory.setNegotiateContent(true);
  response=handle(application,webSiteURL,baseFileUrlFr,Method.DELETE,null,"7e-1");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlFr,Method.HEAD,null,"7e-2");
  if (application.getTunnelService().isExtensionsTunnel()) {
    assertEquals(Status.SUCCESS_OK,response.getStatus());
  }
 else {
    assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  }
  response=handle(application,webSiteURL,baseFileUrlFrBis,Method.HEAD,null,"7e-8");
  if (application.getTunnelService().isExtensionsTunnel()) {
    assertEquals(Status.SUCCESS_OK,response.getStatus());
  }
 else {
    assertEquals(Status.CLIENT_ERROR_NOT_FOUND,response.getStatus());
  }
  response=handle(application,webSiteURL,baseFileUrl,Method.DELETE,null,"8a");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  response=handle(application,webSiteURL,baseFileUrlEn,Method.DELETE,null,"8b");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  directory.setModifiable(true);
  response=handle(application,webSiteURL,percentEncodedFileUrl,Method.PUT,new StringRepresentation("this is test 9a"),"9a");
  assertEquals(Status.SUCCESS_CREATED,response.getStatus());
  response=handle(application,webSiteURL,percentEncodedFileUrl,Method.GET,null,"9b");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  if (response.getStatus().equals(Status.SUCCESS_OK)) {
    response.getEntity().write(System.out);
    System.out.println("");
  }
  response=handle(application,webSiteURL,percentEncodedFileUrlBis,Method.GET,null,"9c");
  assertEquals(Status.SUCCESS_OK,response.getStatus());
  if (response.getStatus().equals(Status.SUCCESS_OK)) {
    response.getEntity().write(System.out);
    System.out.println("");
  }
  response=handle(application,webSiteURL,percentEncodedFileUrl,Method.DELETE,null,"9d");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  testDirectory.delete();
  System.out.println("End of tests*********************");
}
