def refop(x, y, opname, ropname):
    t1 = type(x)
    t2 = type(y)
    (op, where1) = lookup_where(x, opname)
    (rop, where2) = lookup_where(y, ropname)
    if ((op is None) and (rop is not None)):
        return rop(y, x)
    if (rop and (where1 is not where2)):
        if (issubclass(t2, t1) and (not issubclass(where1, where2)) and (not issubclass(t1, where2))):
            return rop(y, x)
    if (op is None):
        return 'TypeError'
    return op(x, y)
