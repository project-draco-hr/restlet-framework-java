def receive(sock, n, timeout=20):
    (r, w, x) = select.select([sock], [], [], timeout)
    if (sock in r):
        return sock.recv(n)
    else:
        raise RuntimeError, ('timed out on %r' % (sock,))
