def test_main():
    import imp
    if imp.lock_held():
        raise TestSkipped("can't run when import lock is held")
    try:
        testall()
    finally:
        cleanup()
    reap_children()
