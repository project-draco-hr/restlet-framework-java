def _test_preparedstatement(self, dynamic):
    c = self.cursor(dynamic)
    try:
        p = c.prepare('select * from zxtesting where id = ?')
        for i in range(1, 8):
            c.execute(p, (i,))
            data = c.fetchall()
            self.assertEquals(1, len(data))
        assert (not p.closed)
        p.close()
        assert p.closed
        self.assertRaises(zxJDBC.ProgrammingError, c.execute, p, (1,))
    finally:
        c.close()
