def _dispatch(self, msg):
    for part in msg.walk():
        maintype = part.get_main_type('text')
        if (maintype == 'text'):
            print  >> self, part.get_payload(decode=True)
        elif (maintype == 'multipart'):
            pass
        else:
            print  >> self, (self._fmt % {'type': part.get_type('[no MIME type]'), 'maintype': part.get_main_type('[no main MIME type]'), 'subtype': part.get_subtype('[no sub-MIME type]'), 'filename': part.get_filename('[no filename]'), 'description': part.get('Content-Description', '[no description]'), 'encoding': part.get('Content-Transfer-Encoding', '[no encoding]'), })
