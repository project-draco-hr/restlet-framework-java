{
  Principal principal=Util.getPrincipal(request);
  if (principal == null)   return null;
  ChallengeResponse challengeResponse=request.getChallengeResponse();
  if (challengeResponse == null)   return null;
  ChallengeScheme authScheme=challengeResponse.getScheme();
  if (authScheme == null)   return null;
  if (authScheme.equals(ChallengeScheme.HTTP_BASIC))   return SecurityContext.BASIC_AUTH;
  if (authScheme.equals(ChallengeScheme.HTTP_DIGEST))   return SecurityContext.DIGEST_AUTH;
  return authScheme.getName();
}
