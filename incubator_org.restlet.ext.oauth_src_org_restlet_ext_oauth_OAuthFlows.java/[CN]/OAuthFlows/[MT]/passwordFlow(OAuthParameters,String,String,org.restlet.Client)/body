{
  OAuthUser result=null;
  Form form=new Form();
  form.add(OAuthServerResource.GRANT_TYPE,OAuthServerResource.GrantType.password.name());
  form.add(OAuthServerResource.CLIENT_ID,params.getClientId());
  form.add(OAuthServerResource.CLIENT_SECRET,params.getClientSecret());
  form.add(OAuthServerResource.USERNAME,username);
  form.add(OAuthServerResource.PASSWORD,password);
  ClientResource tokenResource=new CookieCopyClientResource(params.getBaseRef() + params.getAccessTokenPath());
  tokenResource.setNext(c);
  Context.getCurrentLogger().info("Sending PasswordFlow form : " + form.getQueryString());
  Representation body=null;
  try {
    body=tokenResource.post(form.getWebRepresentation());
    if (tokenResource.getStatus().isSuccess()) {
      result=OAuthUtils.handleSuccessResponse(body);
    }
  }
  finally {
    if (body != null)     body.release();
    tokenResource.release();
  }
  return result;
}
