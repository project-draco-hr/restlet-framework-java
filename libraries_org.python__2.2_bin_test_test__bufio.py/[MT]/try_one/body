def try_one(s):
    f = open(TESTFN, 'wb')
    f.write(s)
    f.write('\n')
    f.write(s)
    f.close()
    f = open(TESTFN, 'rb')
    line = f.readline()
    if (line != (s + '\n')):
        raise TestFailed(('Expected %r got %r' % ((s + '\n'), line)))
    line = f.readline()
    if (line != s):
        raise TestFailed(('Expected %r got %r' % (s, line)))
    line = f.readline()
    if line:
        raise TestFailed(('Expected EOF but got %r' % line))
    f.close()
