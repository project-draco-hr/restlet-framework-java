{
  try {
    if (response.getRequest().getMethod().equals(Method.HEAD)) {
      addEntityHeaders(response);
      response.setEntity(null);
    }
 else     if (response.getStatus().equals(Status.SUCCESS_NO_CONTENT)) {
      getLogger().fine("Responses with a 204 (No content) status generally don't have an entity. Only adding entity headers.");
      addEntityHeaders(response);
      response.setEntity(null);
    }
 else     if (response.getStatus().equals(Status.SUCCESS_RESET_CONTENT)) {
      getLogger().warning("Responses with a 205 (Reset content) status can't have an entity. Ignoring the entity");
      response.setEntity(null);
    }
 else     if (response.getStatus().equals(Status.SUCCESS_PARTIAL_CONTENT)) {
      getLogger().warning("Responses with a 206 (Partial content) status aren't supported yet. Ignoring the entity");
      response.setEntity(null);
    }
 else     if (response.getStatus().equals(Status.REDIRECTION_NOT_MODIFIED)) {
      getLogger().warning("Responses with a 304 (Not modified) status can't have an entity. Ignoring the entity");
      response.setEntity(null);
    }
 else     if (response.getStatus().isInformational()) {
      getLogger().warning("Responses with an informational (1xx) status can't have an entity. Ignoring the entity");
      response.setEntity(null);
    }
 else     if ((response.getEntity() != null) && !response.getEntity().isAvailable()) {
      getLogger().warning("A response with an unavailable entity was returned. Ignoring the entity");
      response.setEntity(null);
      addEntityHeaders(response);
    }
 else {
      addEntityHeaders(response);
    }
    addResponseHeaders(response);
    response.getHttpCall().sendResponse(response);
  }
 catch (  Exception e) {
    getLogger().log(Level.INFO,"Exception intercepted",e);
    response.getHttpCall().setStatusCode(Status.SERVER_ERROR_INTERNAL.getCode());
    response.getHttpCall().setReasonPhrase("An unexpected exception occured");
  }
}
