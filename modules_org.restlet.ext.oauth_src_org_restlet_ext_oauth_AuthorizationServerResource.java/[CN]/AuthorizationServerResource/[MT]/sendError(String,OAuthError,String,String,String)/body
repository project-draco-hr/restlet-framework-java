{
  Form params=getQuery();
  String redirUri=params.getFirstValue(REDIR_URI);
  if (redirUri == null || redirUri.length() == 0) {
    redirUri="https://127.0.0.1/cb";
  }
  Reference cb=new Reference(redirUri);
  cb.addQueryParameter("error",error.name());
  if (state != null && state.length() > 0) {
    cb.addQueryParameter("state",state);
  }
  if (description != null && description.length() > 0) {
    cb.addQueryParameter("error_description",description);
  }
  if (errorUri != null && errorUri.length() > 0) {
    cb.addQueryParameter("error_uri",errorUri);
  }
  redirectTemporary(cb.toString());
  if (sessionId != null && sessionId.length() > 0) {
    ConcurrentMap<String,Object> attribs=getContext().getAttributes();
    attribs.remove(sessionId);
  }
}
