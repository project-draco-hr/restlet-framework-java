def find_user_password(self, realm, authuri):
    domains = self.passwd.get(realm, {})
    for default_port in (True, False):
        reduced_authuri = self.reduce_uri(authuri, default_port)
        for (uris, authinfo) in domains.iteritems():
            for uri in uris:
                if self.is_suburi(uri, reduced_authuri):
                    return authinfo
    return (None, None)
