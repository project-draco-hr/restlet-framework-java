def retry_http_basic_auth(self, host, req, realm):
    (user, pw) = self.passwd.find_user_password(realm, host)
    if (pw is not None):
        raw = ('%s:%s' % (user, pw))
        auth = ('Basic %s' % base64.b64encode(raw).strip())
        if (req.headers.get(self.auth_header, None) == auth):
            return None
        req.add_header(self.auth_header, auth)
        return self.parent.open(req)
    else:
        return None
