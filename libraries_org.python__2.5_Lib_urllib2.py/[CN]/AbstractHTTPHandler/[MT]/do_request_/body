def do_request_(self, request):
    host = request.get_host()
    if (not host):
        raise URLError('no host given')
    if request.has_data():
        data = request.get_data()
        if (not request.has_header('Content-type')):
            request.add_unredirected_header('Content-type', 'application/x-www-form-urlencoded')
        if (not request.has_header('Content-length')):
            request.add_unredirected_header('Content-length', ('%d' % len(data)))
    (scheme, sel) = splittype(request.get_selector())
    (sel_host, sel_path) = splithost(sel)
    if (not request.has_header('Host')):
        request.add_unredirected_header('Host', (sel_host or host))
    for (name, value) in self.parent.addheaders:
        name = name.capitalize()
        if (not request.has_header(name)):
            request.add_unredirected_header(name, value)
    return request
