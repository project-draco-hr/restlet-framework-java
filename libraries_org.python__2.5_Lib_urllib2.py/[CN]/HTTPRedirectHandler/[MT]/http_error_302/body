def http_error_302(self, req, fp, code, msg, headers):
    if ('location' in headers):
        newurl = headers.getheaders('location')[0]
    elif ('uri' in headers):
        newurl = headers.getheaders('uri')[0]
    else:
        return
    newurl = urlparse.urljoin(req.get_full_url(), newurl)
    new = self.redirect_request(req, fp, code, msg, headers, newurl)
    if (new is None):
        return
    if hasattr(req, 'redirect_dict'):
        visited = new.redirect_dict = req.redirect_dict
        if ((visited.get(newurl, 0) >= self.max_repeats) or (len(visited) >= self.max_redirections)):
            raise HTTPError(req.get_full_url(), code, (self.inf_msg + msg), headers, fp)
    else:
        visited = new.redirect_dict = req.redirect_dict = {}
    visited[newurl] = (visited.get(newurl, 0) + 1)
    fp.read()
    fp.close()
    return self.parent.open(new)
