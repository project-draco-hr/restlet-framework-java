def escapestr(text, ampm):
    'Escape text to deal with possible locale values that have regex\n    syntax while allowing regex syntax used for the comparison.'
    new_text = re.escape(text)
    new_text = new_text.replace(re.escape(ampm), ampm)
    new_text = new_text.replace('\\%', '%')
    new_text = new_text.replace('\\:', ':')
    new_text = new_text.replace('\\?', '?')
    return new_text
