def _test():
    import sys
    args = sys.argv[1:]
    if (not args):
        for key in ('MAILDIR', 'MAIL', 'LOGNAME', 'USER'):
            if os.environ.has_key(key):
                mbox = os.environ[key]
                break
        else:
            print '$MAIL, $LOGNAME nor $USER set -- who are you?'
            return
    else:
        mbox = args[0]
    if (mbox[:1] == '+'):
        mbox = ((os.environ['HOME'] + '/Mail/') + mbox[1:])
    elif (not ('/' in mbox)):
        mbox = ('/usr/mail/' + mbox)
    if os.path.isdir(mbox):
        if os.path.isdir(os.path.join(mbox, 'cur')):
            mb = Maildir(mbox)
        else:
            mb = MHMailbox(mbox)
    else:
        fp = open(mbox, 'r')
        mb = PortableUnixMailbox(fp)
    msgs = []
    while 1:
        msg = mb.next()
        if (msg is None):
            break
        msgs.append(msg)
        if (len(args) <= 1):
            msg.fp = None
    if (len(args) > 1):
        num = int(args[1])
        print ('Message %d body:' % num)
        msg = msgs[(num - 1)]
        msg.rewindbody()
        sys.stdout.write(msg.fp.read())
    else:
        print 'Mailbox', mbox, 'has', len(msgs), 'messages:'
        for msg in msgs:
            f = (msg.getheader('from') or '')
            s = (msg.getheader('subject') or '')
            d = (msg.getheader('date') or '')
            print ('-%20.20s   %20.20s   %-30.30s' % (f, d[5:], s))
