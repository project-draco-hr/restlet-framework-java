{
  JSONObject body=new JSONObject();
  try {
    body.put(TOKEN_TYPE,TOKEN_TYPE_BEARER);
    body.put(ACCESS_TOKEN,token.getToken());
    long expiresIn=token.getExpirePeriod();
    if (expiresIn != Token.UNLIMITED) {
      body.put(EXPIRES_IN,expiresIn);
      body.put(REFRESH_TOKEN,token.getRefreshToken());
    }
    if (scopes != null && !scopes.isEmpty()) {
      body.put(SCOPE,scopes);
    }
  }
 catch (  JSONException e) {
    throw new ResourceException(Status.SERVER_ERROR_INTERNAL,"Failed to generate JSON",e);
  }
  return body;
}
