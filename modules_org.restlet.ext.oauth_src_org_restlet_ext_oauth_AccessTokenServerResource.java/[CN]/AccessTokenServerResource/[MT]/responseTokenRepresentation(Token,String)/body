{
  JSONObject response=new JSONObject();
  try {
    response.put(TOKEN_TYPE,TOKEN_TYPE_BEARER);
    response.put(ACCESS_TOKEN,token.getToken());
    long expiresIn=token.getExpirePeriod();
    if (expiresIn != Token.UNLIMITED) {
      response.put(EXPIRES_IN,expiresIn);
      response.put(REFRESH_TOKEN,token.getRefreshToken());
    }
    if (scopes != null && !scopes.isEmpty()) {
      response.put(SCOPE,scopes);
    }
  }
 catch (  JSONException e) {
    throw new ResourceException(Status.SERVER_ERROR_INTERNAL,"Failed to generate JSON",e);
  }
  addCacheDirective(getResponse(),CacheDirective.noStore());
  return new JsonRepresentation(response);
}
