def read(self, size=None):
    L = [self._buf]
    avail = len(self._buf)
    while ((size is None) or (avail < size)):
        s = self._read()
        if (s == ''):
            break
        L.append(s)
        avail += len(s)
    all = ''.join(L)
    if (size is None):
        self._buf = ''
        return all
    else:
        self._buf = all[size:]
        return all[:size]
