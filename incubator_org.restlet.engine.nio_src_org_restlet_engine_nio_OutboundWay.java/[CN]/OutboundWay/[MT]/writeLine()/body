{
  boolean result=true;
switch (getMessageState()) {
case START_LINE:
    writeStartLine();
  setMessageState(MessageState.HEADERS);
break;
case HEADERS:
if (getHeaders() == null) {
setHeaders(new Form());
setHeaderIndex(0);
addHeaders(getHeaders());
}
if (getHeaderIndex() < getHeaders().size()) {
Parameter header=getHeaders().get(getHeaderIndex());
getLineBuilder().append(header.getName());
getLineBuilder().append(": ");
getLineBuilder().append(header.getValue());
getLineBuilder().append('\r');
getLineBuilder().append('\n');
setHeaderIndex(getHeaderIndex() + 1);
}
 else {
getLineBuilder().append('\r');
getLineBuilder().append('\n');
setMessageState(MessageState.BODY);
}
break;
case BODY:
break;
}
return result;
}
