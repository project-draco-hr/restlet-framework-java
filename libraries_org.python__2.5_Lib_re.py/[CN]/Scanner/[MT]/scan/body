def scan(self, string):
    result = []
    append = result.append
    match = self.scanner.scanner(string).match
    i = 0
    while 1:
        m = match()
        if (not m):
            break
        j = m.end()
        if (i == j):
            break
        action = self.lexicon[(m.lastindex - 1)][1]
        if callable(action):
            self.match = m
            action = action(self, m.group())
        if (action is not None):
            append(action)
        i = j
    return (result, string[i:])
