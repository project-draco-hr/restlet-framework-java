{
  ScriptedResourceContainer container=new ScriptedResourceContainer(this,getVariants(),variant);
  Request request=getRequest();
  if (isSourceViewable() && TRUE.equals(request.getResourceRef().getQueryAsForm().getFirstValue(SOURCE))) {
    String name=ScriptUtils.getRelativePart(request,getDefaultName());
    try {
      return new StringRepresentation(getScriptSource().getScriptDescriptor(name).getText());
    }
 catch (    IOException e) {
      throw new ResourceException(Status.CLIENT_ERROR_NOT_FOUND,e);
    }
  }
 else {
    Object r=container.invoke(getRepresentEntryPointName());
    if (r == null) {
      return null;
    }
    if (r instanceof Representation) {
      return (Representation)r;
    }
 else {
      return new StringRepresentation(r.toString(),container.getMediaType(),container.getLanguage(),container.getCharacterSet());
    }
  }
}
