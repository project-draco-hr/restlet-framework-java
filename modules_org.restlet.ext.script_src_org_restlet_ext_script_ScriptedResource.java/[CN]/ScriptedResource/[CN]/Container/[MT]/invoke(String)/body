{
  String name=ScriptUtils.getRelativePart(this.resource.getRequest(),defaultName);
  try {
    ScriptSource.ScriptDescriptor<EmbeddedScript> scriptDescriptor=scriptSource.getScriptDescriptor(name);
    EmbeddedScript script=scriptDescriptor.getScript();
    if (script == null) {
      String text=scriptDescriptor.getText();
      script=new EmbeddedScript(text,scriptEngineManager,defaultEngineName,allowCompilation);
      scriptDescriptor.setScript(script);
      script.run(this.writer,this.errorWriter,this.scriptEngines,this.controller,false);
    }
    return script.invoke(command,this.controller);
  }
 catch (  FileNotFoundException x) {
    throw new ResourceException(Status.CLIENT_ERROR_NOT_FOUND,x);
  }
catch (  IOException x) {
    throw new ResourceException(x);
  }
catch (  ScriptException x) {
    throw new ResourceException(x);
  }
catch (  NoSuchMethodException x) {
    throw new ResourceException(x);
  }
}
