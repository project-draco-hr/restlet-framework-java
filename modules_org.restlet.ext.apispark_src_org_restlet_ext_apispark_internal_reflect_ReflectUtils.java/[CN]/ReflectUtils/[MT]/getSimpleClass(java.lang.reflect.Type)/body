{
  if (type instanceof Class<?>) {
    Class<?> c=(Class<?>)type;
    if (c.isArray()) {
      return c.getComponentType();
    }
 else {
      return c;
    }
  }
 else   if (type instanceof GenericArrayType) {
    GenericArrayType gat=(GenericArrayType)type;
    return getSimpleClass(gat.getGenericComponentType());
  }
 else   if (type instanceof ParameterizedType) {
    ParameterizedType t=(ParameterizedType)type;
    if (t.getActualTypeArguments().length == 1) {
      return getSimpleClass(t.getActualTypeArguments()[0]);
    }
 else {
      Logger.getLogger(ReflectUtils.class.getName()).warning("We don't support generic types with several arguments.");
    }
  }
  return type.getClass();
}
