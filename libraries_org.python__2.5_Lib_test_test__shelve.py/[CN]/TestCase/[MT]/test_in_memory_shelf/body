def test_in_memory_shelf(self):
    d1 = {}
    s = shelve.Shelf(d1, protocol=0)
    s['key1'] = (1, 2, 3, 4)
    self.assertEqual(s['key1'], (1, 2, 3, 4))
    s.close()
    d2 = {}
    s = shelve.Shelf(d2, protocol=1)
    s['key1'] = (1, 2, 3, 4)
    self.assertEqual(s['key1'], (1, 2, 3, 4))
    s.close()
    self.assertEqual(len(d1), 1)
    self.assertNotEqual(d1, d2)
