{
  TemplateRoute templateRoute=(TemplateRoute)router.getNext(request,response);
  if (templateRoute == null) {
    response.setStatus(Status.CLIENT_ERROR_NOT_FOUND);
    return STOP;
  }
  RestletOperationAuthorization restletOperationAuthorization=(RestletOperationAuthorization)templateRoute.getNext();
  List<Role> userRoles=request.getClientInfo().getRoles();
  boolean authorized=false;
  List<String> groupsAllowed=restletOperationAuthorization.getOperationAuthorization().getGroupsAllowed();
  for (  String groupAllowed : groupsAllowed) {
    if (hasRole(userRoles,groupAllowed)) {
      authorized=true;
      break;
    }
  }
  if (authorized) {
    return CONTINUE;
  }
 else {
    response.setStatus(Status.CLIENT_ERROR_FORBIDDEN);
    return STOP;
  }
}
