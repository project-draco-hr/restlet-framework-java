import unittest, StringIO, robotparser
from test import test_support
tests = unittest.TestSuite()
doc = '\nUser-agent: *\nDisallow: /cyberworld/map/ # This is an infinite virtual URL space\nDisallow: /tmp/ # these will soon disappear\nDisallow: /foo.html\n'
good = ['/', '/test.html']
bad = ['/cyberworld/map/index.html', '/tmp/xxx', '/foo.html']
RobotTest(1, doc, good, bad)
doc = '\n# robots.txt for http://www.example.com/\n\nUser-agent: *\nDisallow: /cyberworld/map/ # This is an infinite virtual URL space\n\n# Cybermapper knows where to go.\nUser-agent: cybermapper\nDisallow:\n\n'
good = ['/', '/test.html', ('cybermapper', '/cyberworld/map/index.html')]
bad = ['/cyberworld/map/index.html']
RobotTest(2, doc, good, bad)
doc = '\n# go away\nUser-agent: *\nDisallow: /\n'
good = []
bad = ['/cyberworld/map/index.html', '/', '/tmp/']
RobotTest(3, doc, good, bad)
doc = '\nUser-agent: figtree\nDisallow: /tmp\nDisallow: /a%3cd.html\nDisallow: /a%2fb.html\nDisallow: /%7ejoe/index.html\n'
good = []
bad = ['/tmp', '/tmp.html', '/tmp/a.html', '/a%3cd.html', '/a%3Cd.html', '/a%2fb.html', '/~joe/index.html']
RobotTest(4, doc, good, bad, 'figtree')
RobotTest(5, doc, good, bad, 'FigTree Robot libwww-perl/5.04')
doc = '\nUser-agent: *\nDisallow: /tmp/\nDisallow: /a%3Cd.html\nDisallow: /a/b.html\nDisallow: /%7ejoe/index.html\n'
good = ['/tmp']
bad = ['/tmp/', '/tmp/a.html', '/a%3cd.html', '/a%3Cd.html', '/a/b.html', '/%7Ejoe/index.html']
RobotTest(6, doc, good, bad)
doc = '\nUser-Agent: *\nDisallow: /.\n'
good = ['/foo.html']
bad = []
RobotTest(7, doc, good, bad)
if (__name__ == '__main__'):
    test_support.Verbose = 1
    test_support.run_suite(tests)
