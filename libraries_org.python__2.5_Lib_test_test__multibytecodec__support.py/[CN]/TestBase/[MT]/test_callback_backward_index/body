def test_callback_backward_index(self):

    def myreplace(exc):
        if (myreplace.limit > 0):
            myreplace.limit -= 1
            return (u'REPLACED', 0)
        else:
            return (u'TERMINAL', exc.end)
    myreplace.limit = 3
    codecs.register_error('test.cjktest', myreplace)
    self.assertEqual(self.encode(((u'abcd' + self.unmappedunicode) + u'efgh'), 'test.cjktest'), ('abcdREPLACEDabcdREPLACEDabcdREPLACEDabcdTERMINALefgh', 9))
