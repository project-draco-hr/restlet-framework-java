def __init__(self, filename=None, mode=None, compresslevel=9, fileobj=None):
    if (mode and ('b' not in mode)):
        mode += 'b'
    if (fileobj is None):
        fileobj = self.myfileobj = __builtin__.open(filename, (mode or 'rb'))
    if (filename is None):
        if hasattr(fileobj, 'name'):
            filename = fileobj.name
        else:
            filename = ''
    if (mode is None):
        if hasattr(fileobj, 'mode'):
            mode = fileobj.mode
        else:
            mode = 'rb'
    if (mode[0:1] == 'r'):
        self.mode = READ
        self._new_member = 1
        self.extrabuf = ''
        self.extrasize = 0
        self.filename = filename
    elif ((mode[0:1] == 'w') or (mode[0:1] == 'a')):
        self.mode = WRITE
        self._init_write(filename)
        self.compress = zlib.compressobj(compresslevel, zlib.DEFLATED, (- zlib.MAX_WBITS), zlib.DEF_MEM_LEVEL, 0)
    else:
        raise ValueError, (('Mode ' + mode) + ' not supported')
    self.fileobj = fileobj
    self.offset = 0
    if (self.mode == WRITE):
        self._write_gzip_header()
