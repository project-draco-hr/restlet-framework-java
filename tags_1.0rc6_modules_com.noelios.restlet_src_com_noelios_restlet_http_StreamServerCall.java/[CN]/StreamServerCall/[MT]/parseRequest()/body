{
  StringBuilder sb=new StringBuilder();
  int next=getRequestStream().read();
  while ((next != -1) && !HttpUtils.isSpace(next)) {
    sb.append((char)next);
    next=getRequestStream().read();
  }
  if (next == -1) {
    throw new IOException("Unable to parse the request method. End of stream reached too early.");
  }
 else {
    setMethod(sb.toString());
    sb.delete(0,sb.length());
    next=getRequestStream().read();
    while ((next != -1) && !HttpUtils.isSpace(next)) {
      sb.append((char)next);
      next=getRequestStream().read();
    }
    if (next == -1) {
      throw new IOException("Unable to parse the request URI. End of stream reached too early.");
    }
 else {
      setRequestUri(sb.toString());
      sb.delete(0,sb.length());
      next=getRequestStream().read();
      while ((next != -1) && !HttpUtils.isCarriageReturn(next)) {
        sb.append((char)next);
        next=getRequestStream().read();
      }
      if (next == -1) {
        throw new IOException("Unable to parse the HTTP version. End of stream reached too early.");
      }
 else {
        next=getRequestStream().read();
        if (HttpUtils.isLineFeed(next)) {
          setVersion(sb.toString());
          sb.delete(0,sb.length());
          Parameter header=HttpUtils.readHeader(getRequestStream(),sb);
          while (header != null) {
            getRequestHeaders().add(header);
            header=HttpUtils.readHeader(getRequestStream(),sb);
          }
        }
 else {
          throw new IOException("Unable to parse the HTTP version. The carriage return must be followed by a line feed.");
        }
      }
    }
  }
}
