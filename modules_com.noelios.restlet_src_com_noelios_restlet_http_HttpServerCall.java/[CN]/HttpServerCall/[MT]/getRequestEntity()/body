{
  Representation result=null;
  InputStream requestStream=getRequestStream();
  ReadableByteChannel requestChannel=getRequestChannel();
  if (((requestStream != null) || (requestChannel != null))) {
    List<Encoding> contentEncodings=new ArrayList<Encoding>();
    List<Language> contentLanguages=new ArrayList<Language>();
    MediaType contentMediaType=null;
    CharacterSet contentCharacterSet=null;
    long contentLength=-1L;
    for (    Parameter header : getRequestHeaders()) {
      if (header.getName().equalsIgnoreCase(HttpConstants.HEADER_CONTENT_ENCODING)) {
        HeaderReader hr=new HeaderReader(header.getValue());
        String value=hr.readValue();
        while (value != null) {
          Encoding encoding=Encoding.valueOf(value);
          if (!encoding.equals(Encoding.IDENTITY)) {
            contentEncodings.add(encoding);
          }
          value=hr.readValue();
        }
      }
 else       if (header.getName().equalsIgnoreCase(HttpConstants.HEADER_CONTENT_LANGUAGE)) {
        HeaderReader hr=new HeaderReader(header.getValue());
        String value=hr.readValue();
        while (value != null) {
          contentLanguages.add(Language.valueOf(value));
          value=hr.readValue();
        }
      }
 else       if (header.getName().equalsIgnoreCase(HttpConstants.HEADER_CONTENT_TYPE)) {
        ContentType contentType=new ContentType(header.getValue());
        if (contentType != null) {
          contentMediaType=contentType.getMediaType();
          contentCharacterSet=contentType.getCharacterSet();
        }
        contentMediaType=MediaType.valueOf(header.getValue());
      }
 else       if (header.getName().equalsIgnoreCase(HttpConstants.HEADER_CONTENT_LENGTH)) {
        contentLength=Long.parseLong(header.getValue());
      }
    }
    if (requestStream != null) {
      result=new InputRepresentation(requestStream,contentMediaType,contentLength);
    }
 else     if (requestChannel != null) {
      result=new ReadableRepresentation(requestChannel,contentMediaType,contentLength);
    }
    if (result != null) {
      for (      Encoding encoding : contentEncodings) {
        if (!encoding.equals(Encoding.IDENTITY)) {
          result.getEncodings().add(encoding);
        }
      }
      if (!contentLanguages.isEmpty()) {
        result.getLanguages().addAll(contentLanguages);
      }
      result.setCharacterSet(contentCharacterSet);
    }
  }
  return result;
}
