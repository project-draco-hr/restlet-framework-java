def add_header(self, _name, _value, **_params):
    'Extended header setting.\n\n        name is the header field to add.  keyword arguments can be used to set\n        additional parameters for the header field, with underscores converted\n        to dashes.  Normally the parameter will be added as key="value" unless\n        value is None, in which case only the key will be added.\n\n        Example:\n\n        msg.add_header(\'content-disposition\', \'attachment\', filename=\'bud.gif\')\n        '
    parts = []
    for (k, v) in _params.items():
        if (v is None):
            parts.append(k.replace('_', '-'))
        else:
            parts.append(_formatparam(k.replace('_', '-'), v))
    if (_value is not None):
        parts.insert(0, _value)
    self._headers.append((_name, SEMISPACE.join(parts)))
