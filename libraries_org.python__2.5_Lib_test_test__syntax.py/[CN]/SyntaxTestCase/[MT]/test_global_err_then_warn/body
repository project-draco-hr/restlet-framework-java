def test_global_err_then_warn(self):
    source = re.sub('(?m)^ *:', '', '            :def error(a):\n            :    global a  # SyntaxError\n            :def warning():\n            :    b = 1\n            :    global b  # SyntaxWarning\n            :')
    warnings.filterwarnings(action='ignore', category=SyntaxWarning)
    self._check_error(source, 'global')
    warnings.filters.pop(0)
