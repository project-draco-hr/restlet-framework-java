def needsquoting(c, quotetabs, header):
    "Decide whether a particular character needs to be quoted.\n\n    The 'quotetabs' flag indicates whether embedded tabs and spaces should be\n    quoted.  Note that line-ending tabs and spaces are always encoded, as per\n    RFC 1521.\n    "
    if (c in ' \t'):
        return quotetabs
    if (c == '_'):
        return header
    return ((c == ESCAPE) or (not (' ' <= c <= '~')))
