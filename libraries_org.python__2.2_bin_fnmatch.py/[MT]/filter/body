def filter(names, pat):
    'Return the subset of the list NAMES that match PAT'
    import os, posixpath
    result = []
    pat = os.path.normcase(pat)
    if (not _cache.has_key(pat)):
        res = translate(pat)
        _cache[pat] = re.compile(res)
    match = _cache[pat].match
    if (os.path is posixpath):
        for name in names:
            if match(name):
                result.append(name)
    else:
        for name in names:
            if match(os.path.normcase(name)):
                result.append(name)
    return result
