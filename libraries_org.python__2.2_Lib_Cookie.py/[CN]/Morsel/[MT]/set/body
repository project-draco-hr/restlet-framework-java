def set(self, key, val, coded_val, LegalChars=_LegalChars, idmap=string._idmap, translate=string.translate):
    if (string.lower(key) in self._reserved_keys):
        raise CookieError(('Attempt to set a reserved key: %s' % key))
    if ('' != translate(key, idmap, LegalChars)):
        raise CookieError(('Illegal key value: %s' % key))
    self.key = key
    self.value = val
    self.coded_value = coded_val
