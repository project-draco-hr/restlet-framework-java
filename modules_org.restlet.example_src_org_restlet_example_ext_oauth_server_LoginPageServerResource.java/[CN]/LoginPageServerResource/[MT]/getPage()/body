{
  getLogger().info("Get Login");
  String userId=getQueryValue("user_id");
  HashMap<String,Object> data=new HashMap<String,Object>();
  if (userId != null && !userId.isEmpty()) {
    String password=getQueryValue("password");
    getLogger().info("User=" + userId + ", Pass="+ password);
    DBCollection users=OAuth2Sample.getDefaultDB().getCollection("users");
    DBObject user=users.findOne(new BasicDBObject("_id",userId).append("password",password));
    if (user != null) {
      getLogger().info("Session: " + getAuthSession().getClient().getClientId());
      getAuthSession().setScopeOwner(userId);
      String uri=getQueryValue("continue");
      getLogger().info("URI: " + uri);
      redirectTemporary(uri);
      return new EmptyRepresentation();
    }
 else {
      data.put("error","Authentication failed.");
      data.put("error_description","ID or Password is invalid.");
    }
  }
  String continueURI=getQueryValue("continue");
  TemplateRepresentation response=getLoginPage("login.html");
  data.put("continue",continueURI);
  response.setDataModel(data);
  return response;
}
