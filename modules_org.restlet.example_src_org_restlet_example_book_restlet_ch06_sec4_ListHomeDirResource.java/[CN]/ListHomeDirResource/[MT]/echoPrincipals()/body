{
  Subject subject=new Subject();
  subject.getPrincipals().add(getRequest().getClientInfo().getUser());
  for (  Role role : getRequest().getClientInfo().getRoles()) {
    subject.getPrincipals().add(role);
  }
  for (  Principal principal : getRequest().getClientInfo().getPrincipals()) {
    subject.getPrincipals().add(principal);
  }
  PrivilegedAction<StringBuilder> action=new PrivilegedAction<StringBuilder>(){
    public StringBuilder run(){
      File dir=new File(System.getProperty("user.home"));
      String[] filenames=dir.list(new FilenameFilter(){
        public boolean accept(        File dir,        String name){
          return !name.startsWith(".");
        }
      }
);
      StringBuilder sb=new StringBuilder("Files in the home directory: \n\n");
      for (      String filename : filenames) {
        sb.append(filename);
        sb.append("\n");
      }
      return sb;
    }
  }
;
  StringBuilder sb=null;
  Subject.doAsPrivileged(subject,action,null);
  Representation rep=new StringRepresentation(sb,MediaType.TEXT_PLAIN,Language.ALL,CharacterSet.UTF_8);
  return rep;
}
