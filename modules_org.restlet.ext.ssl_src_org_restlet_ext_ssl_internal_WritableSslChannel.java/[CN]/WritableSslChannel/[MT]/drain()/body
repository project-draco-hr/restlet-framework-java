{
  int result=0;
  if (getPacketBuffer().isDraining()) {
    if (getWrappedChannel().isOpen()) {
      result=getPacketBuffer().drain(getWrappedChannel());
      if (getConnection().getLogger().isLoggable(Level.FINE)) {
        getConnection().getLogger().log(Level.FINE,"Packet bytes written: " + result);
      }
      if (!getPacketBuffer().hasRemaining()) {
        getPacketBuffer().clear();
      }
    }
  }
  return result;
}
