{
  JSONObject request=new JSONObject();
  Reference uri=req.getOriginalRef();
  request.put("access_token",accessToken);
  List<Role> roles=this.getAuthorizedRoles();
  if (roles != null && roles.size() > 0) {
    JSONArray jArray=new JSONArray();
    for (    Role r : roles)     jArray.put(OAuthUtils.roleToScope(r));
    request.put("scope",jArray);
    getLogger().info("Found scopes: " + jArray.toString());
  }
  String owner=(String)req.getAttributes().get("oauth-user");
  if (owner != null && owner.length() > 0) {
    getLogger().info("Found Owner:" + owner);
    request.put("owner",owner);
  }
  request.put("uri",uri.getHierarchicalPart());
  return request;
}
