{
  SecurityData security=call.getSecurity();
  ChallengeResponse resp=security.getChallengeResponse();
  if (this.scheme.equals(ChallengeSchemes.HTTP_BASIC)) {
    if (resp == null) {
      logger.log(Level.INFO,"Authentication failed: no challenge response provided.");
    }
 else     if (resp.getScheme().equals(ChallengeSchemes.HTTP_BASIC)) {
      try {
        String credentials=new String(Base64.decode(resp.getCredentials()),"US-ASCII");
        int separator=credentials.indexOf(':');
        if (separator == -1) {
          logger.warning("Invalid credentials given by client with IP: " + call.getClientAddress());
        }
 else {
          security.setLogin(credentials.substring(0,separator));
          security.setPassword(credentials.substring(separator + 1));
          logger.info("Basic HTTP authentication succeeded: login=" + security.getLogin() + ", password="+ security.getPassword()+ ".");
        }
      }
 catch (      UnsupportedEncodingException e) {
        logger.log(Level.WARNING,"Unsupported encoding error",e);
      }
    }
 else {
      logger.log(Level.WARNING,"Authentication failed: invalid authentication mechanism used: " + resp.getScheme().getName() + " instead of :"+ this.scheme.getName()+ ".");
    }
  }
 else {
    logger.log(Level.WARNING,"Authentication failed: unsupported scheme used: " + this.scheme.getName() + ". Please override the authenticate method.");
  }
}
