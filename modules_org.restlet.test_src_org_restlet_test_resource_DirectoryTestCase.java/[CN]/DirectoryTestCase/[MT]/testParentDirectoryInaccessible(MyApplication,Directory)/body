{
  this.testDir=new File(System.getProperty("java.io.tmpdir"),"DirectoryTestCase/tests7" + new Date().getTime());
  this.testDir.mkdirs();
  File childDir=new File(testDir,"child dir");
  childDir.mkdir();
  application.setTestDirectory(childDir);
  final File testFile=new File(childDir,"file.txt");
  assertTrue(testFile.createNewFile());
  final File privateFile=new File(testDir,"private.txt");
  assertTrue(privateFile.createNewFile());
  directory.setDeeplyAccessible(true);
  directory.setListingAllowed(true);
  Response response;
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("file.txt"),Method.GET,null,"root file access");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("%2e%2e/child%20dir/file.txt"),Method.GET,null,"root file access");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("%2e%2e%2fchild%20dir/file.txt"),Method.GET,null,"root file access");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("../child%20dir/file.txt"),Method.GET,null,"root file access");
  assertEquals(Status.SUCCESS_NO_CONTENT,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat(".."),Method.GET,null,"parent access 1");
  assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("../"),Method.GET,null,"deep access 1");
  assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("../private.txt"),Method.GET,null,"deep access 1");
  assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("%2e%2e"),Method.GET,null,"deep access 1");
  assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("%2e%2e/"),Method.GET,null,"deep access 1");
  assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("%2e%2e%2f"),Method.GET,null,"deep access 1");
  assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("%2e%2e/private.txt"),Method.GET,null,"deep access 1");
  assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
  response=handle(application,this.webSiteURL,this.webSiteURL.concat("%2e%2e%2fprivate.txt"),Method.GET,null,"deep access 1");
  assertEquals(Status.CLIENT_ERROR_FORBIDDEN,response.getStatus());
}
