{
  if (representation != null) {
    String[] tokens=entryName.split("\\.");
    Metadata current;
    for (int j=1; j < tokens.length; j++) {
      current=metadataService.getMetadata(tokens[j]);
      if (current != null) {
        if (current instanceof MediaType)         representation.setMediaType((MediaType)current);
        if (current instanceof CharacterSet)         representation.setCharacterSet((CharacterSet)current);
        if (current instanceof Encoding)         representation.setEncoding((Encoding)current);
        if (current instanceof Language)         representation.setLanguage((Language)current);
      }
      int dashIndex=tokens[j].indexOf('-');
      if (dashIndex != -1) {
        String primaryPart=tokens[j].substring(0,dashIndex);
        current=metadataService.getMetadata(primaryPart);
        if (current instanceof Language)         representation.setLanguage((Language)current);
      }
    }
    if (representation.getMediaType() != null && representation.getMediaType().getMainType().equals("text")) {
      if (representation.getLanguage() == null) {
        representation.setLanguage(metadataService.getDefaultLanguage());
      }
    }
  }
}
