def test_renamed_bytecode(self):
    source = safe_mktemp(dir=self.dir, suffix='.py')
    fp = open(source, 'w')
    fp.write("test = 'imported'")
    fp.close()
    module = os.path.basename(source)[:(-3)]
    compiled = (module + COMPILED_SUFFIX)
    module_obj = __import__(module)
    self.assertEquals(module_obj.test, 'imported')
    self.assert_(os.path.exists(compiled))
    compiled_moved = safe_mktemp(dir=self.dir, suffix=COMPILED_SUFFIX)
    os.rename(compiled, compiled_moved)
    moved_module = os.path.basename(compiled_moved)[:(- len(COMPILED_SUFFIX))]
    module_obj = __import__(moved_module)
    self.assertEquals(module_obj.__file__, os.path.basename(compiled_moved))
    self.assertEquals(module_obj.test, 'imported')
