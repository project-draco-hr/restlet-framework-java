def find_module_in_dir(self, name, dir, allow_packages=1):
    if (dir is None):
        return self.find_builtin_module(name)
    if allow_packages:
        fullname = self.hooks.path_join(dir, name)
        if self.hooks.path_isdir(fullname):
            stuff = self.find_module_in_dir('__init__', fullname, 0)
            if stuff:
                file = stuff[0]
                if file:
                    file.close()
                return (None, fullname, ('', '', PKG_DIRECTORY))
    for info in self.hooks.get_suffixes():
        (suff, mode, type) = info
        fullname = self.hooks.path_join(dir, (name + suff))
        try:
            fp = self.hooks.openfile(fullname, mode)
            return (fp, fullname, info)
        except self.hooks.openfile_error:
            pass
    return None
