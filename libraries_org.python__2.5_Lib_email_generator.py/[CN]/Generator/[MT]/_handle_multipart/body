def _handle_multipart(self, msg):
    msgtexts = []
    subparts = msg.get_payload()
    if (subparts is None):
        subparts = []
    elif isinstance(subparts, basestring):
        self._fp.write(subparts)
        return
    elif (not isinstance(subparts, list)):
        subparts = [subparts]
    for part in subparts:
        s = StringIO()
        g = self.clone(s)
        g.flatten(part, unixfrom=False)
        msgtexts.append(s.getvalue())
    alltext = NL.join(msgtexts)
    boundary = msg.get_boundary(failobj=_make_boundary(alltext))
    if (msg.get_boundary() != boundary):
        msg.set_boundary(boundary)
    if (msg.preamble is not None):
        print  >> self._fp, msg.preamble
    print  >> self._fp, ('--' + boundary)
    if msgtexts:
        self._fp.write(msgtexts.pop(0))
    for body_part in msgtexts:
        print  >> self._fp, ('\n--' + boundary)
        self._fp.write(body_part)
    self._fp.write((('\n--' + boundary) + '--'))
    if (msg.epilogue is not None):
        print  >> self._fp
        self._fp.write(msg.epilogue)
