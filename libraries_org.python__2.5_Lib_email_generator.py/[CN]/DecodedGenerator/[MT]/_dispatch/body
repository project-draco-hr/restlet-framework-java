def _dispatch(self, msg):
    for part in msg.walk():
        maintype = part.get_content_maintype()
        if (maintype == 'text'):
            print  >> self, part.get_payload(decode=True)
        elif (maintype == 'multipart'):
            pass
        else:
            print  >> self, (self._fmt % {'type': part.get_content_type(), 'maintype': part.get_content_maintype(), 'subtype': part.get_content_subtype(), 'filename': part.get_filename('[no filename]'), 'description': part.get('Content-Description', '[no description]'), 'encoding': part.get('Content-Transfer-Encoding', '[no encoding]'), })
