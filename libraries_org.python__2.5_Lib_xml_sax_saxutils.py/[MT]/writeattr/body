def writeattr(stream, text):
    countdouble = text.count('"')
    if countdouble:
        countsingle = text.count("'")
        if (countdouble <= countsingle):
            entities = {'"': '&quot;', }
            quote = '"'
        else:
            entities = {"'": '&apos;', }
            quote = "'"
    else:
        entities = {}
        quote = '"'
    stream.write(quote)
    writetext(stream, text, entities)
    stream.write(quote)
