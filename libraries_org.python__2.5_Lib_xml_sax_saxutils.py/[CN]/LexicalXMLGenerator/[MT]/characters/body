def characters(self, content):
    if self._in_cdata:
        self._out.write(content.replace(']]>', ']]>]]&gt;<![CDATA['))
    else:
        self._out.write(escape(content))
