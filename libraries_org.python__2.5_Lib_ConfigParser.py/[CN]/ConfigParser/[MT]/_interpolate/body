def _interpolate(self, section, option, rawval, vars):
    value = rawval
    depth = MAX_INTERPOLATION_DEPTH
    while depth:
        depth -= 1
        if ('%(' in value):
            value = self._KEYCRE.sub(self._interpolation_replace, value)
            try:
                value = (value % vars)
            except KeyError as e:
                raise InterpolationMissingOptionError(option, section, rawval, e[0])
        else:
            break
    if ('%(' in value):
        raise InterpolationDepthError(option, section, rawval)
    return value
