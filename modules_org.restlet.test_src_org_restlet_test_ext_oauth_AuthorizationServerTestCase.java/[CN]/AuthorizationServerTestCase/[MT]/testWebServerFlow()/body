{
  assertNull(client.getToken());
  ClientResource cr=new ClientResource(prot + "://localhost:" + serverPort+ "/client/webclient");
  ChallengeResponse chresp=new ChallengeResponse(ChallengeScheme.HTTP_BASIC,"bob","alice");
  cr.setChallengeResponse(chresp);
  Representation r=cr.get();
  String text=r.getText();
  assertTrue(text.startsWith("TestSuccessful"));
  assertEquals("Response content type test",r.getMediaType(),MediaType.TEXT_HTML);
  assertNotNull(client.getToken());
  cr.release();
  Reference ref=new Reference(prot + "://localhost:" + serverPort+ "/server/protected");
  cr=new ClientResource(ref);
  ChallengeResponse challengeResponse=new ChallengeResponse(ChallengeScheme.HTTP_OAUTH);
  challengeResponse.setRawValue(client.getToken());
  cr.setChallengeResponse(challengeResponse);
  r=cr.get();
  assertNotNull(r);
  text=r.getText();
  assertTrue(text.startsWith("TestSuccessful"));
  assertEquals("Response content type test",r.getMediaType(),MediaType.TEXT_HTML);
  cr.release();
  ref=new Reference(prot + "://localhost:" + serverPort+ "/server/protected");
  cr=new ClientResource(ref);
  OAuthForm form=new OAuthForm(client.getToken());
  form.add("foo","bar");
  r=cr.post(form.getWebRepresentation());
  assertNotNull(r);
  text=r.getText();
  assertEquals("Response text test",text,"Dummy");
  assertEquals("Response content type test",r.getMediaType(),MediaType.TEXT_PLAIN);
  cr.release();
  ref=new Reference(prot + "://localhost:" + serverPort+ "/server/protected");
  ref.addQueryParameter("oauth_token",client.getToken());
  cr=new ClientResource(ref);
  r=cr.get();
  assertNotNull(r);
  text=r.getText();
  assertTrue(text.startsWith("TestSuccessful"));
  assertEquals("Response content type test",r.getMediaType(),MediaType.TEXT_HTML);
  cr.release();
}
