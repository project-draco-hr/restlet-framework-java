{
  OAuthUser user=Flow.PASSWORD.execute(client.getOauthParameters(),null,null,OAuthTestApplication.TEST_USER,OAuthTestApplication.TEST_PASS,null,this.reqClient);
  assertNotNull(user);
  Reference ref=new Reference(getProt() + "://localhost:" + serverPort+ "/server/protected");
  ref.addQueryParameter("oauth_token",user.getAccessToken());
  ClientResource cr=new ClientResource(ref);
  cr.setNext(this.reqClient);
  Representation r=cr.get();
  assertNotNull(r);
  String text=r.getText();
  assertTrue(text.startsWith("TestSuccessful"));
  assertEquals("Response content type test",r.getMediaType(),MediaType.TEXT_HTML);
  cr.release();
  try {
    user=Flow.PASSWORD.execute(client.getOauthParameters(),null,null,"somewrong",OAuthTestApplication.TEST_PASS,null,this.reqClient);
  }
 catch (  ResourceException re) {
    assertEquals(Status.CLIENT_ERROR_BAD_REQUEST,re.getStatus());
  }
  try {
    user=Flow.PASSWORD.execute(client.getOauthParameters(),null,null,OAuthTestApplication.TEST_USER,"somewrong",null,this.reqClient);
  }
 catch (  ResourceException re) {
    assertEquals(Status.CLIENT_ERROR_FORBIDDEN,re.getStatus());
  }
}
