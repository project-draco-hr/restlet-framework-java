def main():
    if (not sys.argv[1:]):
        print 'usage: pdb.py scriptfile [arg] ...'
        sys.exit(2)
    mainpyfile = sys.argv[1]
    if (not os.path.exists(mainpyfile)):
        print 'Error:', mainpyfile, 'does not exist'
        sys.exit(1)
    del sys.argv[0]
    sys.path[0] = os.path.dirname(mainpyfile)
    pdb = Pdb()
    while 1:
        try:
            pdb._runscript(mainpyfile)
            if pdb._user_requested_quit:
                break
            print 'The program finished and will be restarted'
        except SystemExit:
            print 'The program exited via sys.exit(). Exit status: ',
            print sys.exc_info()[1]
        except:
            traceback.print_exc()
            print 'Uncaught exception. Entering post mortem debugging'
            print "Running 'cont' or 'step' will restart the program"
            t = sys.exc_info()[2]
            while (t.tb_next is not None):
                t = t.tb_next
            pdb.interaction(t.tb_frame, t)
            print (('Post mortem debugger finished. The ' + mainpyfile) + ' will be restarted')
