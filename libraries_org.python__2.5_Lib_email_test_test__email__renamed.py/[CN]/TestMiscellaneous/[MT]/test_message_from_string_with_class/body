def test_message_from_string_with_class(self):
    unless = self.failUnless
    fp = openfile('msg_01.txt')
    try:
        text = fp.read()
    finally:
        fp.close()


    class MyMessage(Message):
        pass
    msg = email.message_from_string(text, MyMessage)
    unless(isinstance(msg, MyMessage))
    fp = openfile('msg_02.txt')
    try:
        text = fp.read()
    finally:
        fp.close()
    msg = email.message_from_string(text, MyMessage)
    for subpart in msg.walk():
        unless(isinstance(subpart, MyMessage))
