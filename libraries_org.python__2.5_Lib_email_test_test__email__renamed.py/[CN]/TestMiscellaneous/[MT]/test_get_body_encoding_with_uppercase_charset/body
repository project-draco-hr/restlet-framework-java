def test_get_body_encoding_with_uppercase_charset(self):
    eq = self.assertEqual
    msg = Message()
    msg['Content-Type'] = 'text/plain; charset=UTF-8'
    eq(msg['content-type'], 'text/plain; charset=UTF-8')
    charsets = msg.get_charsets()
    eq(len(charsets), 1)
    eq(charsets[0], 'utf-8')
    charset = Charset(charsets[0])
    eq(charset.get_body_encoding(), 'base64')
    msg.set_payload('hello world', charset=charset)
    eq(msg.get_payload(), 'aGVsbG8gd29ybGQ=\n')
    eq(msg.get_payload(decode=True), 'hello world')
    eq(msg['content-transfer-encoding'], 'base64')
    msg = Message()
    msg['Content-Type'] = 'text/plain; charset="US-ASCII"'
    charsets = msg.get_charsets()
    eq(len(charsets), 1)
    eq(charsets[0], 'us-ascii')
    charset = Charset(charsets[0])
    eq(charset.get_body_encoding(), encoders.encode_7or8bit)
    msg.set_payload('hello world', charset=charset)
    eq(msg.get_payload(), 'hello world')
    eq(msg['content-transfer-encoding'], '7bit')
