def test_multipart_digest_with_extra_mime_headers(self):
    eq = self.assertEqual
    neq = self.ndiffAssertEqual
    fp = openfile('msg_28.txt')
    try:
        msg = email.message_from_file(fp)
    finally:
        fp.close()
    eq(msg.is_multipart(), 1)
    eq(len(msg.get_payload()), 2)
    part1 = msg.get_payload(0)
    eq(part1.get_content_type(), 'message/rfc822')
    eq(part1.is_multipart(), 1)
    eq(len(part1.get_payload()), 1)
    part1a = part1.get_payload(0)
    eq(part1a.is_multipart(), 0)
    eq(part1a.get_content_type(), 'text/plain')
    neq(part1a.get_payload(), 'message 1\n')
    part2 = msg.get_payload(1)
    eq(part2.get_content_type(), 'message/rfc822')
    eq(part2.is_multipart(), 1)
    eq(len(part2.get_payload()), 1)
    part2a = part2.get_payload(0)
    eq(part2a.is_multipart(), 0)
    eq(part2a.get_content_type(), 'text/plain')
    neq(part2a.get_payload(), 'message 2\n')
