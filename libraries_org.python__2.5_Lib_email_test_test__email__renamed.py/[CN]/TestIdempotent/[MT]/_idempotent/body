def _idempotent(self, msg, text):
    eq = self.ndiffAssertEqual
    s = StringIO()
    g = Generator(s, maxheaderlen=0)
    g.flatten(msg)
    eq(text, s.getvalue())
