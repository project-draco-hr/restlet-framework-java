{
  super(context,request,response);
  if (getCurrentUser() != null) {
    setModifiable(true);
    String mailboxId=Reference.decode((String)request.getAttributes().get("mailboxId"));
    mailbox=getObjectsFacade().getMailboxById(mailboxId);
    if (mailbox != null) {
      String feedId=(String)request.getAttributes().get("feedId");
      feed=getObjectsFacade().getFeedById(feedId);
      if (feed != null) {
        mails=new ArrayList<Mail>();
        if (feed.getTags() != null) {
          for (          Mail mail : mailbox.getMails()) {
            if (mail.getTags() != null && mail.getTags().containsAll(feed.getTags())) {
              mails.add(mail);
            }
          }
        }
        getVariants().add(new Variant(MediaType.TEXT_HTML));
        getVariants().add(new Variant(MediaType.APPLICATION_ATOM_XML));
      }
    }
  }
 else {
    setModifiable(false);
  }
}
