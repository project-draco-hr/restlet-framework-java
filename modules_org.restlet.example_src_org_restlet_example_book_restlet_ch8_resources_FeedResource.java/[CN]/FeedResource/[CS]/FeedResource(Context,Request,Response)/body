{
  super(context,request,response);
  if (getCurrentUser() != null) {
    setModifiable(true);
    final String mailboxId=Reference.decode((String)request.getAttributes().get("mailboxId"));
    this.mailbox=getObjectsFacade().getMailboxById(mailboxId);
    if (this.mailbox != null) {
      final String feedId=(String)request.getAttributes().get("feedId");
      this.feed=getObjectsFacade().getFeedById(feedId);
      if (this.feed != null) {
        this.mails=new ArrayList<Mail>();
        if (this.feed.getTags() != null) {
          for (          final Mail mail : this.mailbox.getMails()) {
            if ((mail.getTags() != null) && mail.getTags().containsAll(this.feed.getTags())) {
              this.mails.add(mail);
            }
          }
        }
        getVariants().add(new Variant(MediaType.APPLICATION_ATOM_XML));
        getVariants().add(new Variant(MediaType.TEXT_HTML));
      }
    }
  }
 else {
    setModifiable(false);
  }
}
