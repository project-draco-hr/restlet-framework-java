{
  try {
    Response message=getMessage();
    if (message != null) {
      super.onSelected(registration);
      while (isProcessing()) {
        if (getByteBufferState() == BufferState.FILLING) {
          if (getMessageState() == MessageState.END) {
            onCompleted();
          }
 else {
            fillByteBuffer();
          }
        }
 else         if (getByteBufferState() == BufferState.DRAINING) {
          drainByteBuffer();
          if (getMessageState() == MessageState.IDLE) {
            updateState();
          }
        }
      }
    }
  }
 catch (  Exception e) {
    getLogger().log(Level.WARNING,"Error while writing an HTTP message",e);
    getLogger().log(Level.INFO,"Error while writing an HTTP message",e);
  }
}
