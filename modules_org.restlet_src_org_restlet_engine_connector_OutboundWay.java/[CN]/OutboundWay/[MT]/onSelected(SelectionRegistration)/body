{
  try {
    Response message=getMessage();
    if (message != null) {
      super.onSelected(registration);
      while (isSelected()) {
        if (getIoBuffer().isFilling()) {
          if (getMessageState() == MessageState.END) {
            onCompleted(false);
          }
 else {
            fillByteBuffer();
          }
        }
 else         if (getIoBuffer().isDraining()) {
          drainByteBuffer();
          if (getMessageState() == MessageState.IDLE) {
            updateState();
          }
        }
      }
    }
  }
 catch (  Exception e) {
    getLogger().log(Level.WARNING,"Error while writing an HTTP message",e);
    getLogger().log(Level.INFO,"Error while writing an HTTP message",e);
  }
}
