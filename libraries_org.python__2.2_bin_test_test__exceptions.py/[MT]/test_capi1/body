def test_capi1():
    import _testcapi
    try:
        _testcapi.raise_exception(BadException, 1)
    except TypeError as err:
        (exc, err, tb) = sys.exc_info()
        co = tb.tb_frame.f_code
        assert (co.co_name == 'test_capi1')
        assert co.co_filename.endswith('test_exceptions.py')
    else:
        print 'Expected exception'
