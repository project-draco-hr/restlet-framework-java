def test_capi2():
    import _testcapi
    try:
        _testcapi.raise_exception(BadException, 0)
    except RuntimeError as err:
        (exc, err, tb) = sys.exc_info()
        co = tb.tb_frame.f_code
        assert (co.co_name == '__init__')
        assert co.co_filename.endswith('test_exceptions.py')
        co2 = tb.tb_frame.f_back.f_code
        assert (co2.co_name == 'test_capi2')
    else:
        print 'Expected exception'
