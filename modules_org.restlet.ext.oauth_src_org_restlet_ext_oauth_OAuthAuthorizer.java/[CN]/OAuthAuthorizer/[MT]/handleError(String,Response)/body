{
  if ((error != null) && (error.length() > 0)) {
    ChallengeRequest cr=new ChallengeRequest(ChallengeScheme.HTTP_OAUTH,"oauth");
    Series<Parameter> parameters=new Form();
    parameters.add("error",error);
    OAuthError code=OAuthError.valueOf(error);
switch (code) {
case INVALID_REQUEST:
      resp.setStatus(Status.CLIENT_ERROR_BAD_REQUEST);
    break;
case INVALID_TOKEN:
case EXPIRED_TOKEN:
  resp.setStatus(Status.CLIENT_ERROR_UNAUTHORIZED);
break;
case INSUFFICIENT_SCOPE:
resp.setStatus(Status.CLIENT_ERROR_FORBIDDEN);
break;
}
cr.setParameters(parameters);
resp.getChallengeRequests().add(cr);
}
}
