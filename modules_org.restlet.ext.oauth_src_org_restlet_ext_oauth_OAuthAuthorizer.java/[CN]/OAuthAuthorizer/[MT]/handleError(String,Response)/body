{
  if ((error != null) && (error.length() > 0)) {
    ChallengeRequest cr=new ChallengeRequest(ChallengeScheme.HTTP_OAUTH,"oauth");
    Series<Parameter> parameters=new Form();
    parameters.add("error",error);
    OAuthError code=OAuthError.valueOf(error);
switch (code) {
case invalid_request:
      resp.setStatus(Status.CLIENT_ERROR_BAD_REQUEST);
    break;
case invalid_token:
case expired_token:
  resp.setStatus(Status.CLIENT_ERROR_UNAUTHORIZED);
break;
case insufficient_scope:
resp.setStatus(Status.CLIENT_ERROR_FORBIDDEN);
break;
default :
break;
}
cr.setParameters(parameters);
resp.getChallengeRequests().add(cr);
}
}
