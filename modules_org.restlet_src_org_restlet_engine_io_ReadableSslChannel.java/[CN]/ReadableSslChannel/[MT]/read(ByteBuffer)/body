{
  int result=0;
  refill();
  if (getPacketBufferState() == BufferState.DRAINING) {
    int dstSize=dst.remaining();
    if (dstSize > 0) {
      SSLEngineResult sslResult=runEngine(dst);
      handleResult(sslResult,dst);
      refill();
      result=dstSize - dst.remaining();
    }
  }
  return result;
}
