{
  int result=0;
  int dstSize=applicationBuffer.remaining();
  SSLEngineResult sslResult=null;
switch (getConnection().getSslState()) {
case READING_APPLICATION_DATA:
case HANDSHAKING:
    sslResult=getConnection().getSslEngine().unwrap(getBuffer().getBytes(),applicationBuffer.getBytes());
  getConnection().handleResult(sslResult,getBuffer(),applicationBuffer.getBytes(),this);
break;
case CLOSED:
case WRITING_APPLICATION_DATA:
break;
case CREATED:
case IDLE:
case REHANDSHAKING:
throw new IOException("Unexpected SSL state");
}
result=dstSize - applicationBuffer.remaining();
return result;
}
