{
  if (getConnection().getSslState() == SslState.WRITING_APPLICATION_DATA) {
    getConnection().setSslState(SslState.READING_APPLICATION_DATA);
  }
  ByteBuffer applicationBuffer=(ByteBuffer)args[0];
  int initialSize=buffer.remaining();
  SSLEngineResult sslResult=getConnection().getSslEngine().unwrap(buffer.getBytes(),applicationBuffer);
  getConnection().setSslResult(sslResult);
  return initialSize - buffer.remaining();
}
