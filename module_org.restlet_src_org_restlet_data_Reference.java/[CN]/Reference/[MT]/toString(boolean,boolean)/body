{
  if (query) {
    if (fragment) {
      return this.internalRef;
    }
 else {
      if (fragmentIndex != -1) {
        return this.internalRef.substring(0,fragmentIndex);
      }
 else {
        return this.internalRef;
      }
    }
  }
 else {
    if (fragment) {
      if (queryIndex != -1) {
        if (fragmentIndex != -1) {
          return this.internalRef.substring(0,queryIndex) + "#" + getFragment();
        }
 else {
          return this.internalRef.substring(0,queryIndex);
        }
      }
 else {
        return this.internalRef;
      }
    }
 else {
      if (queryIndex != -1) {
        return this.internalRef.substring(0,queryIndex);
      }
 else {
        return this.internalRef;
      }
    }
  }
}
