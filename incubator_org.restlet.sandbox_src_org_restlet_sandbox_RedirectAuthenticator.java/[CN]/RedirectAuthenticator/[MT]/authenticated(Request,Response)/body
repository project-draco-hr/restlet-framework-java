{
  int ret=super.authenticated(request,response);
  Cookie redir=this.getOriginalRefCookie(request);
  String ref=redir != null ? redir.getValue() : null;
  clearCookie(origRefCookie,request,response);
  if (ref != null && response != null)   response.redirectPermanent(ref);
  if (response != null && response.getStatus().isRedirection())   return STOP;
  return ret;
}
