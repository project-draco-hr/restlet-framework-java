{
  this();
  DocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();
  dbf.setNamespaceAware(false);
  dbf.setValidating(false);
  try {
    DocumentBuilder db=dbf.newDocumentBuilder();
    Document document=db.parse(new FileInputStream(new LocalReference(xmlConfigReference).getFile()));
    NodeList clientNodes=document.getElementsByTagName("client");
    for (int i=0; i < clientNodes.getLength(); i++) {
      Node clientNode=clientNodes.item(i);
      Node item=clientNode.getAttributes().getNamedItem("protocol");
      Client client=null;
      if (item == null) {
        item=clientNode.getAttributes().getNamedItem("protocols");
        if (item != null) {
          String[] protocols=item.getNodeValue().split(" ");
          List<Protocol> protocolsList=new ArrayList<Protocol>();
          for (int j=0; j < protocols.length; j++) {
            protocolsList.add(getProtocol(protocols[j]));
          }
          client=new Client(getContext(),protocolsList);
        }
      }
 else {
        client=new Client(getContext(),getProtocol(item.getNodeValue()));
      }
      if (client != null) {
        this.getClients().add(client);
      }
    }
    NodeList serverNodes=document.getElementsByTagName("server");
    for (int i=0; i < serverNodes.getLength(); i++) {
      Node serverNode=serverNodes.item(i);
      Node node=serverNode.getAttributes().getNamedItem("protocol");
      Node portNode=serverNode.getAttributes().getNamedItem("port");
      Server server=null;
      if (node == null) {
        node=serverNode.getAttributes().getNamedItem("protocols");
        if (node != null) {
          String[] protocols=node.getNodeValue().split(" ");
          List<Protocol> protocolsList=new ArrayList<Protocol>();
          for (int j=0; j < protocols.length; j++) {
            protocolsList.add(getProtocol(protocols[j]));
          }
          int port=getInt(portNode,Protocol.UNKNOWN_PORT);
          if (port == Protocol.UNKNOWN_PORT) {
            getLogger().warning("Please specify a port when defining a list of protocols.");
          }
 else {
            server=new Server(getContext(),protocolsList,getInt(portNode,Protocol.UNKNOWN_PORT),this.getServers().getTarget());
          }
        }
      }
 else {
        Protocol protocol=getProtocol(node.getNodeValue());
        server=new Server(getContext(),protocol,getInt(portNode,protocol.getDefaultPort()),this.getServers().getTarget());
      }
      if (server != null) {
        this.getServers().add(server);
      }
      NodeList defaultHostNodes=document.getElementsByTagName("defaultHost");
      if (defaultHostNodes.getLength() > 0) {
        parseHost(this.getDefaultHost(),defaultHostNodes.item(0));
      }
      NodeList hostNodes=document.getElementsByTagName("host");
      for (int j=0; j < hostNodes.getLength(); j++) {
        VirtualHost host=new VirtualHost();
        parseHost(host,hostNodes.item(j));
        this.getHosts().add(host);
      }
    }
    NodeList internalRouterNodes=document.getElementsByTagName("internalRouter");
    if (internalRouterNodes.getLength() > 0) {
      Node node=internalRouterNodes.item(0);
      Node item=node.getAttributes().getNamedItem("defaultMatchingMode");
      if (item != null) {
        this.getInternalRouter().setDefaultMatchingMode(getInt(item,getInternalRouter().getDefaultMatchingMode()));
      }
      item=node.getAttributes().getNamedItem("maxAttempts");
      if (item != null) {
        this.getInternalRouter().setMaxAttempts(getInt(item,this.getInternalRouter().getMaxAttempts()));
      }
      item=node.getAttributes().getNamedItem("routingMode");
      if (item != null) {
        this.getInternalRouter().setRoutingMode(getInt(item,this.getInternalRouter().getRoutingMode()));
      }
      item=node.getAttributes().getNamedItem("requiredScore");
      if (item != null) {
        this.getInternalRouter().setRequiredScore(getFloat(item,this.getInternalRouter().getRequiredScore()));
      }
      item=node.getAttributes().getNamedItem("retryDelay");
      if (item != null) {
        this.getInternalRouter().setRetryDelay(getLong(item,this.getInternalRouter().getRetryDelay()));
      }
      setAttach(getInternalRouter(),node);
    }
    NodeList logServiceNodes=document.getElementsByTagName("logService");
    if (logServiceNodes.getLength() > 0) {
      Node node=logServiceNodes.item(0);
      Node item=node.getAttributes().getNamedItem("logFormat");
      if (item != null) {
        this.getLogService().setLogFormat(item.getNodeValue());
      }
      item=node.getAttributes().getNamedItem("loggerName");
      if (item != null) {
        this.getLogService().setLoggerName(item.getNodeValue());
      }
      item=node.getAttributes().getNamedItem("enabled");
      if (item != null) {
        this.getLogService().setEnabled(getBoolean(item,true));
      }
      item=node.getAttributes().getNamedItem("identityCheck");
      if (item != null) {
        this.getLogService().setIdentityCheck(getBoolean(item,true));
      }
    }
    NodeList statusServiceNodes=document.getElementsByTagName("statusService");
    if (statusServiceNodes.getLength() > 0) {
      Node node=statusServiceNodes.item(0);
      Node item=node.getAttributes().getNamedItem("contactEmail");
      if (item != null) {
        this.getStatusService().setContactEmail(item.getNodeValue());
      }
      item=node.getAttributes().getNamedItem("enabled");
      if (item != null) {
        this.getStatusService().setEnabled(getBoolean(item,true));
      }
      item=node.getAttributes().getNamedItem("homeRef");
      if (item != null) {
        this.getStatusService().setHomeRef(new Reference(item.getNodeValue()));
      }
      item=node.getAttributes().getNamedItem("overwrite");
      if (item != null) {
        this.getStatusService().setOverwrite(getBoolean(item,true));
      }
    }
  }
 catch (  Exception e) {
    getLogger().log(Level.WARNING,"Unable to parse the Component XML configuration.",e);
  }
}
