{
  if (response != null) {
    ConnectedRequest request=(ConnectedRequest)response.getRequest();
    ServerConnection connection=request.getConnection();
    if (request.isExpectingResponse()) {
      Response nextResponse=connection.getMessages().peek();
      if ((nextResponse != null) && (nextResponse.getRequest() == request)) {
        connection.getOutboundMessages().add(response);
        if (!response.getStatus().isInformational()) {
          connection.getMessages().remove(nextResponse);
        }
        connection.writeMessages();
      }
 else {
        getOutboundMessages().add(response);
      }
    }
 else {
      connection.setInboundBusy(false);
    }
  }
}
