def visitListComp(self, node):
    self.set_lineno(node)
    append = ('$append%d' % self.__list_count)
    self.__list_count = (self.__list_count + 1)
    self.emit('BUILD_LIST', 0)
    self.emit('DUP_TOP')
    self.emit('LOAD_ATTR', 'append')
    self._implicitNameOp('STORE', append)
    stack = []
    for (i, for_) in zip(range(len(node.quals)), node.quals):
        (start, anchor) = self.visit(for_)
        cont = None
        for if_ in for_.ifs:
            if (cont is None):
                cont = self.newBlock()
            self.visit(if_, cont)
        stack.insert(0, (start, cont, anchor))
    self._implicitNameOp('LOAD', append)
    self.visit(node.expr)
    self.emit('CALL_FUNCTION', 1)
    self.emit('POP_TOP')
    for (start, cont, anchor) in stack:
        if cont:
            skip_one = self.newBlock()
            self.emit('JUMP_FORWARD', skip_one)
            self.startBlock(cont)
            self.emit('POP_TOP')
            self.nextBlock(skip_one)
        self.emit('JUMP_ABSOLUTE', start)
        self.startBlock(anchor)
    self._implicitNameOp('DELETE', append)
    self.__list_count = (self.__list_count - 1)
