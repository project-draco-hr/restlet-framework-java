def test_domain_mirror(self):
    from cookielib import CookieJar, DefaultCookiePolicy
    pol = DefaultCookiePolicy(rfc2965=True)
    c = CookieJar(pol)
    url = 'http://foo.bar.com/'
    interact_2965(c, url, 'spam=eggs; Version=1')
    h = interact_2965(c, url)
    self.assert_(('Domain' not in h), 'absent domain returned with domain present')
    c = CookieJar(pol)
    url = 'http://foo.bar.com/'
    interact_2965(c, url, 'spam=eggs; Version=1; Domain=.bar.com')
    h = interact_2965(c, url)
    self.assert_(('$Domain=".bar.com"' in h), 'domain not returned')
    c = CookieJar(pol)
    url = 'http://foo.bar.com/'
    interact_2965(c, url, 'spam=eggs; Version=1; Domain=bar.com')
    h = interact_2965(c, url)
    self.assert_(('$Domain="bar.com"' in h), 'domain not returned')
