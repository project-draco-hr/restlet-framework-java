def test_domain_return_ok(self):
    import cookielib, urllib2
    pol = cookielib.DefaultCookiePolicy()
    for (url, domain, ok) in [('http://foo.bar.com/', 'blah.com', False), ('http://foo.bar.com/', 'rhubarb.blah.com', False), ('http://foo.bar.com/', 'rhubarb.foo.bar.com', False), ('http://foo.bar.com/', '.foo.bar.com', True), ('http://foo.bar.com/', 'foo.bar.com', True), ('http://foo.bar.com/', '.bar.com', True), ('http://foo.bar.com/', 'com', True), ('http://foo.com/', 'rhubarb.foo.com', False), ('http://foo.com/', '.foo.com', True), ('http://foo.com/', 'foo.com', True), ('http://foo.com/', 'com', True), ('http://foo/', 'rhubarb.foo', False), ('http://foo/', '.foo', True), ('http://foo/', 'foo', True), ('http://foo/', 'foo.local', True), ('http://foo/', '.local', True)]:
        request = urllib2.Request(url)
        r = pol.domain_return_ok(domain, request)
        if ok:
            self.assert_(r)
        else:
            self.assert_((not r))
