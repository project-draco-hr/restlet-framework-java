def test_secure(self):
    from cookielib import CookieJar, DefaultCookiePolicy
    for ns in (True, False):
        for whitespace in (' ', ''):
            c = CookieJar()
            if ns:
                pol = DefaultCookiePolicy(rfc2965=False)
                int = interact_netscape
                vs = ''
            else:
                pol = DefaultCookiePolicy(rfc2965=True)
                int = interact_2965
                vs = '; Version=1'
            c.set_policy(pol)
            url = 'http://www.acme.com/'
            int(c, url, ('foo1=bar%s%s' % (vs, whitespace)))
            int(c, url, ('foo2=bar%s; secure%s' % (vs, whitespace)))
            self.assert_((not c._cookies['www.acme.com']['/']['foo1'].secure), 'non-secure cookie registered secure')
            self.assert_(c._cookies['www.acme.com']['/']['foo2'].secure, 'secure cookie registered non-secure')
