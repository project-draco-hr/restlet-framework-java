def test_two_component_domain_ns(self):
    from cookielib import CookieJar, DefaultCookiePolicy
    c = CookieJar()
    interact_netscape(c, 'http://foo.net/', 'ns=bar')
    self.assertEquals(len(c), 1)
    self.assertEquals(c._cookies['foo.net']['/']['ns'].value, 'bar')
    self.assertEquals(interact_netscape(c, 'http://foo.net/'), 'ns=bar')
    self.assertEquals(interact_netscape(c, 'http://www.foo.net/'), 'ns=bar')
    pol = DefaultCookiePolicy(strict_ns_domain=DefaultCookiePolicy.DomainStrictNonDomain)
    c.set_policy(pol)
    self.assertEquals(interact_netscape(c, 'http://www.foo.net/'), '')
    interact_netscape(c, 'http://foo.net/foo/', 'spam1=eggs; domain=foo.net')
    interact_netscape(c, 'http://foo.net/foo/bar/', 'spam2=eggs; domain=.foo.net')
    self.assertEquals(len(c), 3)
    self.assertEquals(c._cookies['.foo.net']['/foo']['spam1'].value, 'eggs')
    self.assertEquals(c._cookies['.foo.net']['/foo/bar']['spam2'].value, 'eggs')
    self.assertEquals(interact_netscape(c, 'http://foo.net/foo/bar/'), 'spam2=eggs; spam1=eggs; ns=bar')
    interact_netscape(c, 'http://foo.net/', 'nini="ni"; domain=.net')
    self.assertEquals(len(c), 3)
    interact_netscape(c, 'http://foo.co.uk', 'nasty=trick; domain=.co.uk')
    self.assertEquals(len(c), 4)
