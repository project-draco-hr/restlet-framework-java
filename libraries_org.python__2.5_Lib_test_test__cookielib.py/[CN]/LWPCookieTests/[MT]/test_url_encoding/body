def test_url_encoding(self):
    from cookielib import CookieJar, DefaultCookiePolicy
    c = CookieJar(DefaultCookiePolicy(rfc2965=True))
    interact_2965(c, 'http://www.acme.com/foo%2f%25/%3c%3c%0Anew%E5/%E5', 'foo  =   bar; version    =   1')
    cookie = interact_2965(c, 'http://www.acme.com/foo%2f%25/<<%0anew\xe5/\xe6\xf8\xe5', 'bar=baz; path="/foo/"; version=1')
    version_re = re.compile('^\\$version=\\"?1\\"?', re.I)
    self.assert_((('foo=bar' in cookie) and version_re.search(cookie)))
    cookie = interact_2965(c, 'http://www.acme.com/foo/%25/<<%0anew\xe5/\xe6\xf8\xe5')
    self.assert_((not cookie))
    cookie = interact_2965(c, u'http://www.acme.com/\xfc')
