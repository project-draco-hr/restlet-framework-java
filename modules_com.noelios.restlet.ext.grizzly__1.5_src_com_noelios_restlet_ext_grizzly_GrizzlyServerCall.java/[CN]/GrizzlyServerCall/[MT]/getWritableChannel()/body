{
  if (isConfidential()) {
    return new WritableByteChannel(){
      public void close() throws IOException {
        getReadableChannel().close();
      }
      public boolean isOpen(){
        return getReadableChannel().isOpen();
      }
      public int write(      ByteBuffer src) throws IOException {
        int nWrite=src.limit();
        SSLOutputWriter.flushChannel(socketChannel,src);
        return nWrite;
      }
    }
;
  }
 else {
    return this.socketChannel;
  }
}
