def test_expat_dtdhandler():
    parser = make_parser()
    handler = TestDTDHandler()
    parser.setDTDHandler(handler)
    parser.parse(StringIO('<!DOCTYPE doc [\n  <!ENTITY img SYSTEM "expat.gif" NDATA GIF>\n  <!NOTATION GIF PUBLIC "-//CompuServe//NOTATION Graphics Interchange Format 89a//EN">\n]>\n<doc></doc>'))
    if ((len(handler._entities) != 1) or (len(handler._entities[0]) != 4)):
        return 0
    (name, pubId, sysId, ndata) = handler._entities[0]
    if ((name != 'img') or (not (pubId is None)) or (not sysId.endswith('expat.gif')) or (ndata != 'GIF')):
        return 0
    return (handler._notations == [('GIF', '-//CompuServe//NOTATION Graphics Interchange Format 89a//EN', None)])
