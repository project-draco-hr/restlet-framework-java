{
  if (this.security == null) {
    this.security=new SecurityDataImpl();
    if (isConfidential()) {
      getSecurity().setConfidential(isConfidential());
    }
 else {
    }
    String authorization=null;
    Parameter header;
    for (Iterator<Parameter> iter=getRequestHeaders().iterator(); (authorization == null) && iter.hasNext(); ) {
      header=iter.next();
      if (header.getName().equalsIgnoreCase(HEADER_AUTHORIZATION)) {
        authorization=header.getValue();
      }
    }
    getSecurity().setChallengeResponse(SecurityUtils.parseResponse(authorization));
  }
  return this.security;
}
