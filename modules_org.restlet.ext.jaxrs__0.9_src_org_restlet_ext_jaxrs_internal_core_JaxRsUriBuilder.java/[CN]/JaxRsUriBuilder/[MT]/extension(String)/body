{
  StringBuilder path=getPath();
  int lastPathSt=path.lastIndexOf("/");
  int lastSegmSt=path.indexOf(".",lastPathSt);
  if (lastSegmSt > 0)   path.delete(lastSegmSt,Integer.MAX_VALUE);
  if (extension != null) {
    CharSequence ext;
    ext=EncodeOrCheck.pathSegmentWithMatrix(extension,encode);
    if (ext.length() == 0 || ext.charAt(0) != '.')     path.append('.');
    path.append(ext);
  }
  return this;
}
