def check(tag, expected, raw, compare=None):
    global nerrors
    if verbose:
        print '    checking', tag
    orig = raw[:]
    if compare:
        raw.sort(compare)
    else:
        raw.sort()
    if (len(expected) != len(raw)):
        print 'error in', tag
        print 'length mismatch;', len(expected), len(raw)
        print expected
        print orig
        print raw
        nerrors += 1
        return
    for (i, good) in enumerate(expected):
        maybe = raw[i]
        if (good is not maybe):
            print 'error in', tag
            print 'out of order at index', i, good, maybe
            print expected
            print orig
            print raw
            nerrors += 1
            return
