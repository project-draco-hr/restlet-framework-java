{
  if (decode && encode)   throw new IllegalArgumentException("It is not meaningful to require decode AND encode");
  if (segment == null) {
    if (indexForErrMess >= 0)     throw new IllegalArgumentException("The " + indexForErrMess + ". segment must not be null");
 else     throw new IllegalArgumentException("The segment must not be null");
  }
  this.unmodifiable=unmodifiable;
  this.decode=decode;
  this.encode=encode;
  int indexOfSemic=segment.indexOf(';');
  String path;
  if (indexOfSemic > 0) {
    path=segment.substring(0,indexOfSemic);
    this.matrParamEncoded=segment.substring(indexOfSemic + 1);
  }
 else {
    path=segment;
    this.matrParamEncoded=null;
  }
  if (decode) {
    this.path=Reference.decode(path);
  }
 else   if (encode) {
    this.path=EncodeOrCheck.encodeNotBraces(path,true).toString();
  }
 else {
    if (checkForInvalidChars)     EncodeOrCheck.checkForInvalidUriChars(path,indexForErrMess,"new path segment");
    this.path=path;
  }
}
