def setUp(self):
    template = '\n\t\t\t[default]\n\t\t\tname=dbexts_test\n\n\t\t\t[jdbc]\n\t\t\tname=dbexts_test\n\t\t\turl=%s\n\t\t\tuser=%s\n\t\t\tpwd=%s\n\t\t\tdriver=%s\n\t\t'
    args = {}
    for arg in self.factory.arguments:
        args[arg[0]] = arg[1]
    template = (template % (args['url'], args['usr'], args['pwd'], args['driver']))
    if hasattr(self, 'datahandler'):
        template += ('\tdatahandler=%s' % self.datahandler.__name__)
    template = os.linesep.join(template.split())
    try:
        fp = open(tempfile.mktemp(), 'w')
        fp.write(template)
        fp.close()
        self.db = dbexts.dbexts(cfg=fp.name)
        self.db.verbose = 0
        for table in ('one', 'two'):
            try:
                self.db.raw(('drop table %s' % table))
            except:
                pass
        self.db.raw('create table one (a int, b int, c varchar(32))')
        self.db.raw('create table two (a int, b int, c varchar(32))')
    finally:
        try:
            os.remove(fp.name)
        except:
            pass
