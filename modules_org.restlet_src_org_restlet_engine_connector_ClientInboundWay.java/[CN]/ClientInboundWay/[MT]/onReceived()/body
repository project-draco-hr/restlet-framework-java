{
  if (HeaderUtils.isConnectionClose(getHeaders())) {
    getConnection().setState(ConnectionState.CLOSING);
  }
  getMessage().setEntity(createEntity(getHeaders()));
  try {
    copyResponseTransportHeaders(getHeaders(),getMessage());
  }
 catch (  Throwable t) {
    getLogger().log(Level.WARNING,"Error while parsing the headers",t);
  }
  if (getHeaders() != null) {
    getMessage().getAttributes().put(HeaderConstants.ATTRIBUTE_HEADERS,getHeaders());
  }
  if (!getMessage().getStatus().isInformational()) {
    getMessages().poll();
  }
  getHelper().getInboundMessages().add(getMessage());
  if (getMessage().isEntityAvailable()) {
    setIoState(IoState.IDLE);
  }
 else {
    onCompleted();
  }
}
