{
  if (endDetected || !getConnection().isPersistent() || HeaderUtils.isConnectionClose(getHeaders())) {
    getConnection().close(!endDetected);
  }
  super.onCompleted(endDetected);
}
