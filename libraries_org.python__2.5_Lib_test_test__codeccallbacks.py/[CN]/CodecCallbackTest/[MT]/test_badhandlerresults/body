def test_badhandlerresults(self):
    results = (42, u'foo', (1, 2, 3), (u'foo', 1, 3), (u'foo', None), (u'foo',), ('foo', 1, 3), ('foo', None), ('foo',))
    encs = ('ascii', 'latin-1', 'iso-8859-1', 'iso-8859-15')
    for res in results:
        codecs.register_error('test.badhandler', (lambda : res))
        for enc in encs:
            self.assertRaises(TypeError, u'\u3042'.encode, enc, 'test.badhandler')
        for (enc, bytes) in (('ascii', '\xff'), ('utf-8', '\xff'), ('utf-7', '+x-')):
            self.assertRaises(TypeError, bytes.decode, enc, 'test.badhandler')
