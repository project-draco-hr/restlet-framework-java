{
  Protocol protocol=request.getProtocol();
  if (protocol == null) {
    throw new UnsupportedOperationException("Unable to determine the protocol to use for this call.");
  }
 else {
    String targetUri=request.getResourceRef().toString(true,false);
    if (targetUri.contains("{")) {
      Template template=new Template(getContext().getLogger(),targetUri);
      request.setResourceRef(template.format(request,response));
    }
    this.helper.handle(request,response);
  }
}
