def test_finalizer():


    class A:

        def __del__(self):
            pass


    class B:
        pass
    a = A()
    a.a = a
    id_a = id(a)
    b = B()
    b.b = b
    gc.collect()
    del a
    del b
    expect_nonzero(gc.collect(), 'finalizer')
    for obj in gc.garbage:
        if (id(obj) == id_a):
            del obj.a
            break
    else:
        raise TestFailed, "didn't find obj in garbage (finalizer)"
    gc.garbage.remove(obj)
