def test_newinstance():


    class A(object):
        pass
    a = A()
    a.a = a
    gc.collect()
    del a
    expect_nonzero(gc.collect(), 'newinstance')


    class B(list):
        pass


    class C(B, A):
        pass
    a = C()
    a.a = a
    gc.collect()
    del a
    expect_nonzero(gc.collect(), 'newinstance(2)')
    del B, C
    expect_nonzero(gc.collect(), 'newinstance(3)')
    A.a = A()
    del A
    expect_nonzero(gc.collect(), 'newinstance(4)')
    expect(gc.collect(), 0, 'newinstance(5)')
