def _fsync(fd, metadata):
    'Internal fsync impl'
    rawio = FileDescriptors.get(fd)
    rawio.checkClosed()
    from java.nio.channels import FileChannel
    channel = rawio.getChannel()
    if (not isinstance(channel, FileChannel)):
        raise OSError(errno.EINVAL, strerror(errno.EINVAL))
    try:
        channel.force(metadata)
    except java.io.IOException as ioe:
        raise OSError(ioe)
