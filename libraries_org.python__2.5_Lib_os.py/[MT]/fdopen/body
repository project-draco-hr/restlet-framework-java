def fdopen(fd, mode='r', bufsize=(-1)):
    "fdopen(fd [, mode='r' [, bufsize]]) -> file_object\n\n    Return an open file object connected to a file descriptor.\n    "
    rawio = FileDescriptors.get(fd)
    if (((len(mode) and mode[0]) or '') not in 'rwa'):
        raise ValueError(("invalid file mode '%s'" % mode))
    if rawio.closed():
        raise OSError(errno.EBADF, strerror(errno.EBADF))
    try:
        fp = FileDescriptors.wrap(rawio, mode, bufsize)
    except IOError:
        raise OSError(errno.EINVAL, strerror(errno.EINVAL))
    return fp
