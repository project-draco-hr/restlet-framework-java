def close(self):
    self._ensure_header_written(0)
    if (self._datawritten & 1):
        self._file.write(chr(0))
        self._datawritten = (self._datawritten + 1)
    self._writemarkers()
    if ((self._nframeswritten != self._nframes) or (self._datalength != self._datawritten) or self._marklength):
        self._patchheader()
    if self._comp:
        self._comp.CloseCompressor()
        self._comp = None
    self._file.flush()
    self._file = None
