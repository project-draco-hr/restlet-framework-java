def _sync_flush(f):
    'Ensure changes to file f are physically on disk.'
    f.flush()
    if hasattr(os, 'fsync'):
        os.fsync(f.fileno())
