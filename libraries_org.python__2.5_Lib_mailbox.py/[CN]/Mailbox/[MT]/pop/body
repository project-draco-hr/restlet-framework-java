def pop(self, key, default=None):
    'Delete the keyed message and return it, or default.'
    try:
        result = self[key]
    except KeyError:
        return default
    self.discard(key)
    return result
