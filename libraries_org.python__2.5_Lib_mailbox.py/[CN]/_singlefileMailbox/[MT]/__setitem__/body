def __setitem__(self, key, message):
    "Replace the keyed message; raise KeyError if it doesn't exist."
    self._lookup(key)
    self._toc[key] = self._append_message(message)
    self._pending = True
