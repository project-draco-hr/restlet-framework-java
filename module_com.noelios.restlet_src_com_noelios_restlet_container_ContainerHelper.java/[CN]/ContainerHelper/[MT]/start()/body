{
  Filter lastFilter=null;
  boolean missingConnector=false;
  for (  VirtualHost host : getContainer().getHosts()) {
    for (    Scorer scorer : host.getScorers()) {
      Restlet next=scorer.getNext();
      if (next instanceof Application) {
        Application application=(Application)next;
        for (        Protocol clientProtocol : application.getConnectorService().getClientProtocols()) {
          if (!getContainer().getClients().contains(clientProtocol)) {
            getContainer().getLogger().severe("Unable to start the application \"" + application.getName() + "\". Client connector for protocol "+ clientProtocol.getName()+ " is missing.");
            missingConnector=true;
          }
        }
        for (        Protocol serverProtocol : application.getConnectorService().getServerProtocols()) {
          if (!getContainer().getServers().contains(serverProtocol)) {
            getContainer().getLogger().severe("Unable to start the application \"" + application.getName() + "\". Server connector for protocol "+ serverProtocol.getName()+ " is missing.");
            missingConnector=true;
          }
        }
      }
    }
  }
  if (missingConnector) {
    getContainer().stop();
  }
 else {
    if (getContainer().getLogService().isEnabled()) {
      lastFilter=createLogFilter(getContainer().getContext(),getContainer().getLogService().getAccessLoggerName(),getContainer().getLogService().getAccessLogFormat());
      setFirst(lastFilter);
    }
    if (getContainer().getStatusService().isEnabled()) {
      Filter statusFilter=createStatusFilter(getContainer());
      if (lastFilter != null)       lastFilter.setNext(statusFilter);
      if (getFirst() == null)       setFirst(statusFilter);
      lastFilter=statusFilter;
    }
    if (getFirst() == null) {
      setFirst(getServerRouter());
    }
 else {
      lastFilter.setNext(getServerRouter());
    }
  }
}
