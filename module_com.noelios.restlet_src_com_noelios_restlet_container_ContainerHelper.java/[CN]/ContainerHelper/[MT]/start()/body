{
  Filter lastFilter=null;
  boolean success=checkVirtualHost(getContainer().getDefaultHost());
  if (success) {
    for (    VirtualHost host : getContainer().getHosts()) {
      success=success && checkVirtualHost(host);
    }
  }
  if (!success) {
    getContainer().stop();
  }
 else {
    if (getContainer().getLogService().isEnabled()) {
      lastFilter=createLogFilter(getContainer().getContext(),getContainer().getLogService().getAccessLoggerName(),getContainer().getLogService().getAccessLogFormat());
      setFirst(lastFilter);
    }
    if (getContainer().getStatusService().isEnabled()) {
      Filter statusFilter=createStatusFilter(getContainer());
      if (lastFilter != null)       lastFilter.setNext(statusFilter);
      if (getFirst() == null)       setFirst(statusFilter);
      lastFilter=statusFilter;
    }
    if (getFirst() == null) {
      setFirst(getServerRouter());
    }
 else {
      lastFilter.setNext(getServerRouter());
    }
  }
}
