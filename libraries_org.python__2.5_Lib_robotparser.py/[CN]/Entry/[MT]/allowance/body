def allowance(self, filename):
    'Preconditions:\n        - our agent applies to this entry\n        - filename is URL decoded'
    for line in self.rulelines:
        _debug((filename, str(line), line.allowance))
        if line.applies_to(filename):
            return line.allowance
    return True
