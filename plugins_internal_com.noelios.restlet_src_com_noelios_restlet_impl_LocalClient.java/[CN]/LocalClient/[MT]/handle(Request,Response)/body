{
  try {
    if (!isStarted())     start();
  }
 catch (  Exception e) {
    getLogger().log(Level.SEVERE,"Couldn't start the local client connector",e);
  }
  if (isStarted()) {
    String scheme=request.getResourceRef().getScheme();
    request.getResourceRef().normalize();
    if (scheme.equalsIgnoreCase("file")) {
      handleFile(request,response,request.getResourceRef().getPath());
    }
 else     if (scheme.equalsIgnoreCase("context")) {
      ContextReference cr=new ContextReference(request.getResourceRef());
      if (cr.getAuthorityType() == AuthorityType.CLASS) {
        handleClassLoader(request,response,getClass().getClassLoader());
      }
 else       if (cr.getAuthorityType() == AuthorityType.SYSTEM) {
        handleClassLoader(request,response,ClassLoader.getSystemClassLoader());
      }
 else       if (cr.getAuthorityType() == AuthorityType.THREAD) {
        handleClassLoader(request,response,Thread.currentThread().getContextClassLoader());
      }
 else       if (cr.getAuthorityType() == AuthorityType.WEB_APPLICATION) {
        handleWebApp(request,response);
      }
    }
 else {
      throw new IllegalArgumentException("Protocol \"" + scheme + "\" not supported by the connector. Only FILE and CONTEXT are supported.");
    }
  }
}
