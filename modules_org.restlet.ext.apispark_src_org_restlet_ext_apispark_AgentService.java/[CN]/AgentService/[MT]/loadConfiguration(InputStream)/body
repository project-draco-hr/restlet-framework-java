{
  Properties properties=new Properties();
  try {
    properties.load(inputStream);
  }
 catch (  IOException e) {
    throw new IllegalArgumentException("Agent configuration file error. See exception for details.",e);
  }
  this.agentSecret=getRequiredProperty(properties,"agent.secret").toCharArray();
  this.agentServiceUrl=properties.getProperty("agent.serviceUrl",DEFAULT_AGENT_SERVICE_URL);
  this.agentUsername=properties.getProperty("agent.usernane");
  this.cell=getRequiredIntegerProperty(properties,"agent.cell.id");
  this.cellVersion=getRequiredIntegerProperty(properties,"agent.cell.version");
  this.redirectionEnabled=Boolean.valueOf(getRequiredProperty(properties,"agent.redirection.enabled"));
  if (this.redirectionEnabled) {
    this.redirectionUrl=getRequiredProperty(properties,"agent.redirection.redirectionUrl");
  }
}
