def parse_ns_headers(ns_headers):
    'Ad-hoc parser for Netscape protocol cookie-attributes.\n\n    The old Netscape cookie format for Set-Cookie can for instance contain\n    an unquoted "," in the expires field, so we have to use this ad-hoc\n    parser instead of split_header_words.\n\n    XXX This may not make the best possible effort to parse all the crap\n    that Netscape Cookie headers contain.  Ronald Tschalar\'s HTTPClient\n    parser is probably better, so could do worse than following that if\n    this ever gives any trouble.\n\n    Currently, this is also used for parsing RFC 2109 cookies.\n\n    '
    known_attrs = ('expires', 'domain', 'path', 'secure', 'port', 'max-age')
    result = []
    for ns_header in ns_headers:
        pairs = []
        version_set = False
        for (ii, param) in enumerate(re.split(';\\s*', ns_header)):
            param = param.rstrip()
            if (param == ''):
                continue
            if ('=' not in param):
                (k, v) = (param, None)
            else:
                (k, v) = re.split('\\s*=\\s*', param, 1)
                k = k.lstrip()
            if (ii != 0):
                lc = k.lower()
                if (lc in known_attrs):
                    k = lc
                if (k == 'version'):
                    version_set = True
                if (k == 'expires'):
                    if v.startswith('"'):
                        v = v[1:]
                    if v.endswith('"'):
                        v = v[:(-1)]
                    v = http2time(v)
            pairs.append((k, v))
        if pairs:
            if (not version_set):
                pairs.append(('version', '0'))
            result.append(pairs)
    return result
