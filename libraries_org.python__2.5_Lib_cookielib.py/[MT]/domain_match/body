def domain_match(A, B):
    "Return True if domain A domain-matches domain B, according to RFC 2965.\n\n    A and B may be host domain names or IP addresses.\n\n    RFC 2965, section 1:\n\n    Host names can be specified either as an IP address or a HDN string.\n    Sometimes we compare one host name with another.  (Such comparisons SHALL\n    be case-insensitive.)  Host A's name domain-matches host B's if\n\n         *  their host name strings string-compare equal; or\n\n         * A is a HDN string and has the form NB, where N is a non-empty\n            name string, B has the form .B', and B' is a HDN string.  (So,\n            x.y.com domain-matches .Y.com but not Y.com.)\n\n    Note that domain-match is not a commutative operation: a.b.c.com\n    domain-matches .c.com, but not the reverse.\n\n    "
    A = A.lower()
    B = B.lower()
    if (A == B):
        return True
    if (not is_HDN(A)):
        return False
    i = A.rfind(B)
    if ((i == (-1)) or (i == 0)):
        return False
    if (not B.startswith('.')):
        return False
    if (not is_HDN(B[1:])):
        return False
    return True
