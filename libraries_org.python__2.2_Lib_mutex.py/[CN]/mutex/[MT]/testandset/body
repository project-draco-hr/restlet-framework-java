def testandset(self):
    'Atomic test-and-set -- grab the lock if it is not set,\n        return true if it succeeded.'
    if (not self.locked):
        self.locked = 1
        return 1
    else:
        return 0
