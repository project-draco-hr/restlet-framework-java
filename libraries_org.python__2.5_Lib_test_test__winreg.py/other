from _winreg import *
import os, sys
from test.test_support import verify, have_unicode
test_key_name = 'SOFTWARE\\Python Registry Test Key - Delete Me'
test_data = [('Int Value', 45, REG_DWORD), ('String Val', 'A string value', REG_SZ), ('StringExpand', 'The path is %path%', REG_EXPAND_SZ), ('Multi-string', ['Lots', 'of', 'string', 'values'], REG_MULTI_SZ), ('Raw Data', (('binary' + chr(0)) + 'data'), REG_BINARY), ('Big String', ('x' * ((2 ** 14) - 1)), REG_SZ), ('Big Binary', ('x' * (2 ** 14)), REG_BINARY)]
if have_unicode:
    test_data += [(unicode('Unicode Val'), unicode('A Unicode value'), REG_SZ), ('UnicodeExpand', unicode('The path is %path%'), REG_EXPAND_SZ), ('Multi-unicode', [unicode('Lots'), unicode('of'), unicode('unicode'), unicode('values')], REG_MULTI_SZ), ('Multi-mixed', [unicode('Unicode'), unicode('and'), 'string', 'values'], REG_MULTI_SZ)]
TestAll(HKEY_CURRENT_USER)
print 'Local registry tests worked'
try:
    remote_name = sys.argv[(sys.argv.index('--remote') + 1)]
except (IndexError, ValueError):
    remote_name = None
if (remote_name is not None):
    try:
        remote_key = ConnectRegistry(remote_name, HKEY_CURRENT_USER)
    except EnvironmentError as exc:
        print 'Could not connect to the remote machine -', exc.strerror
        remote_key = None
    if (remote_key is not None):
        TestAll(remote_key)
        print 'Remote registry tests worked'
else:
    print 'Remote registry calls can be tested using',
    print "'test_winreg.py --remote \\\\machine_name'"
    h = ConnectRegistry(None, HKEY_LOCAL_MACHINE)
    h.Close()
