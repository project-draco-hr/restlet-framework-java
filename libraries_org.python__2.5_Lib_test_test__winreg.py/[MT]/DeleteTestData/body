def DeleteTestData(root_key):
    key = OpenKey(root_key, test_key_name, 0, KEY_ALL_ACCESS)
    sub_key = OpenKey(key, 'sub_key', 0, KEY_ALL_ACCESS)
    for (value_name, value_data, value_type) in test_data:
        DeleteValue(sub_key, value_name)
    (nkeys, nvalues, since_mod) = QueryInfoKey(sub_key)
    verify(((nkeys == 0) and (nvalues == 0)), 'subkey not empty before delete')
    sub_key.Close()
    DeleteKey(key, 'sub_key')
    try:
        DeleteKey(key, 'sub_key')
        verify(0, 'Deleting the key twice succeeded')
    except EnvironmentError:
        pass
    key.Close()
    DeleteKey(root_key, test_key_name)
    try:
        key = OpenKey(root_key, test_key_name)
        verify(0, 'Could open the non-existent key')
    except WindowsError:
        pass
