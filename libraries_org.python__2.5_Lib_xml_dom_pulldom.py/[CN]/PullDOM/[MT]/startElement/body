def startElement(self, name, attrs):
    if self.document:
        node = self.document.createElement(name)
    else:
        node = self.buildDocument(None, name)
    for (aname, value) in attrs.items():
        attr = self.document.createAttribute(aname)
        attr.value = value
        node.setAttributeNode(attr)
    self.lastEvent[1] = [(START_ELEMENT, node), None]
    self.lastEvent = self.lastEvent[1]
    self.push(node)
