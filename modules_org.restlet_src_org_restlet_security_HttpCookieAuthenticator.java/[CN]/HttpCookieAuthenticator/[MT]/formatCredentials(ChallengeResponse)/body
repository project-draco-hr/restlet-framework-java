{
  try {
    String cookieValue=challenge.getIdentifier() + '/' + System.currentTimeMillis();
    byte[] credentials;
    if (getServerCipher() == null) {
      credentials=cookieValue.getBytes();
    }
 else {
      credentials=CryptoUtils.encrypt(getCryptAlgorithm(),getServerCipher(),cookieValue);
    }
    return Base64.encode(credentials,false);
  }
 catch (  Exception e) {
    getLogger().log(Level.WARNING,"Could not format credentials",e);
    return null;
  }
}
