def retry_http_digest_auth(self, req, auth):
    (token, challenge) = auth.split(' ', 1)
    chal = parse_keqv_list(parse_http_list(challenge))
    auth = self.get_authorization(req, chal)
    if auth:
        auth_val = ('Digest %s' % auth)
        if (req.headers.get(self.auth_header, None) == auth_val):
            return None
        req.add_header(self.auth_header, auth_val)
        resp = self.parent.open(req)
        return resp
