def test_pickling(self):
    import pickle
    mods = [pickle]
    try:
        import cPickle
        mods.append(cPickle)
    except ImportError:
        pass
    protocols = [0, 1, 2]
    for mod in mods:
        for protocol in protocols:
            for ast in (compile(i, '?', 'exec', 1024) for i in exec_tests):
                ast2 = mod.loads(mod.dumps(ast, protocol))
                self.assertEquals(to_tuple(ast2), to_tuple(ast))
