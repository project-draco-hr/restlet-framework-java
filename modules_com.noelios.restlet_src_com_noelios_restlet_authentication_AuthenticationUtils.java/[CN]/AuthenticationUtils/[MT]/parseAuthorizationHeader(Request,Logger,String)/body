{
  ChallengeResponse result=null;
  if (header != null) {
    int space=header.indexOf(' ');
    if (space != -1) {
      String scheme=header.substring(0,space);
      String credentials=header.substring(space + 1);
      result=new ChallengeResponse(new ChallengeScheme("HTTP_" + scheme,scheme),credentials);
      AuthenticationHelper helper=Engine.getInstance().findHelper(result.getScheme(),true,false);
      if (helper != null) {
        helper.parseResponse(result,request,logger);
      }
 else {
        throw new IllegalArgumentException("Challenge scheme " + result.getScheme() + " not supported by the Restlet engine.");
      }
    }
  }
  return result;
}
