{
  ChallengeRequest result=null;
  if (header != null) {
    final int space=header.indexOf(' ');
    if (space != -1) {
      final String scheme=header.substring(0,space);
      result=new ChallengeRequest(new ChallengeScheme("HTTP_" + scheme,scheme),null);
      final String rest=header.substring(space + 1);
      parseParameters(rest,result.getParameters());
      result.setRealm(result.getParameters().getFirstValue("realm"));
    }
 else {
      final String scheme=header.substring(0);
      result=new ChallengeRequest(new ChallengeScheme("HTTP_" + scheme,scheme),null);
    }
  }
  final AuthenticationHelper helper=Engine.getInstance().findHelper(result.getScheme(),true,false);
  if (helper != null) {
    helper.parseRequest(result,header);
  }
 else {
    throw new IllegalArgumentException("Challenge scheme " + result.getScheme() + " not supported by the Restlet engine.");
  }
  return result;
}
