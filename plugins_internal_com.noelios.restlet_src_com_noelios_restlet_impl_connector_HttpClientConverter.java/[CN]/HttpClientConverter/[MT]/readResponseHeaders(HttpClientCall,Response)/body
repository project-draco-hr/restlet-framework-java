{
  try {
    response.getAttributes().put(HttpConstants.ATTRIBUTE_HEADERS,httpCall.getResponseHeaders());
    for (    Parameter header : httpCall.getResponseHeaders()) {
      if (header.getName().equalsIgnoreCase(HttpConstants.HEADER_LOCATION)) {
        response.setRedirectRef(header.getValue());
      }
 else       if ((header.getName().equalsIgnoreCase(HttpConstants.HEADER_SET_COOKIE)) || (header.getName().equalsIgnoreCase(HttpConstants.HEADER_SET_COOKIE2))) {
        try {
          CookieReader cr=new CookieReader(header.getValue());
          response.getCookieSettings().add(cr.readCookieSetting());
        }
 catch (        Exception e) {
          logger.log(Level.WARNING,"Error during cookie setting parsing. Header: " + header.getValue(),e);
        }
      }
 else       if (header.getName().equalsIgnoreCase(HttpConstants.HEADER_WWW_AUTHENTICATE)) {
        ChallengeRequest request=SecurityUtils.parseRequest(header.getValue());
        response.setChallengeRequest(request);
      }
 else       if (header.getName().equalsIgnoreCase(HttpConstants.HEADER_SERVER)) {
        response.getServer().setAgent(header.getValue());
      }
 else       if (header.getName().equalsIgnoreCase(HttpConstants.HEADER_ALLOW)) {
        StringTokenizer st=new StringTokenizer(header.getValue(),",\\s");
        while (st.hasMoreTokens()) {
          response.getAllowedMethods().add(Method.valueOf(st.nextToken()));
        }
      }
    }
  }
 catch (  Exception e) {
    logger.log(Level.FINE,"An error occured during the processing of the HTTP response.",e);
    response.setStatus(new Status(Status.CONNECTOR_ERROR_INTERNAL,"Unable to process the response. " + e.getMessage()));
  }
}
